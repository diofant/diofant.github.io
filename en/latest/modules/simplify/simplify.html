

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>Simplify &mdash; Diofant 0.13.0a2.dev47+g0cb8c0a34 documentation</title>
  

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/graphviz.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/custom.css" type="text/css" />

  
  
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
        <script type="text/x-mathjax-config">MathJax.Hub.Config({"CommonHTML": {"linebreaks": {"automatic": true}}, "HTML-CSS": {"linebreaks": {"automatic": true}}, "SVG": {"linebreaks": {"automatic": true}}})</script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Stats" href="../stats.html" />
    <link rel="prev" title="Sets" href="../sets.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../index.html">
          

          
            
            <img src="../../_static/logo.svg" class="logo" alt="Logo"/>
          
          </a>

          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../install.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tutorial/index.html">Tutorial</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">Reference</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../config.html">Config</a></li>
<li class="toctree-l2"><a class="reference internal" href="../core.html">Core</a></li>
<li class="toctree-l2"><a class="reference internal" href="../combinatorics/index.html">Combinatorics</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ntheory.html">Number Theory</a></li>
<li class="toctree-l2"><a class="reference internal" href="../concrete.html">Concrete Mathematics</a></li>
<li class="toctree-l2"><a class="reference internal" href="../functions/index.html">Mathematical Functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../geometry/index.html">Geometry</a></li>
<li class="toctree-l2"><a class="reference internal" href="../integrals.html">Integrals</a></li>
<li class="toctree-l2"><a class="reference internal" href="../logic.html">Logic</a></li>
<li class="toctree-l2"><a class="reference internal" href="../domains.html">Domains</a></li>
<li class="toctree-l2"><a class="reference internal" href="../matrices/index.html">Matrices</a></li>
<li class="toctree-l2"><a class="reference internal" href="../polys.html">Polynomials</a></li>
<li class="toctree-l2"><a class="reference internal" href="../printing.html">Printing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../interactive.html">Interactive</a></li>
<li class="toctree-l2"><a class="reference internal" href="../plotting.html">Plotting</a></li>
<li class="toctree-l2"><a class="reference internal" href="../series.html">Series</a></li>
<li class="toctree-l2"><a class="reference internal" href="../sets.html">Sets</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Simplify</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id1">simplify</a></li>
<li class="toctree-l3"><a class="reference internal" href="#separatevars">separatevars</a></li>
<li class="toctree-l3"><a class="reference internal" href="#nthroot">nthroot</a></li>
<li class="toctree-l3"><a class="reference internal" href="#besselsimp">besselsimp</a></li>
<li class="toctree-l3"><a class="reference internal" href="#hypersimp">hypersimp</a></li>
<li class="toctree-l3"><a class="reference internal" href="#hypersimilar">hypersimilar</a></li>
<li class="toctree-l3"><a class="reference internal" href="#nsimplify">nsimplify</a></li>
<li class="toctree-l3"><a class="reference internal" href="#posify">posify</a></li>
<li class="toctree-l3"><a class="reference internal" href="#logcombine">logcombine</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-diofant.simplify.radsimp">Radsimp</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id2">radsimp</a></li>
<li class="toctree-l4"><a class="reference internal" href="#rad-rationalize">rad_rationalize</a></li>
<li class="toctree-l4"><a class="reference internal" href="#collect">collect</a></li>
<li class="toctree-l4"><a class="reference internal" href="#collect-sqrt">collect_sqrt</a></li>
<li class="toctree-l4"><a class="reference internal" href="#collect-const">collect_const</a></li>
<li class="toctree-l4"><a class="reference internal" href="#fraction">fraction</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-diofant.simplify.ratsimp">Ratsimp</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id3">ratsimp</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-diofant.simplify.trigsimp">Trigonometric simplification</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#trigsimp">trigsimp</a></li>
<li class="toctree-l4"><a class="reference internal" href="#futrig">futrig</a></li>
<li class="toctree-l4"><a class="reference internal" href="#module-diofant.simplify.fu">fu</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-diofant.simplify.powsimp">Power simplification</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#powsimp">powsimp</a></li>
<li class="toctree-l4"><a class="reference internal" href="#powdenest">powdenest</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-diofant.simplify.combsimp">Combinatorial simplification</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#combsimp">combsimp</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-diofant.simplify.sqrtdenest">Square Root Denest</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#sqrtdenest">sqrtdenest</a></li>
<li class="toctree-l4"><a class="reference internal" href="#unrad">unrad</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-diofant.simplify.cse_main">Common Subexpresion Elimination</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#cse">cse</a></li>
<li class="toctree-l4"><a class="reference internal" href="#opt-cse">opt_cse</a></li>
<li class="toctree-l4"><a class="reference internal" href="#tree-cse">tree_cse</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-diofant.simplify.hyperexpand">Hypergeometric Function Expansion</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#hyperexpand">hyperexpand</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-diofant.simplify.traversaltools">Traversal Tools</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#use">use</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-diofant.simplify.epathtools">EPath Tools</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#epath-class">EPath class</a></li>
<li class="toctree-l4"><a class="reference internal" href="#epath">epath</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../stats.html">Stats</a></li>
<li class="toctree-l2"><a class="reference internal" href="../solvers/index.html">Solvers</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tensor/index.html">Tensors</a></li>
<li class="toctree-l2"><a class="reference internal" href="../utilities/index.html">Utilities</a></li>
<li class="toctree-l2"><a class="reference internal" href="../parsing.html">Parsing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../calculus/index.html">Calculus</a></li>
<li class="toctree-l2"><a class="reference internal" href="../diffgeom.html">Differential Geometry</a></li>
<li class="toctree-l2"><a class="reference internal" href="../vector/index.html">Vectors</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../internals/index.html">Internals</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../guide.html">Development</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../aboutus.html">About</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../release/index.html">Release Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../sources.html">Bibliography</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">Diofant</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="../index.html">Reference</a> &raquo;</li>
        
      <li>Simplify</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../../_sources/modules/simplify/simplify.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="simplify">
<h1>Simplify<a class="headerlink" href="#simplify" title="Permalink to this headline">¶</a></h1>
<div class="section" id="id1">
<h2>simplify<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h2>
<dl class="py function">
<dt id="diofant.simplify.simplify.simplify">
<code class="sig-prename descclassname"><span class="pre">diofant.simplify.simplify.</span></code><code class="sig-name descname"><span class="pre">simplify</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="pre">expr</span></em>, <em class="sig-param"><span class="pre">ratio=1.7</span></em>, <em class="sig-param"><span class="pre">measure=&lt;function</span> <span class="pre">count_ops&gt;</span></em>, <em class="sig-param"><span class="pre">fu=False</span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/diofant/diofant/blob/master/diofant/simplify/simplify.py#L464-L684"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#diofant.simplify.simplify.simplify" title="Permalink to this definition">¶</a></dt>
<dd><p>Simplifies the given expression.</p>
<p>Simplification is not a well defined term and the exact strategies
this function tries can change in the future versions of Diofant. If
your algorithm relies on “simplification” (whatever it is), try to
determine what you need exactly  -  is it powsimp()?, radsimp()?,
together()?, logcombine()?, or something else? And use this particular
function directly, because those are well defined and thus your algorithm
will be robust.</p>
<p>Nonetheless, especially for interactive use, or when you don’t know
anything about the structure of the expression, simplify() tries to apply
intelligent heuristics to make the input expression “simpler”.  For
example:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">x</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">y</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">x</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">y</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span>
<span class="go">(x**2 + x)/(x*sin(y)**2 + x*cos(y)**2)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">simplify</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="go">x + 1</span>
</pre></div>
</div>
<p>Note that we could have obtained the same result by using specific
simplification functions:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">trigsimp</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="go">(x**2 + x)/x</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cancel</span><span class="p">(</span><span class="n">_</span><span class="p">)</span>
<span class="go">x + 1</span>
</pre></div>
</div>
<p>In some cases, applying <a class="reference internal" href="#diofant.simplify.simplify.simplify" title="diofant.simplify.simplify.simplify"><code class="xref py py-func docutils literal notranslate"><span class="pre">simplify()</span></code></a> may actually result in some more
complicated expression. The default <code class="docutils literal notranslate"><span class="pre">ratio=1.7</span></code> prevents more extreme
cases: if (result length)/(input length) &gt; ratio, then input is returned
unmodified.  The <code class="docutils literal notranslate"><span class="pre">measure</span></code> parameter lets you specify the function used
to determine how complex an expression is.  The function should take a
single argument as an expression and return a number such that if
expression <code class="docutils literal notranslate"><span class="pre">a</span></code> is more complex than expression <code class="docutils literal notranslate"><span class="pre">b</span></code>, then
<code class="docutils literal notranslate"><span class="pre">measure(a)</span> <span class="pre">&gt;</span> <span class="pre">measure(b)</span></code>.  The default measure function is
<a class="reference internal" href="../core.html#diofant.core.function.count_ops" title="diofant.core.function.count_ops"><code class="xref py py-func docutils literal notranslate"><span class="pre">count_ops()</span></code></a>, which returns the total number of operations in the
expression.</p>
<p>For example, if <code class="docutils literal notranslate"><span class="pre">ratio=1</span></code>, <code class="docutils literal notranslate"><span class="pre">simplify</span></code> output can’t be longer
than input.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">root</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">+</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
<p>Since <code class="docutils literal notranslate"><span class="pre">simplify(root)</span></code> would result in a slightly longer expression,
root is returned unchanged instead:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">simplify</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="n">ratio</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="o">==</span> <span class="n">root</span>
<span class="go">True</span>
</pre></div>
</div>
<p>If <code class="docutils literal notranslate"><span class="pre">ratio=oo</span></code>, simplify will be applied anyway:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">count_ops</span><span class="p">(</span><span class="n">simplify</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="n">ratio</span><span class="o">=</span><span class="n">oo</span><span class="p">))</span> <span class="o">&gt;</span> <span class="n">count_ops</span><span class="p">(</span><span class="n">root</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Note that the shortest expression is not necessary the simplest, so
setting <code class="docutils literal notranslate"><span class="pre">ratio</span></code> to 1 may not be a good idea.
Heuristically, the default value <code class="docutils literal notranslate"><span class="pre">ratio=1.7</span></code> seems like a reasonable
choice.</p>
<p>You can easily define your own measure function based on what you feel
should represent the “size” or “complexity” of the input expression.  Note
that some choices, such as <code class="docutils literal notranslate"><span class="pre">lambda</span> <span class="pre">expr:</span> <span class="pre">len(str(expr))</span></code> may appear to be
good metrics, but have other problems (in this case, the measure function
may slow down simplify too much for very large expressions).  If you don’t
know what a good metric would be, the default, <code class="docutils literal notranslate"><span class="pre">count_ops</span></code>, is a good
one.</p>
<p>For example:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;a b&#39;</span><span class="p">,</span> <span class="n">positive</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">real</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">g</span> <span class="o">=</span> <span class="n">log</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="o">+</span> <span class="n">log</span><span class="p">(</span><span class="n">b</span><span class="p">)</span> <span class="o">+</span> <span class="n">log</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="o">*</span><span class="n">log</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">b</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">h</span> <span class="o">=</span> <span class="n">simplify</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">h</span>
<span class="go">log(a*b**(-log(a) + 1))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">count_ops</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>
<span class="go">8</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">count_ops</span><span class="p">(</span><span class="n">h</span><span class="p">)</span>
<span class="go">5</span>
</pre></div>
</div>
<p>So you can see that <code class="docutils literal notranslate"><span class="pre">h</span></code> is simpler than <code class="docutils literal notranslate"><span class="pre">g</span></code> using the count_ops metric.
However, we may not like how <code class="docutils literal notranslate"><span class="pre">simplify</span></code> (in this case, using
<code class="docutils literal notranslate"><span class="pre">logcombine</span></code>) has created the <code class="docutils literal notranslate"><span class="pre">b**(log(1/a)</span> <span class="pre">+</span> <span class="pre">1)</span></code> term.  A simple way
to reduce this would be to give more weight to powers as operations in
<code class="docutils literal notranslate"><span class="pre">count_ops</span></code>.  We can do this by using the <code class="docutils literal notranslate"><span class="pre">visual=True</span></code> option:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">count_ops</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="n">visual</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
<span class="go">2*ADD + DIV + 4*LOG + MUL</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">count_ops</span><span class="p">(</span><span class="n">h</span><span class="p">,</span> <span class="n">visual</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
<span class="go">2*LOG + MUL + POW + SUB</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">my_measure</span><span class="p">(</span><span class="n">expr</span><span class="p">):</span>
<span class="gp">... </span>    <span class="c1"># Discourage powers by giving POW a weight of 10</span>
<span class="gp">... </span>    <span class="n">count</span> <span class="o">=</span> <span class="n">count_ops</span><span class="p">(</span><span class="n">expr</span><span class="p">,</span> <span class="n">visual</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">subs</span><span class="p">({</span><span class="s1">&#39;POW&#39;</span><span class="p">:</span> <span class="mi">10</span><span class="p">})</span>
<span class="gp">... </span>    <span class="c1"># Every other operation gets a weight of 1 (the default)</span>
<span class="gp">... </span>    <span class="n">count</span> <span class="o">=</span> <span class="n">count</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">Symbol</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<span class="gp">... </span>    <span class="k">return</span> <span class="n">count</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">my_measure</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>
<span class="go">8</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">my_measure</span><span class="p">(</span><span class="n">h</span><span class="p">)</span>
<span class="go">14</span>
<span class="gp">&gt;&gt;&gt; </span><span class="mf">15.</span><span class="o">/</span><span class="mi">8</span> <span class="o">&gt;</span> <span class="mf">1.7</span>  <span class="c1"># 1.7 is the default ratio</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">simplify</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="n">measure</span><span class="o">=</span><span class="n">my_measure</span><span class="p">)</span>
<span class="go">-log(a)*log(b) + log(a) + log(b)</span>
</pre></div>
</div>
<p>Note that because <code class="docutils literal notranslate"><span class="pre">simplify()</span></code> internally tries many different
simplification strategies and then compares them using the measure
function, we get a completely different result that is still different
from the input expression by doing this.</p>
</dd></dl>

</div>
<div class="section" id="separatevars">
<h2>separatevars<a class="headerlink" href="#separatevars" title="Permalink to this headline">¶</a></h2>
<dl class="py function">
<dt id="diofant.simplify.simplify.separatevars">
<code class="sig-prename descclassname"><span class="pre">diofant.simplify.simplify.</span></code><code class="sig-name descname"><span class="pre">separatevars</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">expr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">symbols</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dict</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">force</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/diofant/diofant/blob/master/diofant/simplify/simplify.py#L29-L95"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#diofant.simplify.simplify.separatevars" title="Permalink to this definition">¶</a></dt>
<dd><p>Separates variables in an expression, if possible.  By
default, it separates with respect to all symbols in an
expression and collects constant coefficients that are
independent of symbols.</p>
<p>If dict=True then the separated terms will be returned
in a dictionary keyed to their corresponding symbols.
By default, all symbols in the expression will appear as
keys; if symbols are provided, then all those symbols will
be used as keys, and any terms in the expression containing
other symbols or non-symbols will be returned keyed to the
string ‘coeff’. (Passing None for symbols will return the
expression in a dictionary keyed to ‘coeff’.)</p>
<p>If force=True, then bases of powers will be separated regardless
of assumptions on the symbols involved.</p>
<p class="rubric">Notes</p>
<p>The order of the factors is determined by Mul, so that the
separated expressions may not necessarily be grouped together.</p>
<p>Although factoring is necessary to separate variables in some
expressions, it is not necessary in all cases, so one should not
count on the returned factors being factored.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">diofant.abc</span> <span class="kn">import</span> <span class="n">alpha</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">separatevars</span><span class="p">((</span><span class="n">x</span><span class="o">*</span><span class="n">y</span><span class="p">)</span><span class="o">**</span><span class="n">y</span><span class="p">)</span>
<span class="go">(x*y)**y</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">separatevars</span><span class="p">((</span><span class="n">x</span><span class="o">*</span><span class="n">y</span><span class="p">)</span><span class="o">**</span><span class="n">y</span><span class="p">,</span> <span class="n">force</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">x**y*y**y</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">e</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">z</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">y</span><span class="p">)</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">z</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">separatevars</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
<span class="go">2*x**2*z*(sin(y) + 1)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">separatevars</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="n">symbols</span><span class="o">=</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">),</span> <span class="nb">dict</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">{&#39;coeff&#39;: 2*z, x: x**2, y: sin(y) + 1}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">separatevars</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="p">[</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">alpha</span><span class="p">],</span> <span class="nb">dict</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">{&#39;coeff&#39;: 2*z, alpha: 1, x: x**2, y: sin(y) + 1}</span>
</pre></div>
</div>
<p>If the expression is not really separable, or is only partially
separable, separatevars will do the best it can to separate it
by using factoring.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">separatevars</span><span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="n">x</span><span class="o">*</span><span class="n">y</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<span class="go">-x*(3*x - y - 1)</span>
</pre></div>
</div>
<p>If the expression is not separable then expr is returned unchanged
or (if dict=True) then None is returned.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">eq</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="n">y</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">separatevars</span><span class="p">(</span><span class="n">eq</span><span class="p">)</span> <span class="o">==</span> <span class="n">eq</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">separatevars</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="n">y</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">symbols</span><span class="o">=</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">),</span> <span class="nb">dict</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">None</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

</div>
<div class="section" id="nthroot">
<h2>nthroot<a class="headerlink" href="#nthroot" title="Permalink to this headline">¶</a></h2>
<dl class="py function">
<dt id="diofant.simplify.simplify.nthroot">
<code class="sig-prename descclassname"><span class="pre">diofant.simplify.simplify.</span></code><code class="sig-name descname"><span class="pre">nthroot</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">expr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_len</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">15</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/diofant/diofant/blob/master/diofant/simplify/simplify.py#L220-L275"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#diofant.simplify.simplify.nthroot" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute a real nth-root of a sum of surds.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>expr</strong> (<em>sum of surds</em>)</p></li>
<li><p><strong>n</strong> (<em>integer</em>)</p></li>
<li><p><strong>max_len</strong> (maximum number of surds passed as constants to <code class="docutils literal notranslate"><span class="pre">nsimplify</span></code>)</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>First <code class="docutils literal notranslate"><span class="pre">nsimplify</span></code> is used to get a candidate root; if it is not a
root the minimal polynomial is computed; the answer is one of its
roots.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">nthroot</span><span class="p">(</span><span class="mi">90</span> <span class="o">+</span> <span class="mi">34</span><span class="o">*</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">7</span><span class="p">),</span> <span class="mi">3</span><span class="p">)</span>
<span class="go">sqrt(7) + 3</span>
</pre></div>
</div>
</dd></dl>

</div>
<div class="section" id="besselsimp">
<h2>besselsimp<a class="headerlink" href="#besselsimp" title="Permalink to this headline">¶</a></h2>
<dl class="py function">
<dt id="diofant.simplify.simplify.besselsimp">
<code class="sig-prename descclassname"><span class="pre">diofant.simplify.simplify.</span></code><code class="sig-name descname"><span class="pre">besselsimp</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">expr</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/diofant/diofant/blob/master/diofant/simplify/simplify.py#L1004-L1089"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#diofant.simplify.simplify.besselsimp" title="Permalink to this definition">¶</a></dt>
<dd><p>Simplify bessel-type functions.</p>
<p>This routine tries to simplify bessel-type functions. Currently it only
works on the Bessel J and I functions, however. It works by looking at all
such functions in turn, and eliminating factors of “I” and “-1” (actually
their polar equivalents) in front of the argument. Then, functions of
half-integer order are rewritten using trigonometric functions and
functions of integer order (&gt; 1) are rewritten using functions
of low order.  Finally, if the expression was changed, compute
factorization of the result with factor().</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">diofant.abc</span> <span class="kn">import</span> <span class="n">nu</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">besselsimp</span><span class="p">(</span><span class="n">besselj</span><span class="p">(</span><span class="n">nu</span><span class="p">,</span> <span class="n">z</span><span class="o">*</span><span class="n">polar_lift</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)))</span>
<span class="go">E**(I*pi*nu)*besselj(nu, z)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">besselsimp</span><span class="p">(</span><span class="n">besseli</span><span class="p">(</span><span class="n">nu</span><span class="p">,</span> <span class="n">z</span><span class="o">*</span><span class="n">polar_lift</span><span class="p">(</span><span class="o">-</span><span class="n">I</span><span class="p">)))</span>
<span class="go">E**(-I*pi*nu/2)*besselj(nu, z)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">besselsimp</span><span class="p">(</span><span class="n">besseli</span><span class="p">(</span><span class="n">Rational</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">z</span><span class="p">))</span>
<span class="go">sqrt(2)*cosh(z)/(sqrt(pi)*sqrt(z))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">besselsimp</span><span class="p">(</span><span class="n">z</span><span class="o">*</span><span class="n">besseli</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">z</span><span class="p">)</span> <span class="o">+</span> <span class="n">z</span><span class="o">*</span><span class="p">(</span><span class="n">besseli</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">z</span><span class="p">))</span><span class="o">/</span><span class="mi">2</span> <span class="o">+</span> <span class="n">besseli</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">z</span><span class="p">))</span>
<span class="go">3*z*besseli(0, z)/2</span>
</pre></div>
</div>
</dd></dl>

</div>
<div class="section" id="hypersimp">
<h2>hypersimp<a class="headerlink" href="#hypersimp" title="Permalink to this headline">¶</a></h2>
<dl class="py function">
<dt id="diofant.simplify.simplify.hypersimp">
<code class="sig-prename descclassname"><span class="pre">diofant.simplify.simplify.</span></code><code class="sig-name descname"><span class="pre">hypersimp</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">f</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/diofant/diofant/blob/master/diofant/simplify/simplify.py#L336-L378"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#diofant.simplify.simplify.hypersimp" title="Permalink to this definition">¶</a></dt>
<dd><p>Given combinatorial term f(k) simplify its consecutive term ratio
i.e. f(k+1)/f(k).  The input term can be composed of functions and
integer sequences which have equivalent representation in terms
of gamma special function.</p>
<p class="rubric">Notes</p>
<p>The algorithm performs three basic steps:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mf">1.</span> <span class="n">Rewrite</span> <span class="nb">all</span> <span class="n">functions</span> <span class="ow">in</span> <span class="n">terms</span> <span class="n">of</span> <span class="n">gamma</span><span class="p">,</span> <span class="k">if</span> <span class="n">possible</span><span class="o">.</span>

<span class="mf">2.</span> <span class="n">Rewrite</span> <span class="nb">all</span> <span class="n">occurrences</span> <span class="n">of</span> <span class="n">gamma</span> <span class="ow">in</span> <span class="n">terms</span> <span class="n">of</span> <span class="n">products</span>
   <span class="n">of</span> <span class="n">gamma</span> <span class="ow">and</span> <span class="n">rising</span> <span class="n">factorial</span> <span class="k">with</span> <span class="n">integer</span><span class="p">,</span>  <span class="n">absolute</span>
   <span class="n">constant</span> <span class="n">exponent</span><span class="o">.</span>

<span class="mf">3.</span> <span class="n">Perform</span> <span class="n">simplification</span> <span class="n">of</span> <span class="n">nested</span> <span class="n">fractions</span><span class="p">,</span> <span class="n">powers</span>
   <span class="ow">and</span> <span class="k">if</span> <span class="n">the</span> <span class="n">resulting</span> <span class="n">expression</span> <span class="ow">is</span> <span class="n">a</span> <span class="n">quotient</span> <span class="n">of</span>
   <span class="n">polynomials</span><span class="p">,</span> <span class="n">reduce</span> <span class="n">their</span> <span class="n">total</span> <span class="n">degree</span><span class="o">.</span>
</pre></div>
</div>
<p>If f(k) is hypergeometric then as result we arrive with a
quotient of polynomials of minimal degree. Otherwise None
is returned.</p>
<p class="rubric">References</p>
<ul class="simple">
<li><ol class="upperalpha simple" start="23">
<li><dl class="simple">
<dt>Koepf, Algorithms for m-fold Hypergeometric Summation,</dt><dd><p>Journal of Symbolic Computation (1995) 20, 399-417</p>
</dd>
</dl>
</li>
</ol>
</li>
</ul>
</dd></dl>

</div>
<div class="section" id="hypersimilar">
<h2>hypersimilar<a class="headerlink" href="#hypersimilar" title="Permalink to this headline">¶</a></h2>
<dl class="py function">
<dt id="diofant.simplify.simplify.hypersimilar">
<code class="sig-prename descclassname"><span class="pre">diofant.simplify.simplify.</span></code><code class="sig-name descname"><span class="pre">hypersimilar</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">f</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">g</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/diofant/diofant/blob/master/diofant/simplify/simplify.py#L381-L399"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#diofant.simplify.simplify.hypersimilar" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns True if ‘f’ and ‘g’ are hyper-similar.</p>
<p>Similarity in hypergeometric sense means that a quotient of
f(k) and g(k) is a rational function in k.  This procedure
is useful in solving recurrence relations.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#diofant.simplify.simplify.hypersimp" title="diofant.simplify.simplify.hypersimp"><code class="xref py py-obj docutils literal notranslate"><span class="pre">hypersimp</span></code></a></p>
</div>
</dd></dl>

</div>
<div class="section" id="nsimplify">
<h2>nsimplify<a class="headerlink" href="#nsimplify" title="Permalink to this headline">¶</a></h2>
<dl class="py function">
<dt id="diofant.simplify.simplify.nsimplify">
<code class="sig-prename descclassname"><span class="pre">diofant.simplify.simplify.</span></code><code class="sig-name descname"><span class="pre">nsimplify</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">expr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">constants</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tolerance</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">full</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rational</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/diofant/diofant/blob/master/diofant/simplify/simplify.py#L726-L846"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#diofant.simplify.simplify.nsimplify" title="Permalink to this definition">¶</a></dt>
<dd><p>Find a simple representation for a number or, if there are free symbols or
if rational=True, then replace Floats with their Rational equivalents. If
no change is made and rational is not False then Floats will at least be
converted to Rationals.</p>
<p>For numerical expressions, a simple formula that numerically matches the
given numerical expression is sought (and the input should be possible
to evalf to a precision of at least 30 digits).</p>
<p>Optionally, a list of (rationally independent) constants to
include in the formula may be given.</p>
<p>A lower tolerance may be set to find less exact matches. If no tolerance
is given then the least precise value will set the tolerance (e.g. Floats
default to 15 digits of precision, so would be tolerance=10**-15).</p>
<p>With full=True, a more extensive search is performed
(this is useful to find simpler numbers when the tolerance
is set low).</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">nsimplify</span><span class="p">(</span><span class="mi">4</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">5</span><span class="p">)),</span> <span class="p">[</span><span class="n">GoldenRatio</span><span class="p">])</span>
<span class="go">-2 + 2*GoldenRatio</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nsimplify</span><span class="p">((</span><span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="n">exp</span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="n">pi</span><span class="o">*</span><span class="n">I</span><span class="o">/</span><span class="mi">5</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">)))</span>
<span class="go">1/2 - I*sqrt(sqrt(5)/10 + 1/4)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nsimplify</span><span class="p">(</span><span class="n">I</span><span class="o">**</span><span class="n">I</span><span class="p">,</span> <span class="p">[</span><span class="n">pi</span><span class="p">])</span>
<span class="go">E**(-pi/2)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nsimplify</span><span class="p">(</span><span class="n">pi</span><span class="p">,</span> <span class="n">tolerance</span><span class="o">=</span><span class="mf">0.01</span><span class="p">)</span>
<span class="go">22/7</span>
</pre></div>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="../core.html#diofant.core.function.nfloat" title="diofant.core.function.nfloat"><code class="xref py py-obj docutils literal notranslate"><span class="pre">diofant.core.function.nfloat</span></code></a></p>
</div>
</dd></dl>

</div>
<div class="section" id="posify">
<h2>posify<a class="headerlink" href="#posify" title="Permalink to this headline">¶</a></h2>
<dl class="py function">
<dt id="diofant.simplify.simplify.posify">
<code class="sig-prename descclassname"><span class="pre">diofant.simplify.simplify.</span></code><code class="sig-name descname"><span class="pre">posify</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">eq</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/diofant/diofant/blob/master/diofant/simplify/simplify.py#L278-L333"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#diofant.simplify.simplify.posify" title="Permalink to this definition">¶</a></dt>
<dd><p>Return eq (with generic symbols made positive) and a
dictionary containing the mapping between the old and new
symbols.</p>
<p>Any symbol that has positive=None will be replaced with a positive dummy
symbol having the same name. This replacement will allow more symbolic
processing of expressions, especially those involving powers and
logarithms.</p>
<p>A dictionary that can be sent to subs to restore eq to its original
symbols is also returned.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">posify</span><span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="n">Symbol</span><span class="p">(</span><span class="s1">&#39;p&#39;</span><span class="p">,</span> <span class="n">positive</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="o">+</span> <span class="n">Symbol</span><span class="p">(</span><span class="s1">&#39;n&#39;</span><span class="p">,</span> <span class="n">negative</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
<span class="go">(n + p + _x, {_x: x})</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">eq</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="n">x</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">log</span><span class="p">(</span><span class="n">eq</span><span class="p">)</span><span class="o">.</span><span class="n">expand</span><span class="p">()</span>
<span class="go">log(1/x)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">log</span><span class="p">(</span><span class="n">posify</span><span class="p">(</span><span class="n">eq</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">expand</span><span class="p">()</span>
<span class="go">-log(_x)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span><span class="p">,</span> <span class="n">rep</span> <span class="o">=</span> <span class="n">posify</span><span class="p">(</span><span class="n">eq</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">log</span><span class="p">(</span><span class="n">p</span><span class="p">)</span><span class="o">.</span><span class="n">expand</span><span class="p">()</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">rep</span><span class="p">)</span>
<span class="go">-log(x)</span>
</pre></div>
</div>
<p>It is possible to apply the same transformations to an iterable
of expressions:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">eq</span> <span class="o">=</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">4</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">solve</span><span class="p">(</span><span class="n">eq</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
<span class="go">[{x: -2}, {x: 2}]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">eq_x</span><span class="p">,</span> <span class="n">reps</span> <span class="o">=</span> <span class="n">posify</span><span class="p">([</span><span class="n">eq</span><span class="p">,</span> <span class="n">x</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">eq_x</span>
<span class="go">[_x**2 - 4, _x]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">solve</span><span class="p">(</span><span class="o">*</span><span class="n">eq_x</span><span class="p">)</span>
<span class="go">[{_x: 2}]</span>
</pre></div>
</div>
</dd></dl>

</div>
<div class="section" id="logcombine">
<h2>logcombine<a class="headerlink" href="#logcombine" title="Permalink to this headline">¶</a></h2>
<dl class="py function">
<dt id="diofant.simplify.simplify.logcombine">
<code class="sig-prename descclassname"><span class="pre">diofant.simplify.simplify.</span></code><code class="sig-name descname"><span class="pre">logcombine</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">expr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">force</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/diofant/diofant/blob/master/diofant/simplify/simplify.py#L849-L977"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#diofant.simplify.simplify.logcombine" title="Permalink to this definition">¶</a></dt>
<dd><p>Takes logarithms and combines them using the following rules:</p>
<ul class="simple">
<li><p>log(x) + log(y) == log(x*y) if both are not negative</p></li>
<li><p>a*log(x) == log(x**a) if x is positive and a is real</p></li>
</ul>
<p>If <code class="docutils literal notranslate"><span class="pre">force</span></code> is True then the assumptions above will be assumed to hold if
there is no assumption already in place on a quantity. For example, if
<code class="docutils literal notranslate"><span class="pre">a</span></code> is imaginary or the argument negative, force will not perform a
combination but if <code class="docutils literal notranslate"><span class="pre">a</span></code> is a symbol with no assumptions the change will
take place.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">logcombine</span><span class="p">(</span><span class="n">a</span><span class="o">*</span><span class="n">log</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="n">log</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="o">-</span> <span class="n">log</span><span class="p">(</span><span class="n">z</span><span class="p">))</span>
<span class="go">a*log(x) + log(y) - log(z)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">logcombine</span><span class="p">(</span><span class="n">a</span><span class="o">*</span><span class="n">log</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="n">log</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="o">-</span> <span class="n">log</span><span class="p">(</span><span class="n">z</span><span class="p">),</span> <span class="n">force</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">log(x**a*y/z)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span> <span class="o">=</span> <span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;x y z&#39;</span><span class="p">,</span> <span class="n">positive</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">Symbol</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="n">real</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">logcombine</span><span class="p">(</span><span class="n">a</span><span class="o">*</span><span class="n">log</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="n">log</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="o">-</span> <span class="n">log</span><span class="p">(</span><span class="n">z</span><span class="p">))</span>
<span class="go">log(x**a*y/z)</span>
</pre></div>
</div>
<p>The transformation is limited to factors and/or terms that
contain logs, so the result depends on the initial state of
expansion:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">eq</span> <span class="o">=</span> <span class="p">(</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">I</span><span class="p">)</span><span class="o">*</span><span class="n">log</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">logcombine</span><span class="p">(</span><span class="n">eq</span><span class="p">,</span> <span class="n">force</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="o">==</span> <span class="n">eq</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">logcombine</span><span class="p">(</span><span class="n">eq</span><span class="o">.</span><span class="n">expand</span><span class="p">(),</span> <span class="n">force</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">log(x**2) + I*log(x**3)</span>
</pre></div>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#diofant.simplify.simplify.posify" title="diofant.simplify.simplify.posify"><code class="xref py py-obj docutils literal notranslate"><span class="pre">posify</span></code></a></dt><dd><p>replace all symbols with symbols having positive assumptions</p>
</dd>
</dl>
</div>
</dd></dl>

</div>
<div class="section" id="module-diofant.simplify.radsimp">
<span id="radsimp"></span><h2>Radsimp<a class="headerlink" href="#module-diofant.simplify.radsimp" title="Permalink to this headline">¶</a></h2>
<div class="section" id="id2">
<h3>radsimp<a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h3>
<dl class="py function">
<dt id="diofant.simplify.radsimp.radsimp">
<code class="sig-prename descclassname"><span class="pre">diofant.simplify.radsimp.</span></code><code class="sig-name descname"><span class="pre">radsimp</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">expr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">symbolic</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_terms</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/diofant/diofant/blob/master/diofant/simplify/radsimp.py#L592-L837"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#diofant.simplify.radsimp.radsimp" title="Permalink to this definition">¶</a></dt>
<dd><p>Rationalize the denominator by removing square roots.</p>
<p>Note: the expression returned from radsimp must be used with caution
since if the denominator contains symbols, it will be possible to make
substitutions that violate the assumptions of the simplification process:
that for a denominator matching a + b*sqrt(c), a != +/-b*sqrt(c). (If
there are no symbols, this assumptions is made valid by collecting terms
of sqrt(c) so the match variable <code class="docutils literal notranslate"><span class="pre">a</span></code> does not contain <code class="docutils literal notranslate"><span class="pre">sqrt(c)</span></code>.) If
you do not want the simplification to occur for symbolic denominators, set
<code class="docutils literal notranslate"><span class="pre">symbolic</span></code> to False.</p>
<p>If there are more than <code class="docutils literal notranslate"><span class="pre">max_terms</span></code> radical terms then the expression is
returned unchanged.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">radsimp</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="n">I</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
<span class="go">(1 - I)/2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">radsimp</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span> <span class="o">+</span> <span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)))</span>
<span class="go">(-sqrt(2) + 2)/2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">e</span> <span class="o">=</span> <span class="p">((</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="p">(</span><span class="mi">2</span> <span class="o">+</span> <span class="n">sqrt</span><span class="p">(</span><span class="mi">8</span><span class="p">))</span><span class="o">*</span><span class="n">y</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span> <span class="o">+</span> <span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">radsimp</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
<span class="go">sqrt(2)*(x + y)</span>
</pre></div>
</div>
<p>No simplification beyond removal of the gcd is done. One might
want to polish the result a little, however, by collecting
square root terms:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">r2</span> <span class="o">=</span> <span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">r5</span> <span class="o">=</span> <span class="n">sqrt</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ans</span> <span class="o">=</span> <span class="n">radsimp</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="n">y</span><span class="o">*</span><span class="n">r2</span> <span class="o">+</span> <span class="n">x</span><span class="o">*</span><span class="n">r2</span> <span class="o">+</span> <span class="n">a</span><span class="o">*</span><span class="n">r5</span> <span class="o">+</span> <span class="n">b</span><span class="o">*</span><span class="n">r5</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pprint</span><span class="p">(</span><span class="n">ans</span><span class="p">,</span> <span class="n">use_unicode</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="go">    ___       ___       ___       ___</span>
<span class="go">  \/ 5 *a + \/ 5 *b - \/ 2 *x - \/ 2 *y</span>
<span class="go">------------------------------------------</span>
<span class="go">   2               2      2              2</span>
<span class="go">5*a  + 10*a*b + 5*b  - 2*x  - 4*x*y - 2*y</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">n</span><span class="p">,</span> <span class="n">d</span> <span class="o">=</span> <span class="n">fraction</span><span class="p">(</span><span class="n">ans</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pprint</span><span class="p">(</span><span class="n">factor_terms</span><span class="p">(</span><span class="n">signsimp</span><span class="p">(</span><span class="n">collect_sqrt</span><span class="p">(</span><span class="n">n</span><span class="p">))</span><span class="o">/</span><span class="n">d</span><span class="p">,</span> <span class="n">radical</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span>
<span class="gp">... </span>       <span class="n">use_unicode</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="go">        ___             ___</span>
<span class="go">      \/ 5 *(a + b) - \/ 2 *(x + y)</span>
<span class="go">------------------------------------------</span>
<span class="go">   2               2      2              2</span>
<span class="go">5*a  + 10*a*b + 5*b  - 2*x  - 4*x*y - 2*y</span>
</pre></div>
</div>
<p>If radicals in the denominator cannot be removed or there is no denominator,
the original expression will be returned.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">radsimp</span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
<span class="go">sqrt(2)*x + sqrt(2)</span>
</pre></div>
</div>
<p>Results with symbols will not always be valid for all substitutions:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">eq</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="n">a</span> <span class="o">+</span> <span class="n">b</span><span class="o">*</span><span class="n">sqrt</span><span class="p">(</span><span class="n">c</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">eq</span><span class="o">.</span><span class="n">subs</span><span class="p">({</span><span class="n">a</span><span class="p">:</span> <span class="n">b</span><span class="o">*</span><span class="n">sqrt</span><span class="p">(</span><span class="n">c</span><span class="p">)})</span>
<span class="go">1/(2*b*sqrt(c))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">radsimp</span><span class="p">(</span><span class="n">eq</span><span class="p">)</span><span class="o">.</span><span class="n">subs</span><span class="p">({</span><span class="n">a</span><span class="p">:</span> <span class="n">b</span><span class="o">*</span><span class="n">sqrt</span><span class="p">(</span><span class="n">c</span><span class="p">)})</span>
<span class="go">nan</span>
</pre></div>
</div>
<p>If symbolic=False, symbolic denominators will not be transformed (but
numeric denominators will still be processed):</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">radsimp</span><span class="p">(</span><span class="n">eq</span><span class="p">,</span> <span class="n">symbolic</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="go">1/(a + b*sqrt(c))</span>
</pre></div>
</div>
</dd></dl>

</div>
<div class="section" id="rad-rationalize">
<h3>rad_rationalize<a class="headerlink" href="#rad-rationalize" title="Permalink to this headline">¶</a></h3>
<dl class="py function">
<dt id="diofant.simplify.radsimp.rad_rationalize">
<code class="sig-prename descclassname"><span class="pre">diofant.simplify.radsimp.</span></code><code class="sig-name descname"><span class="pre">rad_rationalize</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">den</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/diofant/diofant/blob/master/diofant/simplify/radsimp.py#L840-L858"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#diofant.simplify.radsimp.rad_rationalize" title="Permalink to this definition">¶</a></dt>
<dd><p>Rationalize num/den by removing square roots in the denominator;
num and den are sum of terms whose squares are rationals</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">rad_rationalize</span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="mi">3</span><span class="p">)</span>
<span class="go">(-sqrt(3) + sqrt(6)/3, -7/9)</span>
</pre></div>
</div>
</dd></dl>

</div>
<div class="section" id="collect">
<h3>collect<a class="headerlink" href="#collect" title="Permalink to this headline">¶</a></h3>
<dl class="py function">
<dt id="diofant.simplify.radsimp.collect">
<code class="sig-prename descclassname"><span class="pre">diofant.simplify.radsimp.</span></code><code class="sig-name descname"><span class="pre">collect</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">expr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">syms</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">func</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">evaluate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exact</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">distribute_order_term</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/diofant/diofant/blob/master/diofant/simplify/radsimp.py#L16-L384"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#diofant.simplify.radsimp.collect" title="Permalink to this definition">¶</a></dt>
<dd><p>Collect additive terms of an expression.</p>
<p>This function collects additive terms of an expression with respect
to a list of expression up to powers with rational exponents. By the
term symbol here are meant arbitrary expressions, which can contain
powers, products, sums etc. In other words symbol is a pattern which
will be searched for in the expression’s terms.</p>
<p>The input expression is not expanded by <a class="reference internal" href="#diofant.simplify.radsimp.collect" title="diofant.simplify.radsimp.collect"><code class="xref py py-func docutils literal notranslate"><span class="pre">collect()</span></code></a>, so user is
expected to provide an expression is an appropriate form (for example,
by using <a class="reference internal" href="../core.html#diofant.core.function.expand" title="diofant.core.function.expand"><code class="xref py py-func docutils literal notranslate"><span class="pre">expand()</span></code></a> prior to calling this
function). This makes <a class="reference internal" href="#diofant.simplify.radsimp.collect" title="diofant.simplify.radsimp.collect"><code class="xref py py-func docutils literal notranslate"><span class="pre">collect()</span></code></a> more predictable as there is no
magic happening behind the scenes. However, it is important to note,
that powers of products are converted to products of powers using the
<a class="reference internal" href="../core.html#diofant.core.function.expand_power_base" title="diofant.core.function.expand_power_base"><code class="xref py py-func docutils literal notranslate"><span class="pre">expand_power_base()</span></code></a> function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>expr</strong> (<em>Expr</em>) – an expression</p></li>
<li><p><strong>syms</strong> (<em>iterable of Symbol’s</em>) – collected symbols</p></li>
<li><p><strong>evaluate</strong> (<em>boolean</em>) – First, if <code class="docutils literal notranslate"><span class="pre">evaluate</span></code> flag is set (by default), this function will
return an expression with collected terms else it will return a
dictionary with expressions up to rational powers as keys and
collected coefficients as values.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>This function can collect symbolic coefficients in polynomials or
rational expressions. It will manage to find all integer or rational
powers of collection variable:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">collect</span><span class="p">(</span><span class="n">a</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">b</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">a</span><span class="o">*</span><span class="n">x</span> <span class="o">-</span> <span class="n">b</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="n">c</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
<span class="go">c + x**2*(a + b) + x*(a - b)</span>
</pre></div>
</div>
<p>The same result can be achieved in dictionary form:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">d</span> <span class="o">=</span> <span class="n">collect</span><span class="p">(</span><span class="n">a</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">b</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">a</span><span class="o">*</span><span class="n">x</span> <span class="o">-</span> <span class="n">b</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="n">c</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">evaluate</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d</span><span class="p">[</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="p">]</span>
<span class="go">a + b</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d</span><span class="p">[</span><span class="n">x</span><span class="p">]</span>
<span class="go">a - b</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="go">c</span>
</pre></div>
</div>
<p>You can also work with multivariate polynomials. However, remember that
this function is greedy so it will care only about a single symbol at time,
in specification order:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">collect</span><span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">y</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">x</span><span class="o">*</span><span class="n">y</span> <span class="o">+</span> <span class="n">y</span> <span class="o">+</span> <span class="n">a</span><span class="o">*</span><span class="n">y</span><span class="p">,</span> <span class="p">[</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">])</span>
<span class="go">x**2*(y + 1) + x*y + y*(a + 1)</span>
</pre></div>
</div>
<p>Also more complicated expressions can be used as patterns:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">collect</span><span class="p">(</span><span class="n">a</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="n">b</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="p">),</span> <span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="p">))</span>
<span class="go">(a + b)*sin(2*x)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">collect</span><span class="p">(</span><span class="n">a</span><span class="o">*</span><span class="n">x</span><span class="o">*</span><span class="n">log</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="n">b</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="o">*</span><span class="n">log</span><span class="p">(</span><span class="n">x</span><span class="p">)),</span> <span class="n">x</span><span class="o">*</span><span class="n">log</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
<span class="go">x*(a + b)*log(x)</span>
</pre></div>
</div>
<p>You can use wildcards in the pattern:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">w</span> <span class="o">=</span> <span class="n">Wild</span><span class="p">(</span><span class="s1">&#39;w1&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">collect</span><span class="p">(</span><span class="n">a</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="n">y</span> <span class="o">-</span> <span class="n">b</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="n">y</span><span class="p">,</span> <span class="n">w</span><span class="o">**</span><span class="n">y</span><span class="p">)</span>
<span class="go">x**y*(a - b)</span>
</pre></div>
</div>
<p>It is also possible to work with symbolic powers, although it has more
complicated behavior, because in this case power’s base and symbolic part
of the exponent are treated as a single symbol:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">collect</span><span class="p">(</span><span class="n">a</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="n">c</span> <span class="o">+</span> <span class="n">b</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="n">c</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
<span class="go">a*x**c + b*x**c</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">collect</span><span class="p">(</span><span class="n">a</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="n">c</span> <span class="o">+</span> <span class="n">b</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="n">c</span><span class="p">,</span> <span class="n">x</span><span class="o">**</span><span class="n">c</span><span class="p">)</span>
<span class="go">x**c*(a + b)</span>
</pre></div>
</div>
<p>However if you incorporate rationals to the exponents, then you will get
well known behavior:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">collect</span><span class="p">(</span><span class="n">a</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">c</span><span class="p">)</span> <span class="o">+</span> <span class="n">b</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">c</span><span class="p">),</span> <span class="n">x</span><span class="o">**</span><span class="n">c</span><span class="p">)</span>
<span class="go">x**(2*c)*(a + b)</span>
</pre></div>
</div>
<p>Note also that all previously stated facts about <a class="reference internal" href="#diofant.simplify.radsimp.collect" title="diofant.simplify.radsimp.collect"><code class="xref py py-func docutils literal notranslate"><span class="pre">collect()</span></code></a> function
apply to the exponential function, so you can get:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">collect</span><span class="p">(</span><span class="n">a</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="n">b</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="p">),</span> <span class="n">exp</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
<span class="go">E**(2*x)*(a + b)</span>
</pre></div>
</div>
<p>If you are interested only in collecting specific powers of some symbols
then set <code class="docutils literal notranslate"><span class="pre">exact</span></code> flag in arguments:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">collect</span><span class="p">(</span><span class="n">a</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="mi">7</span> <span class="o">+</span> <span class="n">b</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="mi">7</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">exact</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">a*x**7 + b*x**7</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">collect</span><span class="p">(</span><span class="n">a</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="mi">7</span> <span class="o">+</span> <span class="n">b</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="mi">7</span><span class="p">,</span> <span class="n">x</span><span class="o">**</span><span class="mi">7</span><span class="p">,</span> <span class="n">exact</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">x**7*(a + b)</span>
</pre></div>
</div>
<p>You can also apply this function to differential equations, where
derivatives of arbitrary order can be collected. Note that if you
collect with respect to a function or a derivative of a function, all
derivatives of that function will also be collected. Use
<code class="docutils literal notranslate"><span class="pre">exact=True</span></code> to prevent this from happening:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">f</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">collect</span><span class="p">(</span><span class="n">a</span><span class="o">*</span><span class="n">Derivative</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="n">b</span><span class="o">*</span><span class="n">Derivative</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">x</span><span class="p">),</span> <span class="n">Derivative</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">x</span><span class="p">))</span>
<span class="go">(a + b)*Derivative(f(x), x)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">collect</span><span class="p">(</span><span class="n">a</span><span class="o">*</span><span class="n">Derivative</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span> <span class="o">+</span> <span class="n">b</span><span class="o">*</span><span class="n">Derivative</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">2</span><span class="p">)),</span> <span class="n">f</span><span class="p">)</span>
<span class="go">(a + b)*Derivative(f(x), x, x)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">collect</span><span class="p">(</span><span class="n">a</span><span class="o">*</span><span class="n">Derivative</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span> <span class="o">+</span> <span class="n">b</span><span class="o">*</span><span class="n">Derivative</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">2</span><span class="p">)),</span>
<span class="gp">... </span>        <span class="n">Derivative</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">x</span><span class="p">),</span> <span class="n">exact</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">a*Derivative(f(x), x, x) + b*Derivative(f(x), x, x)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">collect</span><span class="p">(</span><span class="n">a</span><span class="o">*</span><span class="n">Derivative</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="n">b</span><span class="o">*</span><span class="n">Derivative</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="n">a</span><span class="o">*</span><span class="n">f</span> <span class="o">+</span> <span class="n">b</span><span class="o">*</span><span class="n">f</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span>
<span class="go">f(x)*(a + b) + (a + b)*Derivative(f(x), x)</span>
</pre></div>
</div>
<p>Or you can even match both derivative order and exponent at the same time:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">collect</span><span class="p">(</span><span class="n">a</span><span class="o">*</span><span class="n">Derivative</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">b</span><span class="o">*</span><span class="n">Derivative</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span>
<span class="gp">... </span>        <span class="n">Derivative</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">x</span><span class="p">))</span>
<span class="go">(a + b)*Derivative(f(x), x, x)**2</span>
</pre></div>
</div>
<p>Finally, you can apply a function to each of the collected coefficients.
For example you can factorize symbolic coefficients of polynomial:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">f</span> <span class="o">=</span> <span class="n">expand</span><span class="p">((</span><span class="n">x</span> <span class="o">+</span> <span class="n">a</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">collect</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">factor</span><span class="p">)</span>
<span class="go">x**3 + 3*x**2*(a + 1) + 3*x*(a + 1)**2 + (a + 1)**3</span>
</pre></div>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#diofant.simplify.radsimp.collect_const" title="diofant.simplify.radsimp.collect_const"><code class="xref py py-obj docutils literal notranslate"><span class="pre">collect_const</span></code></a>, <a class="reference internal" href="#diofant.simplify.radsimp.collect_sqrt" title="diofant.simplify.radsimp.collect_sqrt"><code class="xref py py-obj docutils literal notranslate"><span class="pre">collect_sqrt</span></code></a>, <a class="reference internal" href="#diofant.simplify.radsimp.rcollect" title="diofant.simplify.radsimp.rcollect"><code class="xref py py-obj docutils literal notranslate"><span class="pre">rcollect</span></code></a></p>
</div>
</dd></dl>

<dl class="py function">
<dt id="diofant.simplify.radsimp.rcollect">
<code class="sig-prename descclassname"><span class="pre">diofant.simplify.radsimp.</span></code><code class="sig-name descname"><span class="pre">rcollect</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">expr</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">vars</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/diofant/diofant/blob/master/diofant/simplify/radsimp.py#L387-L412"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#diofant.simplify.radsimp.rcollect" title="Permalink to this definition">¶</a></dt>
<dd><p>Recursively collect sums in an expression.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">expr</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">y</span> <span class="o">+</span> <span class="n">x</span><span class="o">*</span><span class="n">y</span> <span class="o">+</span> <span class="n">x</span> <span class="o">+</span> <span class="n">y</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="n">y</span><span class="p">)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">rcollect</span><span class="p">(</span><span class="n">expr</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="go">(x + y*(x**2 + x + 1))/(x + y)</span>
</pre></div>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#diofant.simplify.radsimp.collect" title="diofant.simplify.radsimp.collect"><code class="xref py py-obj docutils literal notranslate"><span class="pre">collect</span></code></a>, <a class="reference internal" href="#diofant.simplify.radsimp.collect_const" title="diofant.simplify.radsimp.collect_const"><code class="xref py py-obj docutils literal notranslate"><span class="pre">collect_const</span></code></a>, <a class="reference internal" href="#diofant.simplify.radsimp.collect_sqrt" title="diofant.simplify.radsimp.collect_sqrt"><code class="xref py py-obj docutils literal notranslate"><span class="pre">collect_sqrt</span></code></a></p>
</div>
</dd></dl>

</div>
<div class="section" id="collect-sqrt">
<h3>collect_sqrt<a class="headerlink" href="#collect-sqrt" title="Permalink to this headline">¶</a></h3>
<dl class="py function">
<dt id="diofant.simplify.radsimp.collect_sqrt">
<code class="sig-prename descclassname"><span class="pre">diofant.simplify.radsimp.</span></code><code class="sig-name descname"><span class="pre">collect_sqrt</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">expr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">evaluate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/diofant/diofant/blob/master/diofant/simplify/radsimp.py#L415-L485"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#diofant.simplify.radsimp.collect_sqrt" title="Permalink to this definition">¶</a></dt>
<dd><p>Return expr with terms having common square roots collected together.
If <code class="docutils literal notranslate"><span class="pre">evaluate</span></code> is False a count indicating the number of sqrt-containing
terms will be returned and, if non-zero, the terms of the Add will be
returned, else the expression itself will be returned as a single term.
If <code class="docutils literal notranslate"><span class="pre">evaluate</span></code> is True, the expression with any collected terms will be
returned.</p>
<p>Note: since I = sqrt(-1), it is collected, too.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">r2</span><span class="p">,</span> <span class="n">r3</span><span class="p">,</span> <span class="n">r5</span> <span class="o">=</span> <span class="p">[</span><span class="n">sqrt</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">collect_sqrt</span><span class="p">(</span><span class="n">a</span><span class="o">*</span><span class="n">r2</span> <span class="o">+</span> <span class="n">b</span><span class="o">*</span><span class="n">r2</span><span class="p">)</span>
<span class="go">sqrt(2)*(a + b)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">collect_sqrt</span><span class="p">(</span><span class="n">a</span><span class="o">*</span><span class="n">r2</span> <span class="o">+</span> <span class="n">b</span><span class="o">*</span><span class="n">r2</span> <span class="o">+</span> <span class="n">a</span><span class="o">*</span><span class="n">r3</span> <span class="o">+</span> <span class="n">b</span><span class="o">*</span><span class="n">r3</span><span class="p">)</span>
<span class="go">sqrt(2)*(a + b) + sqrt(3)*(a + b)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">collect_sqrt</span><span class="p">(</span><span class="n">a</span><span class="o">*</span><span class="n">r2</span> <span class="o">+</span> <span class="n">b</span><span class="o">*</span><span class="n">r2</span> <span class="o">+</span> <span class="n">a</span><span class="o">*</span><span class="n">r3</span> <span class="o">+</span> <span class="n">b</span><span class="o">*</span><span class="n">r5</span><span class="p">)</span>
<span class="go">sqrt(3)*a + sqrt(5)*b + sqrt(2)*(a + b)</span>
</pre></div>
</div>
<p>If evaluate is False then the arguments will be sorted and
returned as a list and a count of the number of sqrt-containing
terms will be returned:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">collect_sqrt</span><span class="p">(</span><span class="n">a</span><span class="o">*</span><span class="n">r2</span> <span class="o">+</span> <span class="n">b</span><span class="o">*</span><span class="n">r2</span> <span class="o">+</span> <span class="n">a</span><span class="o">*</span><span class="n">r3</span> <span class="o">+</span> <span class="n">b</span><span class="o">*</span><span class="n">r5</span><span class="p">,</span> <span class="n">evaluate</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="go">((sqrt(3)*a, sqrt(5)*b, sqrt(2)*(a + b)), 3)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">collect_sqrt</span><span class="p">(</span><span class="n">a</span><span class="o">*</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">b</span><span class="p">,</span> <span class="n">evaluate</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="go">((b, sqrt(2)*a), 1)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">collect_sqrt</span><span class="p">(</span><span class="n">a</span> <span class="o">+</span> <span class="n">b</span><span class="p">,</span> <span class="n">evaluate</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="go">((a + b,), 0)</span>
</pre></div>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#diofant.simplify.radsimp.collect" title="diofant.simplify.radsimp.collect"><code class="xref py py-obj docutils literal notranslate"><span class="pre">collect</span></code></a>, <a class="reference internal" href="#diofant.simplify.radsimp.collect_const" title="diofant.simplify.radsimp.collect_const"><code class="xref py py-obj docutils literal notranslate"><span class="pre">collect_const</span></code></a>, <a class="reference internal" href="#diofant.simplify.radsimp.rcollect" title="diofant.simplify.radsimp.rcollect"><code class="xref py py-obj docutils literal notranslate"><span class="pre">rcollect</span></code></a></p>
</div>
</dd></dl>

</div>
<div class="section" id="collect-const">
<h3>collect_const<a class="headerlink" href="#collect-const" title="Permalink to this headline">¶</a></h3>
<dl class="py function">
<dt id="diofant.simplify.radsimp.collect_const">
<code class="sig-prename descclassname"><span class="pre">diofant.simplify.radsimp.</span></code><code class="sig-name descname"><span class="pre">collect_const</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">expr</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">vars</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/diofant/diofant/blob/master/diofant/simplify/radsimp.py#L488-L589"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#diofant.simplify.radsimp.collect_const" title="Permalink to this definition">¶</a></dt>
<dd><p>A non-greedy collection of terms with similar number coefficients in
an Add expr. If <code class="docutils literal notranslate"><span class="pre">vars</span></code> is given then only those constants will be
targeted. Although any Number can also be targeted, if this is not
desired set <code class="docutils literal notranslate"><span class="pre">Numbers=False</span></code> and no Float or Rational will be collected.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">diofant.abc</span> <span class="kn">import</span> <span class="n">s</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">collect_const</span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="n">sqrt</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)))</span>
<span class="go">sqrt(3)*(sqrt(2) + 2)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">collect_const</span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="n">s</span> <span class="o">+</span> <span class="n">sqrt</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span><span class="o">*</span><span class="n">s</span> <span class="o">+</span> <span class="n">sqrt</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="n">sqrt</span><span class="p">(</span><span class="mi">7</span><span class="p">))</span>
<span class="go">(sqrt(3) + sqrt(7))*(s + 1)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">collect_const</span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="n">s</span> <span class="o">+</span> <span class="n">sqrt</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="n">sqrt</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span><span class="o">*</span><span class="n">s</span> <span class="o">+</span> <span class="n">sqrt</span><span class="p">(</span><span class="mi">7</span><span class="p">))</span>
<span class="go">(sqrt(2) + 3)*(sqrt(3) + sqrt(7))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">collect_const</span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="n">s</span> <span class="o">+</span> <span class="n">sqrt</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="n">sqrt</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span><span class="o">*</span><span class="n">s</span> <span class="o">+</span> <span class="n">sqrt</span><span class="p">(</span><span class="mi">7</span><span class="p">),</span> <span class="n">sqrt</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
<span class="go">sqrt(7) + sqrt(3)*(sqrt(2) + 3) + sqrt(7)*(sqrt(2) + 2)</span>
</pre></div>
</div>
<p>The collection is sign-sensitive, giving higher precedence to the
unsigned values:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">collect_const</span><span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="n">y</span> <span class="o">-</span> <span class="n">z</span><span class="p">)</span>
<span class="go">x - (y + z)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">collect_const</span><span class="p">(</span><span class="o">-</span><span class="n">y</span> <span class="o">-</span> <span class="n">z</span><span class="p">)</span>
<span class="go">-(y + z)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">collect_const</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">y</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">z</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="go">2*(x - y - z)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">collect_const</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">y</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">z</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">)</span>
<span class="go">2*x - 2*(y + z)</span>
</pre></div>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#diofant.simplify.radsimp.collect" title="diofant.simplify.radsimp.collect"><code class="xref py py-obj docutils literal notranslate"><span class="pre">collect</span></code></a>, <a class="reference internal" href="#diofant.simplify.radsimp.collect_sqrt" title="diofant.simplify.radsimp.collect_sqrt"><code class="xref py py-obj docutils literal notranslate"><span class="pre">collect_sqrt</span></code></a>, <a class="reference internal" href="#diofant.simplify.radsimp.rcollect" title="diofant.simplify.radsimp.rcollect"><code class="xref py py-obj docutils literal notranslate"><span class="pre">rcollect</span></code></a></p>
</div>
</dd></dl>

</div>
<div class="section" id="fraction">
<h3>fraction<a class="headerlink" href="#fraction" title="Permalink to this headline">¶</a></h3>
<dl class="py function">
<dt id="diofant.simplify.radsimp.fraction">
<code class="sig-prename descclassname"><span class="pre">diofant.simplify.radsimp.</span></code><code class="sig-name descname"><span class="pre">fraction</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">expr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exact</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/diofant/diofant/blob/master/diofant/simplify/radsimp.py#L861-L933"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#diofant.simplify.radsimp.fraction" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a pair with expression’s numerator and denominator.</p>
<p>If the given expression is not a fraction then this function
will return the tuple (expr, 1).</p>
<p>This function will not make any attempt to simplify nested
fractions or to do any term rewriting at all.</p>
<p>If only one of the numerator/denominator pair is needed then
use numer(expr) or denom(expr) functions respectively.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">fraction</span><span class="p">(</span><span class="n">x</span><span class="o">/</span><span class="n">y</span><span class="p">)</span>
<span class="go">(x, y)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fraction</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="go">(x, 1)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">fraction</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">y</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<span class="go">(1, y**2)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">fraction</span><span class="p">(</span><span class="n">x</span><span class="o">*</span><span class="n">y</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
<span class="go">(x*y, 2)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fraction</span><span class="p">(</span><span class="n">Rational</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="go">(1, 2)</span>
</pre></div>
</div>
<p>This function will also work fine with assumptions:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">k</span> <span class="o">=</span> <span class="n">Symbol</span><span class="p">(</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">negative</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fraction</span><span class="p">(</span><span class="n">x</span> <span class="o">*</span> <span class="n">y</span><span class="o">**</span><span class="n">k</span><span class="p">)</span>
<span class="go">(x, y**(-k))</span>
</pre></div>
</div>
<p>If we know nothing about sign of some exponent and ‘exact’
flag is unset, then structure this exponent’s structure will
be analyzed and pretty fraction will be returned:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">fraction</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="n">y</span><span class="p">))</span>
<span class="go">(2, x**y)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">fraction</span><span class="p">(</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">x</span><span class="p">))</span>
<span class="go">(1, E**x)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">fraction</span><span class="p">(</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">x</span><span class="p">),</span> <span class="n">exact</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">(E**(-x), 1)</span>
</pre></div>
</div>
</dd></dl>

</div>
</div>
<div class="section" id="module-diofant.simplify.ratsimp">
<span id="ratsimp"></span><h2>Ratsimp<a class="headerlink" href="#module-diofant.simplify.ratsimp" title="Permalink to this headline">¶</a></h2>
<div class="section" id="id3">
<h3>ratsimp<a class="headerlink" href="#id3" title="Permalink to this headline">¶</a></h3>
<dl class="py function">
<dt id="diofant.simplify.ratsimp.ratsimp">
<code class="sig-prename descclassname"><span class="pre">diofant.simplify.ratsimp.</span></code><code class="sig-name descname"><span class="pre">ratsimp</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">expr</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/diofant/diofant/blob/master/diofant/simplify/ratsimp.py#L9-L26"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#diofant.simplify.ratsimp.ratsimp" title="Permalink to this definition">¶</a></dt>
<dd><p>Put an expression over a common denominator, cancel and reduce.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ratsimp</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">x</span> <span class="o">+</span> <span class="mi">1</span><span class="o">/</span><span class="n">y</span><span class="p">)</span>
<span class="go">(x + y)/(x*y)</span>
</pre></div>
</div>
</dd></dl>

</div>
</div>
<div class="section" id="module-diofant.simplify.trigsimp">
<span id="trigonometric-simplification"></span><h2>Trigonometric simplification<a class="headerlink" href="#module-diofant.simplify.trigsimp" title="Permalink to this headline">¶</a></h2>
<div class="section" id="trigsimp">
<h3>trigsimp<a class="headerlink" href="#trigsimp" title="Permalink to this headline">¶</a></h3>
<dl class="py function">
<dt id="diofant.simplify.trigsimp.trigsimp">
<code class="sig-prename descclassname"><span class="pre">diofant.simplify.trigsimp.</span></code><code class="sig-name descname"><span class="pre">trigsimp</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">expr</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">opts</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/diofant/diofant/blob/master/diofant/simplify/trigsimp.py#L412-L496"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#diofant.simplify.trigsimp.trigsimp" title="Permalink to this definition">¶</a></dt>
<dd><p>Reduces expression by using known trig identities.</p>
<p class="rubric">Notes</p>
<p>method:
- Determine the method to use. Valid choices are ‘matching’ (default),
‘groebner’, ‘combined’, and ‘fu’. If ‘matching’, simplify the
expression recursively by targeting common patterns. If ‘groebner’, apply
an experimental groebner basis algorithm. In this case further options
are forwarded to <code class="docutils literal notranslate"><span class="pre">trigsimp_groebner</span></code>, please refer to its docstring.
If ‘combined’, first run the groebner basis algorithm with small
default parameters, then run the ‘matching’ algorithm. ‘fu’ runs the
collection of trigonometric transformations described by Fu, et al.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">e</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">trigsimp</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
<span class="go">2</span>
</pre></div>
</div>
<p>Simplification occurs wherever trigonometric functions are located.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">trigsimp</span><span class="p">(</span><span class="n">log</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>
<span class="go">log(2)</span>
</pre></div>
</div>
<p>Using <span class="math notranslate nohighlight">\(method=&quot;groebner&quot;\)</span> (or <span class="math notranslate nohighlight">\(&quot;combined&quot;\)</span>) might lead to greater
simplification.</p>
<p>The old trigsimp routine can be accessed as with method ‘old’.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">t</span> <span class="o">=</span> <span class="mi">3</span><span class="o">*</span><span class="n">tanh</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">**</span><span class="mi">7</span> <span class="o">-</span> <span class="mi">2</span><span class="o">/</span><span class="n">coth</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">**</span><span class="mi">7</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">trigsimp</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;old&#39;</span><span class="p">)</span> <span class="o">==</span> <span class="n">t</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">trigsimp</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
<span class="go">tanh(x)**7</span>
</pre></div>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#diofant.simplify.fu.fu" title="diofant.simplify.fu.fu"><code class="xref py py-obj docutils literal notranslate"><span class="pre">diofant.simplify.fu.fu</span></code></a></p>
</div>
</dd></dl>

</div>
<div class="section" id="futrig">
<h3>futrig<a class="headerlink" href="#futrig" title="Permalink to this headline">¶</a></h3>
<dl class="py function">
<dt id="diofant.simplify.trigsimp.futrig">
<code class="sig-prename descclassname"><span class="pre">diofant.simplify.trigsimp.</span></code><code class="sig-name descname"><span class="pre">futrig</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">e</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/diofant/diofant/blob/master/diofant/simplify/trigsimp.py#L1061-L1099"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#diofant.simplify.trigsimp.futrig" title="Permalink to this definition">¶</a></dt>
<dd><p>Return simplified <code class="docutils literal notranslate"><span class="pre">e</span></code> using Fu-like transformations.
This is not the “Fu” algorithm. This is called by default
from <code class="docutils literal notranslate"><span class="pre">trigsimp</span></code>. By default, hyperbolics subexpressions
will be simplified, but this can be disabled by setting
<code class="docutils literal notranslate"><span class="pre">hyper=False</span></code>.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">trigsimp</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">tan</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<span class="go">tan(x)**(-2)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">futrig</span><span class="p">(</span><span class="n">sinh</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">/</span><span class="n">tanh</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
<span class="go">cosh(x)</span>
</pre></div>
</div>
</dd></dl>

</div>
<div class="section" id="module-diofant.simplify.fu">
<span id="fu"></span><h3>fu<a class="headerlink" href="#module-diofant.simplify.fu" title="Permalink to this headline">¶</a></h3>
<dl class="py function">
<dt id="diofant.simplify.fu.fu">
<code class="sig-prename descclassname"><span class="pre">diofant.simplify.fu.</span></code><code class="sig-name descname"><span class="pre">fu</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="pre">rv</span></em>, <em class="sig-param"><span class="pre">measure=&lt;function</span> <span class="pre">&lt;lambda&gt;&gt;</span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/diofant/diofant/blob/master/diofant/simplify/fu.py#L1600-L1685"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#diofant.simplify.fu.fu" title="Permalink to this definition">¶</a></dt>
<dd><p>Attempt to simplify expression by using transformation rules given
in the algorithm by Fu et al.</p>
<p><a class="reference internal" href="#diofant.simplify.fu.fu" title="diofant.simplify.fu.fu"><code class="xref py py-func docutils literal notranslate"><span class="pre">fu()</span></code></a> will try to minimize the objective function <code class="docutils literal notranslate"><span class="pre">measure</span></code>.
By default this first minimizes the number of trig terms and then minimizes
the number of total operations.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">fu</span><span class="p">(</span><span class="n">sin</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">cos</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">sin</span><span class="p">(</span><span class="n">pi</span><span class="o">/</span><span class="mi">6</span><span class="p">))</span>
<span class="go">3/2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fu</span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
<span class="go">2*sqrt(2)*sin(x + pi/3)</span>
</pre></div>
</div>
<p>CTR1 example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">eq</span> <span class="o">=</span> <span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">**</span><span class="mi">4</span> <span class="o">-</span> <span class="n">cos</span><span class="p">(</span><span class="n">y</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">sin</span><span class="p">(</span><span class="n">y</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fu</span><span class="p">(</span><span class="n">eq</span><span class="p">)</span>
<span class="go">cos(x)**4 - 2*cos(y)**2 + 2</span>
</pre></div>
</div>
<p>CTR2 example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">fu</span><span class="p">(</span><span class="n">Rational</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="n">cos</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
<span class="go">sin(x)**2</span>
</pre></div>
</div>
<p>CTR3 example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">fu</span><span class="p">(</span><span class="n">sin</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">cos</span><span class="p">(</span><span class="n">b</span><span class="p">)</span> <span class="o">-</span> <span class="n">sin</span><span class="p">(</span><span class="n">b</span><span class="p">))</span> <span class="o">+</span> <span class="n">cos</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">sin</span><span class="p">(</span><span class="n">b</span><span class="p">)</span> <span class="o">+</span> <span class="n">cos</span><span class="p">(</span><span class="n">b</span><span class="p">)))</span>
<span class="go">sqrt(2)*sin(a + b + pi/4)</span>
</pre></div>
</div>
<p>CTR4 example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">fu</span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span> <span class="o">+</span> <span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
<span class="go">sin(x + pi/3)</span>
</pre></div>
</div>
<p>Example 1</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">fu</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="mi">4</span><span class="o">-</span><span class="n">sin</span><span class="p">(</span><span class="n">y</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">-</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">**</span><span class="mi">4</span><span class="p">)</span>
<span class="go">-cos(x)**2 + cos(y)**2</span>
</pre></div>
</div>
<p>Example 2</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">fu</span><span class="p">(</span><span class="n">cos</span><span class="p">(</span><span class="mi">4</span><span class="o">*</span><span class="n">pi</span><span class="o">/</span><span class="mi">9</span><span class="p">))</span>
<span class="go">sin(pi/18)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fu</span><span class="p">(</span><span class="n">cos</span><span class="p">(</span><span class="n">pi</span><span class="o">/</span><span class="mi">9</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">pi</span><span class="o">/</span><span class="mi">9</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="n">pi</span><span class="o">/</span><span class="mi">9</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="mi">4</span><span class="o">*</span><span class="n">pi</span><span class="o">/</span><span class="mi">9</span><span class="p">))</span>
<span class="go">1/16</span>
</pre></div>
</div>
<p>Example 3</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">fu</span><span class="p">(</span><span class="n">tan</span><span class="p">(</span><span class="mi">7</span><span class="o">*</span><span class="n">pi</span><span class="o">/</span><span class="mi">18</span><span class="p">)</span><span class="o">+</span><span class="n">tan</span><span class="p">(</span><span class="mi">5</span><span class="o">*</span><span class="n">pi</span><span class="o">/</span><span class="mi">18</span><span class="p">)</span><span class="o">-</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="n">tan</span><span class="p">(</span><span class="mi">5</span><span class="o">*</span><span class="n">pi</span><span class="o">/</span><span class="mi">18</span><span class="p">)</span><span class="o">*</span><span class="n">tan</span><span class="p">(</span><span class="mi">7</span><span class="o">*</span><span class="n">pi</span><span class="o">/</span><span class="mi">18</span><span class="p">))</span>
<span class="go">-sqrt(3)</span>
</pre></div>
</div>
<p>Objective function example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">fu</span><span class="p">(</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">/</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>  <span class="c1"># default objective function</span>
<span class="go">tan(x)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fu</span><span class="p">(</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">/</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">measure</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="o">-</span><span class="n">x</span><span class="o">.</span><span class="n">count_ops</span><span class="p">())</span>  <span class="c1"># maximize op count</span>
<span class="go">sin(x)/cos(x)</span>
</pre></div>
</div>
<p class="rubric">References</p>
<p><a class="reference external" href="http://rfdz.ph-noe.ac.at/fileadmin/Mathematik_Uploads/ACDCA/">http://rfdz.ph-noe.ac.at/fileadmin/Mathematik_Uploads/ACDCA/</a>
DESTIME2006/DES_contribs/Fu/simplification.pdf</p>
</dd></dl>

</div>
</div>
<div class="section" id="module-diofant.simplify.powsimp">
<span id="power-simplification"></span><h2>Power simplification<a class="headerlink" href="#module-diofant.simplify.powsimp" title="Permalink to this headline">¶</a></h2>
<div class="section" id="powsimp">
<h3>powsimp<a class="headerlink" href="#powsimp" title="Permalink to this headline">¶</a></h3>
<dl class="py function">
<dt id="diofant.simplify.powsimp.powsimp">
<code class="sig-prename descclassname"><span class="pre">diofant.simplify.powsimp.</span></code><code class="sig-name descname"><span class="pre">powsimp</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="pre">expr</span></em>, <em class="sig-param"><span class="pre">deep=False</span></em>, <em class="sig-param"><span class="pre">combine='all'</span></em>, <em class="sig-param"><span class="pre">force=False</span></em>, <em class="sig-param"><span class="pre">measure=&lt;function</span> <span class="pre">count_ops&gt;</span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/diofant/diofant/blob/master/diofant/simplify/powsimp.py#L17-L477"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#diofant.simplify.powsimp.powsimp" title="Permalink to this definition">¶</a></dt>
<dd><p>Reduces expression by combining powers with similar bases and exponents.</p>
<p class="rubric">Notes</p>
<p>If deep is True then powsimp() will also simplify arguments of
functions. By default deep is set to False.</p>
<p>If force is True then bases will be combined without checking for
assumptions, e.g. sqrt(x)*sqrt(y) -&gt; sqrt(x*y) which is not true
if x and y are both negative.</p>
<p>You can make powsimp() only combine bases or only combine exponents by
changing combine=’base’ or combine=’exp’.  By default, combine=’all’,
which does both.  combine=’base’ will only combine:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span> <span class="n">a</span>   <span class="n">a</span>          <span class="n">a</span>                          <span class="mi">2</span><span class="n">x</span>      <span class="n">x</span>
<span class="n">x</span> <span class="o">*</span> <span class="n">y</span>  <span class="o">=&gt;</span>  <span class="p">(</span><span class="n">x</span><span class="o">*</span><span class="n">y</span><span class="p">)</span>   <span class="k">as</span> <span class="n">well</span> <span class="k">as</span> <span class="n">things</span> <span class="n">like</span> <span class="mi">2</span>   <span class="o">=&gt;</span>  <span class="mi">4</span>
</pre></div>
</div>
<p>and combine=’exp’ will only combine</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span> <span class="n">a</span>   <span class="n">b</span>      <span class="p">(</span><span class="n">a</span> <span class="o">+</span> <span class="n">b</span><span class="p">)</span>
<span class="n">x</span> <span class="o">*</span> <span class="n">x</span>  <span class="o">=&gt;</span>  <span class="n">x</span>
</pre></div>
</div>
<p>combine=’exp’ will strictly only combine exponents in the way that used
to be automatic.  Also use deep=True if you need the old behavior.</p>
<p>When combine=’all’, ‘exp’ is evaluated first.  Consider the first
example below for when there could be an ambiguity relating to this.
This is done so things like the second example can be completely
combined.  If you want ‘base’ combined first, do something like
powsimp(powsimp(expr, combine=’base’), combine=’exp’).</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">powsimp</span><span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="n">y</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="n">z</span><span class="o">*</span><span class="n">y</span><span class="o">**</span><span class="n">z</span><span class="p">,</span> <span class="n">combine</span><span class="o">=</span><span class="s1">&#39;all&#39;</span><span class="p">)</span>
<span class="go">x**(y + z)*y**z</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">powsimp</span><span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="n">y</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="n">z</span><span class="o">*</span><span class="n">y</span><span class="o">**</span><span class="n">z</span><span class="p">,</span> <span class="n">combine</span><span class="o">=</span><span class="s1">&#39;exp&#39;</span><span class="p">)</span>
<span class="go">x**(y + z)*y**z</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">powsimp</span><span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="n">y</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="n">z</span><span class="o">*</span><span class="n">y</span><span class="o">**</span><span class="n">z</span><span class="p">,</span> <span class="n">combine</span><span class="o">=</span><span class="s1">&#39;base&#39;</span><span class="p">,</span> <span class="n">force</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">x**y*(x*y)**z</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">powsimp</span><span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="n">z</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="n">y</span><span class="o">*</span><span class="n">n</span><span class="o">**</span><span class="n">z</span><span class="o">*</span><span class="n">n</span><span class="o">**</span><span class="n">y</span><span class="p">,</span> <span class="n">combine</span><span class="o">=</span><span class="s1">&#39;all&#39;</span><span class="p">,</span> <span class="n">force</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">(n*x)**(y + z)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">powsimp</span><span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="n">z</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="n">y</span><span class="o">*</span><span class="n">n</span><span class="o">**</span><span class="n">z</span><span class="o">*</span><span class="n">n</span><span class="o">**</span><span class="n">y</span><span class="p">,</span> <span class="n">combine</span><span class="o">=</span><span class="s1">&#39;exp&#39;</span><span class="p">)</span>
<span class="go">n**(y + z)*x**(y + z)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">powsimp</span><span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="n">z</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="n">y</span><span class="o">*</span><span class="n">n</span><span class="o">**</span><span class="n">z</span><span class="o">*</span><span class="n">n</span><span class="o">**</span><span class="n">y</span><span class="p">,</span> <span class="n">combine</span><span class="o">=</span><span class="s1">&#39;base&#39;</span><span class="p">,</span> <span class="n">force</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">(n*x)**y*(n*x)**z</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;x y&#39;</span><span class="p">,</span> <span class="n">positive</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">powsimp</span><span class="p">(</span><span class="n">log</span><span class="p">(</span><span class="n">exp</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="n">y</span><span class="p">)))</span>
<span class="go">log(E**x*E**y)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">powsimp</span><span class="p">(</span><span class="n">log</span><span class="p">(</span><span class="n">exp</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="n">y</span><span class="p">)),</span> <span class="n">deep</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">x + y</span>
</pre></div>
</div>
<p>Radicals with Mul bases will be combined if combine=’exp’</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;x y&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Two radicals are automatically joined through Mul:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">x</span><span class="o">*</span><span class="n">sqrt</span><span class="p">(</span><span class="n">y</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="o">*</span><span class="n">a</span><span class="o">**</span><span class="mi">3</span> <span class="o">==</span> <span class="n">a</span><span class="o">**</span><span class="mi">4</span>
<span class="go">True</span>
</pre></div>
</div>
<p>But if an integer power of that radical has been
autoexpanded then Mul does not join the resulting factors:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="o">**</span><span class="mi">4</span>  <span class="c1"># auto expands to a Mul, no longer a Pow</span>
<span class="go">x**2*y</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">_</span><span class="o">*</span><span class="n">a</span>  <span class="c1"># so Mul doesn&#39;t combine them</span>
<span class="go">x**2*y*sqrt(x*sqrt(y))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">powsimp</span><span class="p">(</span><span class="n">_</span><span class="p">)</span>  <span class="c1"># but powsimp will</span>
<span class="go">(x*sqrt(y))**(5/2)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">powsimp</span><span class="p">(</span><span class="n">x</span><span class="o">*</span><span class="n">y</span><span class="o">*</span><span class="n">a</span><span class="p">)</span>  <span class="c1"># but won&#39;t when doing so would violate assumptions</span>
<span class="go">x*y*sqrt(x*sqrt(y))</span>
</pre></div>
</div>
</dd></dl>

</div>
<div class="section" id="powdenest">
<h3>powdenest<a class="headerlink" href="#powdenest" title="Permalink to this headline">¶</a></h3>
<dl class="py function">
<dt id="diofant.simplify.powsimp.powdenest">
<code class="sig-prename descclassname"><span class="pre">diofant.simplify.powsimp.</span></code><code class="sig-name descname"><span class="pre">powdenest</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">eq</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">force</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">polar</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/diofant/diofant/blob/master/diofant/simplify/powsimp.py#L480-L576"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#diofant.simplify.powsimp.powdenest" title="Permalink to this definition">¶</a></dt>
<dd><p>Collect exponents on powers as assumptions allow.</p>
<dl class="simple">
<dt>Given <code class="docutils literal notranslate"><span class="pre">(bb**be)**e</span></code>, this can be simplified as follows:</dt><dd><ul class="simple">
<li><p>if <code class="docutils literal notranslate"><span class="pre">bb</span></code> is positive, or</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">e</span></code> is an integer, or</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">|be|</span> <span class="pre">&lt;</span> <span class="pre">1</span></code> then this simplifies to <code class="docutils literal notranslate"><span class="pre">bb**(be*e)</span></code></p></li>
</ul>
</dd>
</dl>
<p>Given a product of powers raised to a power, <code class="docutils literal notranslate"><span class="pre">(bb1**be1</span> <span class="pre">*</span>
<span class="pre">bb2**be2...)**e</span></code>, simplification can be done as follows:</p>
<ul class="simple">
<li><p>if e is positive, the gcd of all bei can be joined with e;</p></li>
<li><p>all non-negative bb can be separated from those that are negative
and their gcd can be joined with e; autosimplification already
handles this separation.</p></li>
<li><p>integer factors from powers that have integers in the denominator
of the exponent can be removed from any term and the gcd of such
integers can be joined with e</p></li>
</ul>
<p>Setting <code class="docutils literal notranslate"><span class="pre">force</span></code> to True will make symbols that are not explicitly
negative behave as though they are positive, resulting in more
denesting.</p>
<p>Setting <code class="docutils literal notranslate"><span class="pre">polar</span></code> to True will do simplifications on the Riemann surface of
the logarithm, also resulting in more denestings.</p>
<p>When there are sums of logs in exp() then a product of powers may be
obtained e.g. <code class="docutils literal notranslate"><span class="pre">exp(3*(log(a)</span> <span class="pre">+</span> <span class="pre">2*log(b)))</span></code> - &gt; <code class="docutils literal notranslate"><span class="pre">a**3*b**6</span></code>.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">powdenest</span><span class="p">((</span><span class="n">x</span><span class="o">**</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">a</span><span class="o">/</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="n">x</span><span class="p">))</span>
<span class="go">(x**(2*a/3))**(3*x)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">powdenest</span><span class="p">(</span><span class="n">exp</span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="n">x</span><span class="o">*</span><span class="n">log</span><span class="p">(</span><span class="mi">2</span><span class="p">)))</span>
<span class="go">2**(3*x)</span>
</pre></div>
</div>
<p>Assumptions may prevent expansion:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">powdenest</span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span>
<span class="go">sqrt(x**2)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">p</span> <span class="o">=</span> <span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;p&#39;</span><span class="p">,</span> <span class="n">positive</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">powdenest</span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="n">p</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span>
<span class="go">p</span>
</pre></div>
</div>
<p>No other expansion is done.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="o">=</span> <span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;i j&#39;</span><span class="p">,</span> <span class="n">integer</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">powdenest</span><span class="p">((</span><span class="n">x</span><span class="o">**</span><span class="n">x</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="n">j</span><span class="p">))</span>  <span class="c1"># -X-&gt; (x**x)**i*(x**x)**j</span>
<span class="go">x**(x*(i + j))</span>
</pre></div>
</div>
<p>But exp() will be denested by moving all non-log terms outside of
the function; this may result in the collapsing of the exp to a power
with a different base:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">powdenest</span><span class="p">(</span><span class="n">exp</span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="n">y</span><span class="o">*</span><span class="n">log</span><span class="p">(</span><span class="n">x</span><span class="p">)))</span>
<span class="go">x**(3*y)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">powdenest</span><span class="p">(</span><span class="n">exp</span><span class="p">(</span><span class="n">y</span><span class="o">*</span><span class="p">(</span><span class="n">log</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="o">+</span> <span class="n">log</span><span class="p">(</span><span class="n">b</span><span class="p">))))</span>
<span class="go">(a*b)**y</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">powdenest</span><span class="p">(</span><span class="n">exp</span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="p">(</span><span class="n">log</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="o">+</span> <span class="n">log</span><span class="p">(</span><span class="n">b</span><span class="p">))))</span>
<span class="go">a**3*b**3</span>
</pre></div>
</div>
<p>If assumptions allow, symbols can also be moved to the outermost exponent:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">i</span> <span class="o">=</span> <span class="n">Symbol</span><span class="p">(</span><span class="s1">&#39;i&#39;</span><span class="p">,</span> <span class="n">integer</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">powdenest</span><span class="p">(((</span><span class="n">x</span><span class="o">**</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">i</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="n">y</span><span class="p">))</span><span class="o">**</span><span class="n">x</span><span class="p">)</span>
<span class="go">((x**(2*i))**(3*y))**x</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">powdenest</span><span class="p">(((</span><span class="n">x</span><span class="o">**</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">i</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="n">y</span><span class="p">))</span><span class="o">**</span><span class="n">x</span><span class="p">,</span> <span class="n">force</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">x**(6*i*x*y)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">powdenest</span><span class="p">(((</span><span class="n">x</span><span class="o">**</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">a</span><span class="o">/</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="n">y</span><span class="o">/</span><span class="n">i</span><span class="p">))</span><span class="o">**</span><span class="n">x</span><span class="p">)</span>
<span class="go">((x**(2*a/3))**(3*y/i))**x</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">powdenest</span><span class="p">((</span><span class="n">x</span><span class="o">**</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">i</span><span class="p">)</span><span class="o">*</span><span class="n">y</span><span class="o">**</span><span class="p">(</span><span class="mi">4</span><span class="o">*</span><span class="n">i</span><span class="p">))</span><span class="o">**</span><span class="n">z</span><span class="p">,</span> <span class="n">force</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">(x*y**2)**(2*i*z)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">n</span> <span class="o">=</span> <span class="n">Symbol</span><span class="p">(</span><span class="s1">&#39;n&#39;</span><span class="p">,</span> <span class="n">negative</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">powdenest</span><span class="p">((</span><span class="n">x</span><span class="o">**</span><span class="n">i</span><span class="p">)</span><span class="o">**</span><span class="n">y</span><span class="p">,</span> <span class="n">force</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">x**(i*y)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">powdenest</span><span class="p">((</span><span class="n">n</span><span class="o">**</span><span class="n">i</span><span class="p">)</span><span class="o">**</span><span class="n">x</span><span class="p">,</span> <span class="n">force</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">(n**i)**x</span>
</pre></div>
</div>
</dd></dl>

</div>
</div>
<div class="section" id="module-diofant.simplify.combsimp">
<span id="combinatorial-simplification"></span><h2>Combinatorial simplification<a class="headerlink" href="#module-diofant.simplify.combsimp" title="Permalink to this headline">¶</a></h2>
<div class="section" id="combsimp">
<h3>combsimp<a class="headerlink" href="#combsimp" title="Permalink to this headline">¶</a></h3>
<dl class="py function">
<dt id="diofant.simplify.combsimp.combsimp">
<code class="sig-prename descclassname"><span class="pre">diofant.simplify.combsimp.</span></code><code class="sig-name descname"><span class="pre">combsimp</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">expr</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/diofant/diofant/blob/master/diofant/simplify/combsimp.py#L10-L462"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#diofant.simplify.combsimp.combsimp" title="Permalink to this definition">¶</a></dt>
<dd><p>Simplify combinatorial expressions.</p>
<p>This function takes as input an expression containing factorials,
binomials, Pochhammer symbol and other “combinatorial” functions,
and tries to minimize the number of those functions and reduce
the size of their arguments.</p>
<p>The algorithm works by rewriting all combinatorial functions as
expressions involving rising factorials (Pochhammer symbols) and
applies recurrence relations and other transformations applicable
to rising factorials, to reduce their arguments, possibly letting
the resulting rising factorial to cancel. Rising factorials with
the second argument being an integer are expanded into polynomial
forms and finally all other rising factorial are rewritten in terms
of more familiar functions. If the initial expression consisted of
gamma functions alone, the result is expressed in terms of gamma
functions. If the initial expression consists of gamma function
with some other combinatorial, the result is expressed in terms of
gamma functions.</p>
<p>If the result is expressed using gamma functions, the following three
additional steps are performed:</p>
<ol class="arabic simple">
<li><p>Reduce the number of gammas by applying the reflection theorem
gamma(x)*gamma(1-x) == pi/sin(pi*x).</p></li>
<li><p>Reduce the number of gammas by applying the multiplication theorem
gamma(x)*gamma(x+1/n)*…*gamma(x+(n-1)/n) == C*gamma(n*x).</p></li>
<li><p>Reduce the number of prefactors by absorbing them into gammas, where
possible.</p></li>
</ol>
<p>All transformation rules can be found (or was derived from) here:</p>
<ol class="arabic simple">
<li><p><a class="reference external" href="http://functions.wolfram.com/GammaBetaErf/Pochhammer/17/01/02/">http://functions.wolfram.com/GammaBetaErf/Pochhammer/17/01/02/</a></p></li>
<li><p><a class="reference external" href="http://functions.wolfram.com/GammaBetaErf/Pochhammer/27/01/0005/">http://functions.wolfram.com/GammaBetaErf/Pochhammer/27/01/0005/</a></p></li>
</ol>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">combsimp</span><span class="p">(</span><span class="n">factorial</span><span class="p">(</span><span class="n">n</span><span class="p">)</span><span class="o">/</span><span class="n">factorial</span><span class="p">(</span><span class="n">n</span> <span class="o">-</span> <span class="mi">3</span><span class="p">))</span>
<span class="go">n*(n - 2)*(n - 1)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">combsimp</span><span class="p">(</span><span class="n">binomial</span><span class="p">(</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">k</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="n">binomial</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">k</span><span class="p">))</span>
<span class="go">(n + 1)/(k + 1)</span>
</pre></div>
</div>
</dd></dl>

</div>
</div>
<div class="section" id="module-diofant.simplify.sqrtdenest">
<span id="square-root-denest"></span><h2>Square Root Denest<a class="headerlink" href="#module-diofant.simplify.sqrtdenest" title="Permalink to this headline">¶</a></h2>
<div class="section" id="sqrtdenest">
<h3>sqrtdenest<a class="headerlink" href="#sqrtdenest" title="Permalink to this headline">¶</a></h3>
<dl class="py function">
<dt id="diofant.simplify.sqrtdenest.sqrtdenest">
<code class="sig-prename descclassname"><span class="pre">diofant.simplify.sqrtdenest.</span></code><code class="sig-name descname"><span class="pre">sqrtdenest</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">expr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_iter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/diofant/diofant/blob/master/diofant/simplify/sqrtdenest.py#L97-L128"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#diofant.simplify.sqrtdenest.sqrtdenest" title="Permalink to this definition">¶</a></dt>
<dd><p>Denests sqrts in an expression that contain other square roots
if possible, otherwise returns the expr unchanged. This is based on the
algorithms of [1].</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">sqrtdenest</span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">5</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">sqrt</span><span class="p">(</span><span class="mi">6</span><span class="p">)))</span>
<span class="go">sqrt(2) + sqrt(3)</span>
</pre></div>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#diofant.simplify.sqrtdenest.unrad" title="diofant.simplify.sqrtdenest.unrad"><code class="xref py py-obj docutils literal notranslate"><span class="pre">unrad</span></code></a></p>
</div>
<p class="rubric">References</p>
<ul class="simple">
<li><p><a class="reference external" href="https://researcher.watson.ibm.com/researcher/files/us-fagin/symb85.pdf">https://researcher.watson.ibm.com/researcher/files/us-fagin/symb85.pdf</a></p></li>
<li><p>D. J. Jeffrey and A. D. Rich, ‘Symplifying Square Roots of Square Roots
by Denesting’ (available at <a class="reference external" href="http://www.cybertester.com/data/denest.pdf">http://www.cybertester.com/data/denest.pdf</a>)</p></li>
</ul>
</dd></dl>

</div>
<div class="section" id="unrad">
<h3>unrad<a class="headerlink" href="#unrad" title="Permalink to this headline">¶</a></h3>
<dl class="py function">
<dt id="diofant.simplify.sqrtdenest.unrad">
<code class="sig-prename descclassname"><span class="pre">diofant.simplify.sqrtdenest.</span></code><code class="sig-name descname"><span class="pre">unrad</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">eq</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">syms</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">flags</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/diofant/diofant/blob/master/diofant/simplify/sqrtdenest.py#L597-L958"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#diofant.simplify.sqrtdenest.unrad" title="Permalink to this definition">¶</a></dt>
<dd><p>Remove radicals with symbolic arguments and return (eq, cov),
None or raise an error:</p>
<p>None is returned if there are no radicals to remove.</p>
<p>NotImplementedError is raised if there are radicals and they cannot be
removed or if the relationship between the original symbols and the
change of variable needed to rewrite the system as a polynomial cannot
be solved.</p>
<p>Otherwise the tuple, <code class="docutils literal notranslate"><span class="pre">(eq,</span> <span class="pre">cov)</span></code>, is returned where:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>``eq``, ``cov``
    ``eq`` is an equation without radicals (in the symbol(s) of
    interest) whose solutions are a superset of the solutions to the
    original expression. ``eq`` might be re-written in terms of a new
    variable; the relationship to the original variables is given by
    ``cov`` which is a list containing ``v`` and ``v**p - b`` where
    ``p`` is the power needed to clear the radical and ``b`` is the
    radical now expressed as a polynomial in the symbols of interest.
    For example, for sqrt(2 - x) the tuple would be
    ``(c, c**2 - 2 + x)``. The solutions of ``eq`` will contain
    solutions to the original equation (if there are any).
</pre></div>
</div>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">syms</span></code></dt><dd><p>an iterable of symbols which, if provided, will limit the focus of
radical removal: only radicals with one or more of the symbols of
interest will be cleared. All free symbols are used if <code class="docutils literal notranslate"><span class="pre">syms</span></code> is not
set.</p>
</dd>
</dl>
<p><code class="docutils literal notranslate"><span class="pre">flags</span></code> are used internally for communication during recursive calls.
Two options are also recognized:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>``take``, when defined, is interpreted as a single-argument function
that returns True if a given Pow should be handled.
</pre></div>
</div>
<p>Radicals can be removed from an expression if:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">*</span>   <span class="nb">all</span> <span class="n">bases</span> <span class="n">of</span> <span class="n">the</span> <span class="n">radicals</span> <span class="n">are</span> <span class="n">the</span> <span class="n">same</span><span class="p">;</span> <span class="n">a</span> <span class="n">change</span> <span class="n">of</span> <span class="n">variables</span> <span class="ow">is</span>
    <span class="n">done</span> <span class="ow">in</span> <span class="n">this</span> <span class="n">case</span><span class="o">.</span>
<span class="o">*</span>   <span class="k">if</span> <span class="nb">all</span> <span class="n">radicals</span> <span class="n">appear</span> <span class="ow">in</span> <span class="n">one</span> <span class="n">term</span> <span class="n">of</span> <span class="n">the</span> <span class="n">expression</span>
<span class="o">*</span>   <span class="n">there</span> <span class="n">are</span> <span class="n">only</span> <span class="mi">4</span> <span class="n">terms</span> <span class="k">with</span> <span class="n">sqrt</span><span class="p">()</span> <span class="n">factors</span> <span class="ow">or</span> <span class="n">there</span> <span class="n">are</span> <span class="n">less</span> <span class="n">than</span>
    <span class="n">four</span> <span class="n">terms</span> <span class="n">having</span> <span class="n">sqrt</span><span class="p">()</span> <span class="n">factors</span>
<span class="o">*</span>   <span class="n">there</span> <span class="n">are</span> <span class="n">only</span> <span class="n">two</span> <span class="n">terms</span> <span class="k">with</span> <span class="n">radicals</span>
</pre></div>
</div>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">unrad</span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">*</span><span class="n">cbrt</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="p">)</span>
<span class="go">(x**5 - 64, [])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">unrad</span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="n">root</span><span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="go">(x**3 - x**2 - 2*x - 1, [])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">eq</span> <span class="o">=</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="n">root</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span> <span class="o">-</span> <span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">unrad</span><span class="p">(</span><span class="n">eq</span><span class="p">)</span>
<span class="go">(_p**3 + _p**2 - 2, [_p, -x + _p**6])</span>
</pre></div>
</div>
</dd></dl>

</div>
</div>
<div class="section" id="module-diofant.simplify.cse_main">
<span id="common-subexpresion-elimination"></span><h2>Common Subexpresion Elimination<a class="headerlink" href="#module-diofant.simplify.cse_main" title="Permalink to this headline">¶</a></h2>
<div class="section" id="cse">
<h3>cse<a class="headerlink" href="#cse" title="Permalink to this headline">¶</a></h3>
<dl class="py function">
<dt id="diofant.simplify.cse_main.cse">
<code class="sig-prename descclassname"><span class="pre">diofant.simplify.cse_main.</span></code><code class="sig-name descname"><span class="pre">cse</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">exprs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">symbols</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">optimizations</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">postprocess</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">order</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'canonical'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ignore</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">()</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/diofant/diofant/blob/master/diofant/simplify/cse_main.py#L374-L518"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#diofant.simplify.cse_main.cse" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform common subexpression elimination on an expression.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>exprs</strong> (<em>list of diofant expressions, or a single diofant expression</em>) – The expressions to reduce.</p></li>
<li><p><strong>symbols</strong> (<em>infinite iterator yielding unique Symbols</em>) – The symbols used to label the common subexpressions which are pulled
out. The <code class="docutils literal notranslate"><span class="pre">numbered_symbols</span></code> generator is useful. The default is a
stream of symbols of the form “x0”, “x1”, etc. This must be an
infinite iterator.</p></li>
<li><p><strong>optimizations</strong> (<em>list of (callable, callable) pairs</em>) – The (preprocessor, postprocessor) pairs of external optimization
functions. Optionally ‘basic’ can be passed for a set of predefined
basic optimizations. Such ‘basic’ optimizations were used by default
in old implementation, however they can be really slow on larger
expressions. Now, no pre or post optimizations are made by default.</p></li>
<li><p><strong>postprocess</strong> (<em>a function which accepts the two return values of cse and</em>) – returns the desired form of output from cse, e.g. if you want the
replacements reversed the function might be the following lambda:
lambda r, e: return reversed(r), e</p></li>
<li><p><strong>order</strong> (<em>string, ‘none’ or ‘canonical’</em>) – The order by which Mul and Add arguments are processed. If set to
‘canonical’, arguments will be canonically ordered. If set to ‘none’,
ordering will be faster but dependent on expressions hashes, thus
machine dependent and variable. For large expressions where speed is a
concern, use the setting order=’none’.</p></li>
<li><p><strong>ignore</strong> (<em>iterable of Symbol’s</em>) – Substitutions containing these symbols will be ignored.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>replacements</strong> (<em>list of (Symbol, expression) pairs</em>) – All of the common subexpressions that were replaced. Subexpressions
earlier in this list might show up in subexpressions later in this
list.</p></li>
<li><p><strong>reduced_exprs</strong> (<em>list of diofant expressions</em>) – The reduced expressions with all of the replacements above.</p></li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">diofant.abc</span> <span class="kn">import</span> <span class="n">w</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cse</span><span class="p">(((</span><span class="n">w</span> <span class="o">+</span> <span class="n">x</span> <span class="o">+</span> <span class="n">y</span> <span class="o">+</span> <span class="n">z</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">w</span> <span class="o">+</span> <span class="n">y</span> <span class="o">+</span> <span class="n">z</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">w</span> <span class="o">+</span> <span class="n">x</span><span class="p">)</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span>
<span class="go">([(x0, y + z), (x1, w + x)], [(w + x0)*(x0 + x1)/x1**3])</span>
</pre></div>
</div>
<p>Note that currently, y + z will not get substituted if -y - z is used.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">cse</span><span class="p">(((</span><span class="n">w</span> <span class="o">+</span> <span class="n">x</span> <span class="o">+</span> <span class="n">y</span> <span class="o">+</span> <span class="n">z</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">w</span> <span class="o">-</span> <span class="n">y</span> <span class="o">-</span> <span class="n">z</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">w</span> <span class="o">+</span> <span class="n">x</span><span class="p">)</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span>
<span class="go">([(x0, w + x)], [(w - y - z)*(x0 + y + z)/x0**3])</span>
</pre></div>
</div>
<p>List of expressions with recursive substitutions:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">m</span> <span class="o">=</span> <span class="n">SparseMatrix</span><span class="p">([</span><span class="n">x</span> <span class="o">+</span> <span class="n">y</span><span class="p">,</span> <span class="n">x</span> <span class="o">+</span> <span class="n">y</span> <span class="o">+</span> <span class="n">z</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cse</span><span class="p">([(</span><span class="n">x</span><span class="o">+</span><span class="n">y</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span> <span class="n">x</span> <span class="o">+</span> <span class="n">y</span> <span class="o">+</span> <span class="n">z</span><span class="p">,</span> <span class="n">y</span> <span class="o">+</span> <span class="n">z</span><span class="p">,</span> <span class="n">x</span> <span class="o">+</span> <span class="n">z</span> <span class="o">+</span> <span class="n">y</span><span class="p">,</span> <span class="n">m</span><span class="p">])</span>
<span class="go">([(x0, x + y), (x1, x0 + z)], [x0**2, x1, y + z, x1, Matrix([</span>
<span class="go">[x0],</span>
<span class="go">[x1]])])</span>
</pre></div>
</div>
<p>Note: the type and mutability of input matrices is retained.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">isinstance</span><span class="p">(</span><span class="n">_</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">SparseMatrix</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
<p>The user may disallow substitutions containing certain symbols:
&gt;&gt;&gt; cse([y**2*(x + 1), 3*y**2*(x + 1)], ignore=(y,))
([(x0, x + 1)], [x0*y**2, 3*x0*y**2])</p>
</dd></dl>

</div>
<div class="section" id="opt-cse">
<h3>opt_cse<a class="headerlink" href="#opt-cse" title="Permalink to this headline">¶</a></h3>
<dl class="py function">
<dt id="diofant.simplify.cse_main.opt_cse">
<code class="sig-prename descclassname"><span class="pre">diofant.simplify.cse_main.</span></code><code class="sig-name descname"><span class="pre">opt_cse</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">exprs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">order</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'canonical'</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/diofant/diofant/blob/master/diofant/simplify/cse_main.py#L135-L255"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#diofant.simplify.cse_main.opt_cse" title="Permalink to this definition">¶</a></dt>
<dd><p>Find optimization opportunities in Adds, Muls, Pows and negative
coefficient Muls</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>exprs</strong> (<em>list of diofant expressions</em>) – The expressions to optimize.</p></li>
<li><p><strong>order</strong> (<em>string, ‘none’ or ‘canonical’</em>) – The order by which Mul and Add arguments are processed. For large
expressions where speed is a concern, use the setting order=’none’.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>opt_subs</strong> (<em>dictionary of expression substitutions</em>) – The expression substitutions which can be useful to optimize CSE.</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">opt_subs</span> <span class="o">=</span> <span class="n">opt_cse</span><span class="p">([</span><span class="n">x</span><span class="o">**-</span><span class="mi">2</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">opt_subs</span>
<span class="go">{x**(-2): 1/(x**2)}</span>
</pre></div>
</div>
</dd></dl>

</div>
<div class="section" id="tree-cse">
<h3>tree_cse<a class="headerlink" href="#tree-cse" title="Permalink to this headline">¶</a></h3>
<dl class="py function">
<dt id="diofant.simplify.cse_main.tree_cse">
<code class="sig-prename descclassname"><span class="pre">diofant.simplify.cse_main.</span></code><code class="sig-name descname"><span class="pre">tree_cse</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">exprs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">symbols</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">opt_subs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">order</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'canonical'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ignore</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">()</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/diofant/diofant/blob/master/diofant/simplify/cse_main.py#L258-L371"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#diofant.simplify.cse_main.tree_cse" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform raw CSE on expression tree, taking opt_subs into account.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>exprs</strong> (<em>list of diofant expressions</em>) – The expressions to reduce.</p></li>
<li><p><strong>symbols</strong> (<em>infinite iterator yielding unique Symbols</em>) – The symbols used to label the common subexpressions which are pulled
out.</p></li>
<li><p><strong>opt_subs</strong> (<em>dictionary of expression substitutions</em>) – The expressions to be substituted before any CSE action is performed.</p></li>
<li><p><strong>order</strong> (<em>string, ‘none’ or ‘canonical’</em>) – The order by which Mul and Add arguments are processed. For large
expressions where speed is a concern, use the setting order=’none’.</p></li>
<li><p><strong>ignore</strong> (<em>iterable of Symbol’s</em>) – Substitutions containing these symbols will be ignored.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</div>
</div>
<div class="section" id="module-diofant.simplify.hyperexpand">
<span id="hypergeometric-function-expansion"></span><h2>Hypergeometric Function Expansion<a class="headerlink" href="#module-diofant.simplify.hyperexpand" title="Permalink to this headline">¶</a></h2>
<div class="section" id="hyperexpand">
<h3>hyperexpand<a class="headerlink" href="#hyperexpand" title="Permalink to this headline">¶</a></h3>
<dl class="py function">
<dt id="diofant.simplify.hyperexpand.hyperexpand">
<code class="sig-prename descclassname"><span class="pre">diofant.simplify.hyperexpand.</span></code><code class="sig-name descname"><span class="pre">hyperexpand</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">f</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">allow_hyper</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rewrite</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'default'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">place</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/diofant/diofant/blob/master/diofant/simplify/hyperexpand.py#L2435-L2472"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#diofant.simplify.hyperexpand.hyperexpand" title="Permalink to this definition">¶</a></dt>
<dd><p>Expand hypergeometric functions. If allow_hyper is True, allow partial
simplification (that is a result different from input,
but still containing hypergeometric functions).</p>
<p>If a G-function has expansions both at zero and at infinity,
<code class="docutils literal notranslate"><span class="pre">place</span></code> can be set to <code class="docutils literal notranslate"><span class="pre">0</span></code> or <code class="docutils literal notranslate"><span class="pre">zoo</span></code> to indicate the
preferred choice.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">hyperexpand</span><span class="p">(</span><span class="n">hyper</span><span class="p">([],</span> <span class="p">[],</span> <span class="n">z</span><span class="p">))</span>
<span class="go">E**z</span>
</pre></div>
</div>
<p>Non-hyperegeometric parts of the expression and hypergeometric expressions
that are not recognised are left unchanged:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">hyperexpand</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">hyper</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[],</span> <span class="n">z</span><span class="p">))</span>
<span class="go">hyper((1, 1, 1), (), z) + 1</span>
</pre></div>
</div>
</dd></dl>

</div>
</div>
<div class="section" id="module-diofant.simplify.traversaltools">
<span id="traversal-tools"></span><h2>Traversal Tools<a class="headerlink" href="#module-diofant.simplify.traversaltools" title="Permalink to this headline">¶</a></h2>
<div class="section" id="use">
<h3>use<a class="headerlink" href="#use" title="Permalink to this headline">¶</a></h3>
<dl class="py function">
<dt id="diofant.simplify.traversaltools.use">
<code class="sig-prename descclassname"><span class="pre">diofant.simplify.traversaltools.</span></code><code class="sig-name descname"><span class="pre">use</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">expr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">func</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">level</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">args</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">()</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/diofant/diofant/blob/master/diofant/simplify/traversaltools.py#L6-L36"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#diofant.simplify.traversaltools.use" title="Permalink to this definition">¶</a></dt>
<dd><p>Use <code class="docutils literal notranslate"><span class="pre">func</span></code> to transform <code class="docutils literal notranslate"><span class="pre">expr</span></code> at the given level.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">f</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="n">y</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="mi">1</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">use</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">expand</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="go">x*(x**2 + 2*x*y + y**2) + 1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">expand</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
<span class="go">x**3 + 2*x**2*y + x*y**2 + 1</span>
</pre></div>
</div>
</dd></dl>

</div>
</div>
<div class="section" id="module-diofant.simplify.epathtools">
<span id="epath-tools"></span><h2>EPath Tools<a class="headerlink" href="#module-diofant.simplify.epathtools" title="Permalink to this headline">¶</a></h2>
<div class="section" id="epath-class">
<h3>EPath class<a class="headerlink" href="#epath-class" title="Permalink to this headline">¶</a></h3>
<dl class="py class">
<dt id="diofant.simplify.epathtools.EPath">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">diofant.simplify.epathtools.</span></code><code class="sig-name descname"><span class="pre">EPath</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/diofant/diofant/blob/master/diofant/simplify/epathtools.py#L6-L273"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#diofant.simplify.epathtools.EPath" title="Permalink to this definition">¶</a></dt>
<dd><p>Manipulate expressions using paths.</p>
<p>EPath grammar in EBNF notation:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>literal   ::= /[A-Za-z_][A-Za-z_0-9]*/
number    ::= /-?\d+/
type      ::= literal
attribute ::= literal &quot;?&quot;
all       ::= &quot;*&quot;
slice     ::= &quot;[&quot; number? (&quot;:&quot; number? (&quot;:&quot; number?)?)? &quot;]&quot;
range     ::= all | slice
query     ::= (type | attribute) (&quot;|&quot; (type | attribute))*
selector  ::= range | query range?
path      ::= &quot;/&quot; selector (&quot;/&quot; selector)*
</pre></div>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#diofant.simplify.epathtools.epath" title="diofant.simplify.epathtools.epath"><code class="xref py py-obj docutils literal notranslate"><span class="pre">epath</span></code></a></p>
</div>
<dl class="py method">
<dt id="diofant.simplify.epathtools.EPath.apply">
<code class="sig-name descname"><span class="pre">apply</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">expr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">func</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">args</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/diofant/diofant/blob/master/diofant/simplify/epathtools.py#L155-L221"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#diofant.simplify.epathtools.EPath.apply" title="Permalink to this definition">¶</a></dt>
<dd><p>Modify parts of an expression selected by a path.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">path</span> <span class="o">=</span> <span class="n">EPath</span><span class="p">(</span><span class="s1">&#39;/*/[0]/Symbol&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">expr</span> <span class="o">=</span> <span class="p">[((</span><span class="n">x</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="mi">2</span><span class="p">),</span> <span class="p">((</span><span class="mi">3</span><span class="p">,</span> <span class="n">y</span><span class="p">),</span> <span class="n">z</span><span class="p">)]</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">path</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">expr</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">expr</span><span class="p">:</span> <span class="n">expr</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<span class="go">[((x**2, 1), 2), ((3, y**2), z)]</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">path</span> <span class="o">=</span> <span class="n">EPath</span><span class="p">(</span><span class="s1">&#39;/*/*/Symbol&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">expr</span> <span class="o">=</span> <span class="n">t</span> <span class="o">+</span> <span class="n">sin</span><span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">cos</span><span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="n">y</span> <span class="o">+</span> <span class="n">E</span><span class="p">)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">path</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">expr</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">expr</span><span class="p">:</span> <span class="mi">2</span><span class="o">*</span><span class="n">expr</span><span class="p">)</span>
<span class="go">t + sin(2*x + 1) + cos(2*x + 2*y + E)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="diofant.simplify.epathtools.EPath.select">
<code class="sig-name descname"><span class="pre">select</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">expr</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/diofant/diofant/blob/master/diofant/simplify/epathtools.py#L223-L273"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#diofant.simplify.epathtools.EPath.select" title="Permalink to this definition">¶</a></dt>
<dd><p>Retrieve parts of an expression selected by a path.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">path</span> <span class="o">=</span> <span class="n">EPath</span><span class="p">(</span><span class="s1">&#39;/*/[0]/Symbol&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">expr</span> <span class="o">=</span> <span class="p">[((</span><span class="n">x</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="mi">2</span><span class="p">),</span> <span class="p">((</span><span class="mi">3</span><span class="p">,</span> <span class="n">y</span><span class="p">),</span> <span class="n">z</span><span class="p">)]</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">path</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">expr</span><span class="p">)</span>
<span class="go">[x, y]</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">path</span> <span class="o">=</span> <span class="n">EPath</span><span class="p">(</span><span class="s1">&#39;/*/*/Symbol&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">expr</span> <span class="o">=</span> <span class="n">t</span> <span class="o">+</span> <span class="n">sin</span><span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">cos</span><span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="n">y</span> <span class="o">+</span> <span class="n">E</span><span class="p">)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">path</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">expr</span><span class="p">)</span>
<span class="go">[x, x, y]</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="epath">
<h3>epath<a class="headerlink" href="#epath" title="Permalink to this headline">¶</a></h3>
<dl class="py function">
<dt id="diofant.simplify.epathtools.epath">
<code class="sig-prename descclassname"><span class="pre">diofant.simplify.epathtools.</span></code><code class="sig-name descname"><span class="pre">epath</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">expr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">func</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">args</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/diofant/diofant/blob/master/diofant/simplify/epathtools.py#L276-L344"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#diofant.simplify.epathtools.epath" title="Permalink to this definition">¶</a></dt>
<dd><p>Manipulate parts of an expression selected by a path.</p>
<p>This function allows to manipulate large nested expressions in single
line of code, utilizing techniques to those applied in XML processing
standards (e.g. XPath).</p>
<p>If <code class="docutils literal notranslate"><span class="pre">func</span></code> is <code class="docutils literal notranslate"><span class="pre">None</span></code>, <a class="reference internal" href="#diofant.simplify.epathtools.epath" title="diofant.simplify.epathtools.epath"><code class="xref py py-func docutils literal notranslate"><span class="pre">epath()</span></code></a> retrieves elements selected by
the <code class="docutils literal notranslate"><span class="pre">path</span></code>. Otherwise it applies <code class="docutils literal notranslate"><span class="pre">func</span></code> to each matching element.</p>
<p>Note that it is more efficient to create an EPath object and use the select
and apply methods of that object, since this will compile the path string
only once.  This function should only be used as a convenient shortcut for
interactive use.</p>
<p>This is the supported syntax:</p>
<ul class="simple">
<li><dl class="simple">
<dt>select all: <code class="docutils literal notranslate"><span class="pre">/*</span></code></dt><dd><p>Equivalent of <code class="docutils literal notranslate"><span class="pre">for</span> <span class="pre">arg</span> <span class="pre">in</span> <span class="pre">args:</span></code>.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>select slice: <code class="docutils literal notranslate"><span class="pre">/[0]</span></code> or <code class="docutils literal notranslate"><span class="pre">/[1:5]</span></code> or <code class="docutils literal notranslate"><span class="pre">/[1:5:2]</span></code></dt><dd><p>Supports standard Python’s slice syntax.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>select by type: <code class="docutils literal notranslate"><span class="pre">/list</span></code> or <code class="docutils literal notranslate"><span class="pre">/list|tuple</span></code></dt><dd><p>Emulates <code class="docutils literal notranslate"><span class="pre">isinstance</span></code>.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>select by attribute: <code class="docutils literal notranslate"><span class="pre">/__iter__?</span></code></dt><dd><p>Emulates <code class="docutils literal notranslate"><span class="pre">hasattr</span></code>.</p>
</dd>
</dl>
</li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>path</strong> (<em>str | EPath</em>) – A path as a string or a compiled EPath.</p></li>
<li><p><strong>expr</strong> (<em>Basic | iterable</em>) – An expression or a container of expressions.</p></li>
<li><p><strong>func</strong> (<em>callable (optional)</em>) – A callable that will be applied to matching parts.</p></li>
<li><p><strong>args</strong> (<em>tuple (optional)</em>) – Additional positional arguments to <code class="docutils literal notranslate"><span class="pre">func</span></code>.</p></li>
<li><p><strong>kwargs</strong> (<em>dict (optional)</em>) – Additional keyword arguments to <code class="docutils literal notranslate"><span class="pre">func</span></code>.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">path</span> <span class="o">=</span> <span class="s1">&#39;/*/[0]/Symbol&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">expr</span> <span class="o">=</span> <span class="p">[((</span><span class="n">x</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="mi">2</span><span class="p">),</span> <span class="p">((</span><span class="mi">3</span><span class="p">,</span> <span class="n">y</span><span class="p">),</span> <span class="n">z</span><span class="p">)]</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">epath</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">expr</span><span class="p">)</span>
<span class="go">[x, y]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">epath</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">expr</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">expr</span><span class="p">:</span> <span class="n">expr</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<span class="go">[((x**2, 1), 2), ((3, y**2), z)]</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">path</span> <span class="o">=</span> <span class="s1">&#39;/*/*/Symbol&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">expr</span> <span class="o">=</span> <span class="n">t</span> <span class="o">+</span> <span class="n">sin</span><span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">cos</span><span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="n">y</span> <span class="o">+</span> <span class="n">E</span><span class="p">)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">epath</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">expr</span><span class="p">)</span>
<span class="go">[x, x, y]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">epath</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">expr</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">expr</span><span class="p">:</span> <span class="mi">2</span><span class="o">*</span><span class="n">expr</span><span class="p">)</span>
<span class="go">t + sin(2*x + 1) + cos(2*x + 2*y + E)</span>
</pre></div>
</div>
</dd></dl>

</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="../stats.html" class="btn btn-neutral float-right" title="Stats" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="../sets.html" class="btn btn-neutral float-left" title="Sets" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2006-2018 SymPy Development Team, 2013-2021 Sergey B Kirpichev.

    </p>
  </div> 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
    <!-- Theme Analytics -->
    <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-147167689-1', 'auto');
    
    ga('send', 'pageview');
    </script>

    
   

</body>
</html>


<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Autowrap Module &mdash; Diofant 0.11.1.dev339+g6a9399b9c documentation</title>
  

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/graphviz.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/custom.css" type="text/css" />

  
  
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
  
  
  

  
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script src="../../_static/language_data.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
        <script type="text/x-mathjax-config">MathJax.Hub.Config({"CommonHTML": {"linebreaks": {"automatic": true}}, "HTML-CSS": {"linebreaks": {"automatic": true}}, "SVG": {"linebreaks": {"automatic": true}}})</script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Codegen" href="codegen.html" />
    <link rel="prev" title="Utilities" href="index.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../index.html">
          

          
            
            <img src="../../_static/logo.svg" class="logo" alt="Logo"/>
          
          </a>

          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../install.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tutorial/index.html">Tutorial</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">Reference</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../core.html">Core</a></li>
<li class="toctree-l2"><a class="reference internal" href="../combinatorics/index.html">Combinatorics</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ntheory.html">Number Theory</a></li>
<li class="toctree-l2"><a class="reference internal" href="../concrete.html">Concrete Mathematics</a></li>
<li class="toctree-l2"><a class="reference internal" href="../functions/index.html">Mathematical Functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../geometry/index.html">Geometry</a></li>
<li class="toctree-l2"><a class="reference internal" href="../integrals.html">Integrals</a></li>
<li class="toctree-l2"><a class="reference internal" href="../logic.html">Logic</a></li>
<li class="toctree-l2"><a class="reference internal" href="../domains.html">Domains</a></li>
<li class="toctree-l2"><a class="reference internal" href="../matrices/index.html">Matrices</a></li>
<li class="toctree-l2"><a class="reference internal" href="../polys.html">Polynomials</a></li>
<li class="toctree-l2"><a class="reference internal" href="../printing.html">Printing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../interactive.html">Interactive</a></li>
<li class="toctree-l2"><a class="reference internal" href="../plotting.html">Plotting</a></li>
<li class="toctree-l2"><a class="reference internal" href="../series.html">Series</a></li>
<li class="toctree-l2"><a class="reference internal" href="../sets.html">Sets</a></li>
<li class="toctree-l2"><a class="reference internal" href="../simplify/simplify.html">Simplify</a></li>
<li class="toctree-l2"><a class="reference internal" href="../stats.html">Stats</a></li>
<li class="toctree-l2"><a class="reference internal" href="../solvers/index.html">Solvers</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tensor/index.html">Tensors</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="index.html">Utilities</a><ul class="current">
<li class="toctree-l3 current"><a class="current reference internal" href="#">Autowrap Module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#implementation-details">Implementation details</a></li>
<li class="toctree-l4"><a class="reference internal" href="#module-diofant.utilities.autowrap">API Reference</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="codegen.html">Codegen</a></li>
<li class="toctree-l3"><a class="reference internal" href="decorator.html">Decorator</a></li>
<li class="toctree-l3"><a class="reference internal" href="enumerative.html">Enumerative</a></li>
<li class="toctree-l3"><a class="reference internal" href="iterables.html">Iterables</a></li>
<li class="toctree-l3"><a class="reference internal" href="lambdify.html">Lambdify</a></li>
<li class="toctree-l3"><a class="reference internal" href="memoization.html">Memoization</a></li>
<li class="toctree-l3"><a class="reference internal" href="misc.html">Miscellaneous</a></li>
<li class="toctree-l3"><a class="reference internal" href="randtest.html">Randomised Testing</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../parsing.html">Parsing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../calculus/index.html">Calculus</a></li>
<li class="toctree-l2"><a class="reference internal" href="../diffgeom.html">Differential Geometry</a></li>
<li class="toctree-l2"><a class="reference internal" href="../vector/index.html">Vectors</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../internals/index.html">Internals</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../guide.html">Development</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../aboutus.html">About</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../release/index.html">Release Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../sources.html">Bibliography</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">Diofant</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="../index.html">Reference</a> &raquo;</li>
        
          <li><a href="index.html">Utilities</a> &raquo;</li>
        
      <li>Autowrap Module</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../_sources/modules/utilities/autowrap.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="autowrap-module">
<h1>Autowrap Module<a class="headerlink" href="#autowrap-module" title="Permalink to this headline">¶</a></h1>
<p>The autowrap module works very well in tandem with the Indexed classes of the
<a class="reference internal" href="../tensor/index.html#tensor-module"><span class="std std-ref">Tensors</span></a>.  Here is a simple example that shows how to setup a binary
routine that calculates a matrix-vector product.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">diofant.utilities.autowrap</span> <span class="kn">import</span> <span class="n">autowrap</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">A</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="nb">map</span><span class="p">(</span><span class="n">IndexedBase</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">i</span> <span class="o">=</span> <span class="n">Idx</span><span class="p">(</span><span class="s1">&#39;i&#39;</span><span class="p">,</span> <span class="n">m</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">j</span> <span class="o">=</span> <span class="n">Idx</span><span class="p">(</span><span class="s1">&#39;j&#39;</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">instruction</span> <span class="o">=</span> <span class="n">Eq</span><span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="n">j</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">instruction</span>
<span class="go">Eq(y[i], x[j]*A[i, j])</span>
</pre></div>
</div>
<p>Because the code printers treat Indexed objects with repeated indices as a
summation, the above equality instance will be translated to low-level code for
a matrix vector product.  This is how you tell Diofant to generate the code,
compile it and wrap it as a python function:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">matvec</span> <span class="o">=</span> <span class="n">autowrap</span><span class="p">(</span><span class="n">instruction</span><span class="p">)</span>                 
</pre></div>
</div>
<p>That’s it.  Now let’s test it with some numpy arrays.  The default wrapper
backend is f2py.  The wrapper function it provides is set up to accept python
lists, which it will silently convert to numpy arrays.  So we can test the
matrix vector product like this:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">M</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
<span class="gp">... </span>     <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">matvec</span><span class="p">(</span><span class="n">M</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>                              
<span class="go">[ 3.  2.]</span>
</pre></div>
</div>
<div class="section" id="implementation-details">
<h2>Implementation details<a class="headerlink" href="#implementation-details" title="Permalink to this headline">¶</a></h2>
<p>The autowrap module is implemented with a backend consisting of CodeWrapper
objects.  The base class <code class="docutils literal notranslate"><span class="pre">CodeWrapper</span></code> takes care of details about module
name, filenames and options.  It also contains the driver routine, which runs
through all steps in the correct order, and also takes care of setting up and
removing the temporary working directory.</p>
<p>The actual compilation and wrapping is done by external resources, such as the
system installed f2py command. The Cython backend runs a distutils setup script
in a subprocess. Subclasses of CodeWrapper takes care of these
backend-dependent details.</p>
</div>
<div class="section" id="module-diofant.utilities.autowrap">
<span id="api-reference"></span><h2>API Reference<a class="headerlink" href="#module-diofant.utilities.autowrap" title="Permalink to this headline">¶</a></h2>
<p>Module for compiling codegen output, and wrap the binary for use in
python.</p>
<p>This module provides a common interface for different external backends, such
as f2py, fwrap, Cython, SWIG(?) etc. (Currently only f2py and Cython are
implemented) The goal is to provide access to compiled binaries of acceptable
performance with a one-button user interface, i.e.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">expr</span> <span class="o">=</span> <span class="p">((</span><span class="n">x</span> <span class="o">-</span> <span class="n">y</span><span class="p">)</span><span class="o">**</span><span class="mi">25</span><span class="p">)</span><span class="o">.</span><span class="n">expand</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">binary_callable</span> <span class="o">=</span> <span class="n">autowrap</span><span class="p">(</span><span class="n">expr</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">binary_callable</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="go">-1.0</span>
</pre></div>
</div>
<p>The callable returned from autowrap() is a binary python function, not a
Diofant object.  If it is desired to use the compiled function in symbolic
expressions, it is better to use binary_function() which returns a Diofant
Function object.  The binary callable is attached as the _imp_ attribute and
invoked when a numerical evaluation is requested with evalf(), or with
lambdify().</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">f</span> <span class="o">=</span> <span class="n">binary_function</span><span class="p">(</span><span class="s1">&#39;f&#39;</span><span class="p">,</span> <span class="n">expr</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="mi">2</span><span class="o">*</span><span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span> <span class="o">+</span> <span class="n">y</span>
<span class="go">y + 2*f(x, y)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span> <span class="o">+</span> <span class="n">y</span><span class="p">)</span><span class="o">.</span><span class="n">evalf</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">subs</span><span class="o">=</span><span class="p">{</span><span class="n">x</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="mi">2</span><span class="p">},</span> <span class="n">strict</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="go">0.e-190</span>
</pre></div>
</div>
<p>The idea is that a Diofant user will primarily be interested in working with
mathematical expressions, and should not have to learn details about wrapping
tools in order to evaluate expressions numerically, even if they are
computationally expensive.</p>
<p>When is this useful?</p>
<blockquote>
<div><ol class="arabic simple">
<li><p>For computations on large arrays, Python iterations may be too slow,
and depending on the mathematical expression, it may be difficult to
exploit the advanced index operations provided by NumPy.</p></li>
<li><p>For <em>really</em> long expressions that will be called repeatedly, the
compiled binary should be significantly faster than Diofant’s .evalf()</p></li>
<li><p>If you are generating code with the codegen utility in order to use
it in another project, the automatic python wrappers let you test the
binaries immediately from within Diofant.</p></li>
<li><p>To create customized ufuncs for use with numpy arrays.
See <em>ufuncify</em>.</p></li>
</ol>
</div></blockquote>
<p>When is this module NOT the best approach?</p>
<blockquote>
<div><ol class="arabic simple">
<li><p>If you are really concerned about speed or memory optimizations,
you will probably get better results by working directly with the
wrapper tools and the low level code.  However, the files generated
by this utility may provide a useful starting point and reference
code. Temporary files will be left intact if you supply the keyword
tempdir=”path/to/files/”.</p></li>
<li><p>If the array computation can be handled easily by numpy, and you
don’t need the binaries for another project.</p></li>
</ol>
</div></blockquote>
<dl class="py exception">
<dt id="diofant.utilities.autowrap.CodeWrapError">
<em class="property">exception </em><code class="sig-prename descclassname">diofant.utilities.autowrap.</code><code class="sig-name descname">CodeWrapError</code><a class="reference external" href="https://github.com/diofant/diofant/blob/master/diofant/utilities/autowrap.py#L81-L82"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#diofant.utilities.autowrap.CodeWrapError" title="Permalink to this definition">¶</a></dt>
<dd><p>Generic code wrapping error.</p>
</dd></dl>

<dl class="py class">
<dt id="diofant.utilities.autowrap.CodeWrapper">
<em class="property">class </em><code class="sig-prename descclassname">diofant.utilities.autowrap.</code><code class="sig-name descname">CodeWrapper</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">generator</span></em>, <em class="sig-param"><span class="n">filepath</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">flags</span><span class="o">=</span><span class="default_value">[]</span></em>, <em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/diofant/diofant/blob/master/diofant/utilities/autowrap.py#L85-L153"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#diofant.utilities.autowrap.CodeWrapper" title="Permalink to this definition">¶</a></dt>
<dd><p>Base Class for code wrappers.</p>
</dd></dl>

<dl class="py class">
<dt id="diofant.utilities.autowrap.CythonCodeWrapper">
<em class="property">class </em><code class="sig-prename descclassname">diofant.utilities.autowrap.</code><code class="sig-name descname">CythonCodeWrapper</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">*</span><span class="n">args</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/diofant/diofant/blob/master/diofant/utilities/autowrap.py#L198-L383"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#diofant.utilities.autowrap.CythonCodeWrapper" title="Permalink to this definition">¶</a></dt>
<dd><p>Wrapper that uses Cython.</p>
<dl class="py method">
<dt id="diofant.utilities.autowrap.CythonCodeWrapper.dump_pyx">
<code class="sig-name descname">dump_pyx</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">routines</span></em>, <em class="sig-param"><span class="n">f</span></em>, <em class="sig-param"><span class="n">prefix</span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/diofant/diofant/blob/master/diofant/utilities/autowrap.py#L262-L324"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#diofant.utilities.autowrap.CythonCodeWrapper.dump_pyx" title="Permalink to this definition">¶</a></dt>
<dd><p>Write a Cython file with python wrappers</p>
<p>This file contains all the definitions of the routines in c code and
refers to the header file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>routines</strong> (<em>list</em>) – List of Routine instances</p></li>
<li><p><strong>f</strong> (<em>file</em>) – File-like object to write the file to</p></li>
<li><p><strong>prefix</strong> (<em>str</em>) – The filename prefix, used to refer to the proper header file.
Only the basename of the prefix is used.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="diofant.utilities.autowrap.DummyWrapper">
<em class="property">class </em><code class="sig-prename descclassname">diofant.utilities.autowrap.</code><code class="sig-name descname">DummyWrapper</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">generator</span></em>, <em class="sig-param"><span class="n">filepath</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">flags</span><span class="o">=</span><span class="default_value">[]</span></em>, <em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/diofant/diofant/blob/master/diofant/utilities/autowrap.py#L156-L195"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#diofant.utilities.autowrap.DummyWrapper" title="Permalink to this definition">¶</a></dt>
<dd><p>Class used for testing independent of backends.</p>
</dd></dl>

<dl class="py class">
<dt id="diofant.utilities.autowrap.F2PyCodeWrapper">
<em class="property">class </em><code class="sig-prename descclassname">diofant.utilities.autowrap.</code><code class="sig-name descname">F2PyCodeWrapper</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">generator</span></em>, <em class="sig-param"><span class="n">filepath</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">flags</span><span class="o">=</span><span class="default_value">[]</span></em>, <em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/diofant/diofant/blob/master/diofant/utilities/autowrap.py#L386-L401"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#diofant.utilities.autowrap.F2PyCodeWrapper" title="Permalink to this definition">¶</a></dt>
<dd><p>Wrapper that uses f2py.</p>
</dd></dl>

<dl class="py class">
<dt id="diofant.utilities.autowrap.UfuncifyCodeWrapper">
<em class="property">class </em><code class="sig-prename descclassname">diofant.utilities.autowrap.</code><code class="sig-name descname">UfuncifyCodeWrapper</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">generator</span></em>, <em class="sig-param"><span class="n">filepath</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">flags</span><span class="o">=</span><span class="default_value">[]</span></em>, <em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/diofant/diofant/blob/master/diofant/utilities/autowrap.py#L642-L772"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#diofant.utilities.autowrap.UfuncifyCodeWrapper" title="Permalink to this definition">¶</a></dt>
<dd><p>Wrapper for Ufuncify.</p>
<dl class="py method">
<dt id="diofant.utilities.autowrap.UfuncifyCodeWrapper.dump_c">
<code class="sig-name descname">dump_c</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">routines</span></em>, <em class="sig-param"><span class="n">f</span></em>, <em class="sig-param"><span class="n">prefix</span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/diofant/diofant/blob/master/diofant/utilities/autowrap.py#L670-L756"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#diofant.utilities.autowrap.UfuncifyCodeWrapper.dump_c" title="Permalink to this definition">¶</a></dt>
<dd><p>Write a C file with python wrappers</p>
<p>This file contains all the definitions of the routines in c code.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>routines</strong> (<em>list</em>) – List of Routine instances</p></li>
<li><p><strong>f</strong> (<em>file</em>) – File-like object to write the file to</p></li>
<li><p><strong>prefix</strong> (<em>str</em>) – The filename prefix, used to name the imported module.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt id="diofant.utilities.autowrap.autowrap">
<code class="sig-prename descclassname">diofant.utilities.autowrap.</code><code class="sig-name descname">autowrap</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">expr</span></em>, <em class="sig-param"><span class="n">language</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">backend</span><span class="o">=</span><span class="default_value">'f2py'</span></em>, <em class="sig-param"><span class="n">tempdir</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">args</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">flags</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">helpers</span><span class="o">=</span><span class="default_value">[]</span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/diofant/diofant/blob/master/diofant/utilities/autowrap.py#L437-L517"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#diofant.utilities.autowrap.autowrap" title="Permalink to this definition">¶</a></dt>
<dd><p>Generates python callable binaries based on the math expression.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>expr</strong> – The Diofant expression that should be wrapped as a binary routine.</p></li>
<li><p><strong>language</strong> (<em>string, optional</em>) – If supplied, (options: ‘C’ or ‘F95’), specifies the language of the
generated code. If <code class="docutils literal notranslate"><span class="pre">None</span></code> [default], the language is inferred based
upon the specified backend.</p></li>
<li><p><strong>backend</strong> (<em>string, optional</em>) – Backend used to wrap the generated code. Either ‘f2py’ [default],
or ‘cython’.</p></li>
<li><p><strong>tempdir</strong> (<em>string, optional</em>) – Path to directory for temporary files. If this argument is supplied,
the generated code and the wrapper input files are left intact in the
specified path.</p></li>
<li><p><strong>args</strong> (<em>iterable, optional</em>) – An ordered iterable of symbols. Specifies the argument sequence for the
function.</p></li>
<li><p><strong>flags</strong> (<em>iterable, optional</em>) – Additional option flags that will be passed to the backend.</p></li>
<li><p><strong>verbose</strong> (<em>bool, optional</em>) – If True, autowrap will not mute the command line backends. This can be
helpful for debugging.</p></li>
<li><p><strong>helpers</strong> (<em>iterable, optional</em>) – Used to define auxillary expressions needed for the main expr. If the
main expression needs to call a specialized function it should be put
in the <code class="docutils literal notranslate"><span class="pre">helpers</span></code> iterable. Autowrap will then make sure that the
compiled main expression can link to the helper routine. Items should
be tuples with (&lt;function_name&gt;, &lt;diofant_expression&gt;, &lt;arguments&gt;). It
is mandatory to supply an argument sequence to helper routines.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">expr</span> <span class="o">=</span> <span class="p">((</span><span class="n">x</span> <span class="o">-</span> <span class="n">y</span> <span class="o">+</span> <span class="n">z</span><span class="p">)</span><span class="o">**</span><span class="mi">13</span><span class="p">)</span><span class="o">.</span><span class="n">expand</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">binary_func</span> <span class="o">=</span> <span class="n">autowrap</span><span class="p">(</span><span class="n">expr</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">binary_func</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="go">-1.0</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt id="diofant.utilities.autowrap.binary_function">
<code class="sig-prename descclassname">diofant.utilities.autowrap.</code><code class="sig-name descname">binary_function</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">symfunc</span></em>, <em class="sig-param"><span class="n">expr</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/diofant/diofant/blob/master/diofant/utilities/autowrap.py#L520-L539"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#diofant.utilities.autowrap.binary_function" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a diofant function with expr as binary implementation</p>
<p>This is a convenience function that automates the steps needed to
autowrap the Diofant expression and attaching it to a Function object
with implemented_function().</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">expr</span> <span class="o">=</span> <span class="p">((</span><span class="n">x</span> <span class="o">-</span> <span class="n">y</span><span class="p">)</span><span class="o">**</span><span class="mi">25</span><span class="p">)</span><span class="o">.</span><span class="n">expand</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span> <span class="o">=</span> <span class="n">binary_function</span><span class="p">(</span><span class="s1">&#39;f&#39;</span><span class="p">,</span> <span class="n">expr</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">type</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
<span class="go">&lt;class &#39;diofant.core.function.UndefinedFunction&#39;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="mi">2</span><span class="o">*</span><span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="go">2*f(x, y)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span><span class="o">.</span><span class="n">evalf</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">subs</span><span class="o">=</span><span class="p">{</span><span class="n">x</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="mi">2</span><span class="p">})</span>
<span class="go">-1.0</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt id="diofant.utilities.autowrap.ufuncify">
<code class="sig-prename descclassname">diofant.utilities.autowrap.</code><code class="sig-name descname">ufuncify</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">args</span></em>, <em class="sig-param"><span class="n">expr</span></em>, <em class="sig-param"><span class="n">language</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">backend</span><span class="o">=</span><span class="default_value">'numpy'</span></em>, <em class="sig-param"><span class="n">tempdir</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">flags</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">helpers</span><span class="o">=</span><span class="default_value">[]</span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/diofant/diofant/blob/master/diofant/utilities/autowrap.py#L775-L888"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#diofant.utilities.autowrap.ufuncify" title="Permalink to this definition">¶</a></dt>
<dd><p>Generates a binary function that supports broadcasting on numpy arrays.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>args</strong> (<em>iterable</em>) – Either a Symbol or an iterable of symbols. Specifies the argument
sequence for the function.</p></li>
<li><p><strong>expr</strong> – A Diofant expression that defines the element wise operation.</p></li>
<li><p><strong>language</strong> (<em>string, optional</em>) – If supplied, (options: ‘C’ or ‘F95’), specifies the language of the
generated code. If <code class="docutils literal notranslate"><span class="pre">None</span></code> [default], the language is inferred based
upon the specified backend.</p></li>
<li><p><strong>backend</strong> (<em>string, optional</em>) – Backend used to wrap the generated code. Either ‘numpy’ [default],
‘cython’, or ‘f2py’.</p></li>
<li><p><strong>tempdir</strong> (<em>string, optional</em>) – Path to directory for temporary files. If this argument is supplied,
the generated code and the wrapper input files are left intact in the
specified path.</p></li>
<li><p><strong>flags</strong> (<em>iterable, optional</em>) – Additional option flags that will be passed to the backend</p></li>
<li><p><strong>verbose</strong> (<em>bool, optional</em>) – If True, autowrap will not mute the command line backends. This can be
helpful for debugging.</p></li>
<li><p><strong>helpers</strong> (<em>iterable, optional</em>) – Used to define auxillary expressions needed for the main expr. If the
main expression needs to call a specialized function it should be put
in the <code class="docutils literal notranslate"><span class="pre">helpers</span></code> iterable. Autowrap will then make sure that the
compiled main expression can link to the helper routine. Items should
be tuples with (&lt;function_name&gt;, &lt;diofant_expression&gt;, &lt;arguments&gt;). It
is mandatory to supply an argument sequence to helper routines.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>The default backend (‘numpy’) will create actual instances of
<code class="docutils literal notranslate"><span class="pre">numpy.ufunc</span></code>. These support ndimensional broadcasting, and implicit type
conversion. Use of the other backends will result in a “ufunc-like”
function, which requires equal length 1-dimensional arrays for all
arguments, and will not perform any type conversions.</p>
<p class="rubric">References</p>
<ul class="simple">
<li><p><a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/ufuncs.html">https://docs.scipy.org/doc/numpy/reference/ufuncs.html</a></p></li>
</ul>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span> <span class="o">=</span> <span class="n">ufuncify</span><span class="p">((</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">),</span> <span class="n">y</span> <span class="o">+</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">type</span><span class="p">(</span><span class="n">f</span><span class="p">)</span> <span class="ow">is</span> <span class="n">np</span><span class="o">.</span><span class="n">ufunc</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="mi">2</span><span class="p">)</span>
<span class="go">[  3.   6.  11.]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span> <span class="mi">3</span><span class="p">)</span>
<span class="go">[  3.   4.   7.  12.  19.]</span>
</pre></div>
</div>
<p>For the F2Py and Cython backends, inputs are required to be equal length
1-dimensional arrays. The F2Py backend will perform type conversion, but
the Cython backend will error if the inputs are not of the expected type.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">f_fortran</span> <span class="o">=</span> <span class="n">ufuncify</span><span class="p">((</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">),</span> <span class="n">y</span> <span class="o">+</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span> <span class="n">backend</span><span class="o">=</span><span class="s1">&#39;F2Py&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f_fortran</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="go">[ 3.]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f_fortran</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">]))</span>
<span class="go">[  2.   6.  12.]</span>
</pre></div>
</div>
</dd></dl>

</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="codegen.html" class="btn btn-neutral float-right" title="Codegen" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="index.html" class="btn btn-neutral float-left" title="Utilities" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2006-2018 SymPy Development Team, 2013-2020 Sergey B Kirpichev

    </p>
  </div> 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
    <!-- Theme Analytics -->
    <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-147167689-1', 'auto');
    ga('send', 'pageview');
    </script>

    
   

</body>
</html>
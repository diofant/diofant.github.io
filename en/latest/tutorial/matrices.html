<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Matrices &mdash; Diofant 0.13.1.dev38+gb64e3cd85 documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../_static/graphviz.css" type="text/css" />
      <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
        <script>window.MathJax = {"CommonHTML": {"linebreaks": {"automatic": true}}, "HTML-CSS": {"linebreaks": {"automatic": true}}, "SVG": {"linebreaks": {"automatic": true}}}</script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Expression Trees" href="manipulation.html" />
    <link rel="prev" title="Polynomials" href="polys.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../index.html">
            <img src="../_static/logo.svg" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../install.html">Installation</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Tutorial</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="intro.html">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="basics.html">Basics</a></li>
<li class="toctree-l2"><a class="reference internal" href="gotchas.html">Gotchas</a></li>
<li class="toctree-l2"><a class="reference internal" href="printing.html">Printing</a></li>
<li class="toctree-l2"><a class="reference internal" href="simplification.html">Simplification</a></li>
<li class="toctree-l2"><a class="reference internal" href="calculus.html">Calculus</a></li>
<li class="toctree-l2"><a class="reference internal" href="solvers.html">Solvers</a></li>
<li class="toctree-l2"><a class="reference internal" href="polys.html">Polynomials</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Matrices</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#indexing">Indexing</a></li>
<li class="toctree-l3"><a class="reference internal" href="#reshape-and-rearrange">Reshape and Rearrange</a></li>
<li class="toctree-l3"><a class="reference internal" href="#algebraic-operations">Algebraic Operations</a></li>
<li class="toctree-l3"><a class="reference internal" href="#special-matrices">Special Matrices</a></li>
<li class="toctree-l3"><a class="reference internal" href="#advanced-methods">Advanced Methods</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="manipulation.html">Expression Trees</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../cli.html">Command-Line Usage</a></li>
<li class="toctree-l1"><a class="reference internal" href="../modules/index.html">Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../internals/index.html">Internals</a></li>
<li class="toctree-l1"><a class="reference internal" href="../guide.html">Development</a></li>
<li class="toctree-l1"><a class="reference internal" href="../aboutus.html">About</a></li>
<li class="toctree-l1"><a class="reference internal" href="../release/index.html">Release Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../sources.html">Bibliography</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Diofant</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="index.html">Tutorial</a> &raquo;</li>
      <li>Matrices</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/tutorial/matrices.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="matrices">
<h1>Matrices<a class="headerlink" href="#matrices" title="Permalink to this headline"></a></h1>
<p>To make a matrix in Diofant, use the
<a class="reference internal" href="../modules/matrices/index.html#diofant.matrices.Matrix" title="diofant.matrices.Matrix"><code class="xref py py-class docutils literal notranslate"><span class="pre">Matrix</span></code></a> object.  A matrix is
constructed by providing a list of row vectors that make up the
matrix.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Matrix</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">]])</span>
<span class="go">⎡1  -1⎤</span>
<span class="go">⎢     ⎥</span>
<span class="go">⎢3  4 ⎥</span>
<span class="go">⎢     ⎥</span>
<span class="go">⎣0  2 ⎦</span>
</pre></div>
</div>
<p>A list of elements is considered to be a column vector.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Matrix</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
<span class="go">⎡1⎤</span>
<span class="go">⎢ ⎥</span>
<span class="go">⎢2⎥</span>
<span class="go">⎢ ⎥</span>
<span class="go">⎣3⎦</span>
</pre></div>
</div>
<p>One important thing to note about Diofant matrices is that, unlike
every other object in Diofant, they are mutable.  This means that they
can be modified in place, as we will see below.  Use
<a class="reference internal" href="../modules/matrices/immutablematrices.html#diofant.matrices.immutable.ImmutableMatrix" title="diofant.matrices.immutable.ImmutableMatrix"><code class="xref py py-class docutils literal notranslate"><span class="pre">ImmutableMatrix</span></code></a> in places that
require immutability, such as inside other Diofant expressions or as
keys to dictionaries.</p>
<section id="indexing">
<h2>Indexing<a class="headerlink" href="#indexing" title="Permalink to this headline"></a></h2>
<p>Diofant matrices support subscription of matrix elements with pair of
integers or <a class="reference external" href="https://docs.python.org/3/library/functions.html#slice" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">slice</span></code></a> instances.  In last case, new
<a class="reference internal" href="../modules/matrices/index.html#diofant.matrices.Matrix" title="diofant.matrices.Matrix"><code class="xref py py-class docutils literal notranslate"><span class="pre">Matrix</span></code></a> instances will be returned.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">M</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">M</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
<span class="go">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">M</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
<span class="go">5</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">M</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span>
<span class="go">⎡2⎤</span>
<span class="go">⎢ ⎥</span>
<span class="go">⎣5⎦</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">M</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="go">[4  5]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">M</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:]</span>
<span class="go">[1  2  3]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">M</span><span class="p">[:,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="go">⎡3⎤</span>
<span class="go">⎢ ⎥</span>
<span class="go">⎣6⎦</span>
</pre></div>
</div>
<p>It’s possible to modify matrix elements.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">M</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">M</span>
<span class="go">⎡0  2  3⎤</span>
<span class="go">⎢       ⎥</span>
<span class="go">⎣4  5  6⎦</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">M</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">:]</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">M</span>
<span class="go">⎡0  2  3⎤</span>
<span class="go">⎢       ⎥</span>
<span class="go">⎣4  0  0⎦</span>
</pre></div>
</div>
</section>
<section id="reshape-and-rearrange">
<h2>Reshape and Rearrange<a class="headerlink" href="#reshape-and-rearrange" title="Permalink to this headline"></a></h2>
<p>To get the shape of a matrix use
<a class="reference internal" href="../modules/matrices/matrices.html#diofant.matrices.matrices.MatrixBase.shape" title="diofant.matrices.matrices.MatrixBase.shape"><code class="xref py py-attr docutils literal notranslate"><span class="pre">shape</span></code></a> property</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">M</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">M</span>
<span class="go">⎡1   2  3⎤</span>
<span class="go">⎢        ⎥</span>
<span class="go">⎣-2  0  4⎦</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">M</span><span class="o">.</span><span class="n">shape</span>
<span class="go">(2, 3)</span>
</pre></div>
</div>
<p>To delete a row or column, use <a class="reference external" href="https://docs.python.org/3/reference/simple_stmts.html#del" title="(in Python v3.10)"><code class="xref std std-keyword docutils literal notranslate"><span class="pre">del</span></code></a></p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">del</span> <span class="n">M</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">M</span>
<span class="go">⎡2  3⎤</span>
<span class="go">⎢    ⎥</span>
<span class="go">⎣0  4⎦</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">del</span> <span class="n">M</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="p">:]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">M</span>
<span class="go">[2  3]</span>
</pre></div>
</div>
<p>To insert rows or columns, use methods
<a class="reference internal" href="../modules/matrices/matrices.html#diofant.matrices.matrices.MatrixBase.row_insert" title="diofant.matrices.matrices.MatrixBase.row_insert"><code class="xref py py-meth docutils literal notranslate"><span class="pre">row_insert()</span></code></a> or
<a class="reference internal" href="../modules/matrices/matrices.html#diofant.matrices.matrices.MatrixBase.col_insert" title="diofant.matrices.matrices.MatrixBase.col_insert"><code class="xref py py-meth docutils literal notranslate"><span class="pre">col_insert()</span></code></a>.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">M</span>
<span class="go">[2  3]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">M</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">row_insert</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">Matrix</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">]]))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">M</span>
<span class="go">⎡2  3⎤</span>
<span class="go">⎢    ⎥</span>
<span class="go">⎣0  4⎦</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">M</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">col_insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">Matrix</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">]))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">M</span>
<span class="go">⎡1   2  3⎤</span>
<span class="go">⎢        ⎥</span>
<span class="go">⎣-2  0  4⎦</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>You can see, that these methods will modify the Matrix <strong>in
place</strong>.  In general, as a rule, such methods will return <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p>
</div>
<p>To swap two given rows or columns, use methods
<a class="reference internal" href="../modules/matrices/dense.html#diofant.matrices.dense.MutableDenseMatrix.row_swap" title="diofant.matrices.dense.MutableDenseMatrix.row_swap"><code class="xref py py-meth docutils literal notranslate"><span class="pre">row_swap()</span></code></a> or
<a class="reference internal" href="../modules/matrices/dense.html#diofant.matrices.dense.MutableDenseMatrix.col_swap" title="diofant.matrices.dense.MutableDenseMatrix.col_swap"><code class="xref py py-meth docutils literal notranslate"><span class="pre">col_swap()</span></code></a>.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">M</span><span class="o">.</span><span class="n">row_swap</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">M</span>
<span class="go">⎡-2  0  4⎤</span>
<span class="go">⎢        ⎥</span>
<span class="go">⎣1   2  3⎦</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">M</span><span class="o">.</span><span class="n">col_swap</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">M</span>
<span class="go">⎡-2  4  0⎤</span>
<span class="go">⎢        ⎥</span>
<span class="go">⎣1   3  2⎦</span>
</pre></div>
</div>
<p>To take the transpose of a Matrix, use
<a class="reference internal" href="../modules/matrices/matrices.html#diofant.matrices.matrices.MatrixBase.T" title="diofant.matrices.matrices.MatrixBase.T"><code class="xref py py-attr docutils literal notranslate"><span class="pre">T</span></code></a> property.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">M</span><span class="o">.</span><span class="n">T</span>
<span class="go">⎡-2  1⎤</span>
<span class="go">⎢     ⎥</span>
<span class="go">⎢4   3⎥</span>
<span class="go">⎢     ⎥</span>
<span class="go">⎣0   2⎦</span>
</pre></div>
</div>
</section>
<section id="algebraic-operations">
<h2>Algebraic Operations<a class="headerlink" href="#algebraic-operations" title="Permalink to this headline"></a></h2>
<p>Simple operations like addition and multiplication are done just by
using <code class="docutils literal notranslate"><span class="pre">+</span></code>, <code class="docutils literal notranslate"><span class="pre">*</span></code>, and <code class="docutils literal notranslate"><span class="pre">**</span></code>.  To find the inverse of a matrix, just
raise it to the <code class="docutils literal notranslate"><span class="pre">-1</span></code> power.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">M</span><span class="p">,</span> <span class="n">N</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]]),</span> <span class="n">Matrix</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">7</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">M</span> <span class="o">+</span> <span class="n">N</span>
<span class="go">⎡1   6 ⎤</span>
<span class="go">⎢      ⎥</span>
<span class="go">⎣-2  10⎦</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">M</span><span class="o">*</span><span class="n">N</span>
<span class="go">⎡0  24⎤</span>
<span class="go">⎢     ⎥</span>
<span class="go">⎣0  15⎦</span>
<span class="gp">&gt;&gt;&gt; </span><span class="mi">3</span><span class="o">*</span><span class="n">M</span>
<span class="go">⎡3   9⎤</span>
<span class="go">⎢     ⎥</span>
<span class="go">⎣-6  9⎦</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">M</span><span class="o">**</span><span class="mi">2</span>
<span class="go">⎡-5  12⎤</span>
<span class="go">⎢      ⎥</span>
<span class="go">⎣-8  3 ⎦</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">M</span><span class="o">**-</span><span class="mi">1</span>
<span class="go">⎡1/3  -1/3⎤</span>
<span class="go">⎢         ⎥</span>
<span class="go">⎣2/9  1/9 ⎦</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">N</span><span class="o">**-</span><span class="mi">1</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">Matrix det == 0; not invertible.</span>
</pre></div>
</div>
</section>
<section id="special-matrices">
<h2>Special Matrices<a class="headerlink" href="#special-matrices" title="Permalink to this headline"></a></h2>
<p>Several constructors exist for creating common matrices.  To create an
identity matrix, use <a class="reference internal" href="../modules/matrices/matrices.html#diofant.matrices.dense.eye" title="diofant.matrices.dense.eye"><code class="xref py py-func docutils literal notranslate"><span class="pre">eye()</span></code></a> function.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">eye</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="go">⎡1  0  0⎤</span>
<span class="go">⎢       ⎥</span>
<span class="go">⎢0  1  0⎥</span>
<span class="go">⎢       ⎥</span>
<span class="go">⎣0  0  1⎦</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">eye</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="go">⎡1  0  0  0⎤</span>
<span class="go">⎢          ⎥</span>
<span class="go">⎢0  1  0  0⎥</span>
<span class="go">⎢          ⎥</span>
<span class="go">⎢0  0  1  0⎥</span>
<span class="go">⎢          ⎥</span>
<span class="go">⎣0  0  0  1⎦</span>
</pre></div>
</div>
<p>To create a matrix of all zeros, use
<a class="reference internal" href="../modules/matrices/matrices.html#diofant.matrices.dense.zeros" title="diofant.matrices.dense.zeros"><code class="xref py py-func docutils literal notranslate"><span class="pre">zeros()</span></code></a> function.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">zeros</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="go">⎡0  0  0⎤</span>
<span class="go">⎢       ⎥</span>
<span class="go">⎣0  0  0⎦</span>
</pre></div>
</div>
<p>Similarly, function <a class="reference internal" href="../modules/matrices/matrices.html#diofant.matrices.dense.ones" title="diofant.matrices.dense.ones"><code class="xref py py-func docutils literal notranslate"><span class="pre">ones()</span></code></a> creates a
matrix of ones.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ones</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="go">⎡1  1⎤</span>
<span class="go">⎢    ⎥</span>
<span class="go">⎢1  1⎥</span>
<span class="go">⎢    ⎥</span>
<span class="go">⎣1  1⎦</span>
</pre></div>
</div>
<p>To create diagonal matrices, use function
<a class="reference internal" href="../modules/matrices/matrices.html#diofant.matrices.dense.diag" title="diofant.matrices.dense.diag"><code class="xref py py-func docutils literal notranslate"><span class="pre">diag()</span></code></a>.  Its arguments can be either
numbers or matrices.  A number is interpreted as a <span class="math notranslate nohighlight">\(1\times 1\)</span>
matrix. The matrices are stacked diagonally.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">diag</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="go">⎡1  0  0⎤</span>
<span class="go">⎢       ⎥</span>
<span class="go">⎢0  2  0⎥</span>
<span class="go">⎢       ⎥</span>
<span class="go">⎣0  0  3⎦</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">diag</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">ones</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">Matrix</span><span class="p">([</span><span class="mi">5</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">5</span><span class="p">]))</span>
<span class="go">⎡-1  0  0  0⎤</span>
<span class="go">⎢           ⎥</span>
<span class="go">⎢0   1  1  0⎥</span>
<span class="go">⎢           ⎥</span>
<span class="go">⎢0   1  1  0⎥</span>
<span class="go">⎢           ⎥</span>
<span class="go">⎢0   0  0  5⎥</span>
<span class="go">⎢           ⎥</span>
<span class="go">⎢0   0  0  7⎥</span>
<span class="go">⎢           ⎥</span>
<span class="go">⎣0   0  0  5⎦</span>
</pre></div>
</div>
</section>
<section id="advanced-methods">
<h2>Advanced Methods<a class="headerlink" href="#advanced-methods" title="Permalink to this headline"></a></h2>
<p>To compute the determinant of a matrix, use
<a class="reference internal" href="../modules/matrices/matrices.html#diofant.matrices.matrices.MatrixBase.det" title="diofant.matrices.matrices.MatrixBase.det"><code class="xref py py-meth docutils literal notranslate"><span class="pre">det()</span></code></a> method.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Matrix</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">]])</span>
<span class="go">⎡1  0   1⎤</span>
<span class="go">⎢        ⎥</span>
<span class="go">⎢2  -1  3⎥</span>
<span class="go">⎢        ⎥</span>
<span class="go">⎣4  3   2⎦</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">det</span><span class="p">(</span><span class="n">_</span><span class="p">)</span>
<span class="go">-1</span>
</pre></div>
</div>
<p>To put a matrix into reduced row echelon form, use method
<a class="reference internal" href="../modules/matrices/matrices.html#diofant.matrices.matrices.MatrixBase.rref" title="diofant.matrices.matrices.MatrixBase.rref"><code class="xref py py-meth docutils literal notranslate"><span class="pre">rref()</span></code></a>.  It returns a
tuple of two elements.  The first is the reduced row echelon form, and
the second is a list of indices of the pivot columns.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Matrix</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">7</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">4</span><span class="p">]])</span>
<span class="go">⎡1   0   1   3 ⎤</span>
<span class="go">⎢              ⎥</span>
<span class="go">⎢2   3   4   7 ⎥</span>
<span class="go">⎢              ⎥</span>
<span class="go">⎣-1  -3  -3  -4⎦</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">_</span><span class="o">.</span><span class="n">rref</span><span class="p">()</span>
<span class="go">⎛⎡1  0   1    3 ⎤        ⎞</span>
<span class="go">⎜⎢              ⎥        ⎟</span>
<span class="go">⎜⎢0  1  2/3  1/3⎥, [0, 1]⎟</span>
<span class="go">⎜⎢              ⎥        ⎟</span>
<span class="go">⎝⎣0  0   0    0 ⎦        ⎠</span>
</pre></div>
</div>
<p>To find the nullspace of a matrix, use method
<a class="reference internal" href="../modules/matrices/matrices.html#diofant.matrices.matrices.MatrixBase.nullspace" title="diofant.matrices.matrices.MatrixBase.nullspace"><code class="xref py py-meth docutils literal notranslate"><span class="pre">nullspace()</span></code></a>.  It returns a
list of column vectors that span the nullspace of the matrix.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Matrix</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]])</span>
<span class="go">⎡1  2   3  0  0⎤</span>
<span class="go">⎢              ⎥</span>
<span class="go">⎣4  10  0  0  1⎦</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">_</span><span class="o">.</span><span class="n">nullspace</span><span class="p">()</span>
<span class="go">⎡⎡-15⎤  ⎡0⎤  ⎡ 1  ⎤⎤</span>
<span class="go">⎢⎢   ⎥  ⎢ ⎥  ⎢    ⎥⎥</span>
<span class="go">⎢⎢ 6 ⎥  ⎢0⎥  ⎢-1/2⎥⎥</span>
<span class="go">⎢⎢   ⎥  ⎢ ⎥  ⎢    ⎥⎥</span>
<span class="go">⎢⎢ 1 ⎥, ⎢0⎥, ⎢ 0  ⎥⎥</span>
<span class="go">⎢⎢   ⎥  ⎢ ⎥  ⎢    ⎥⎥</span>
<span class="go">⎢⎢ 0 ⎥  ⎢1⎥  ⎢ 0  ⎥⎥</span>
<span class="go">⎢⎢   ⎥  ⎢ ⎥  ⎢    ⎥⎥</span>
<span class="go">⎣⎣ 0 ⎦  ⎣0⎦  ⎣ 1  ⎦⎦</span>
</pre></div>
</div>
<p>To find the eigenvalues of a matrix, use method
<a class="reference internal" href="../modules/matrices/matrices.html#diofant.matrices.matrices.MatrixBase.eigenvals" title="diofant.matrices.matrices.MatrixBase.eigenvals"><code class="xref py py-meth docutils literal notranslate"><span class="pre">eigenvals()</span></code></a>.  It returns a
dictionary of roots including its multiplicity (similar to the output
of <a class="reference internal" href="../modules/polys.html#diofant.polys.polyroots.roots" title="diofant.polys.polyroots.roots"><code class="xref py py-func docutils literal notranslate"><span class="pre">roots()</span></code></a> function).</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">M</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">([[</span><span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="o">+</span><span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">],</span>
<span class="gp">... </span>            <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="o">+</span><span class="mi">3</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">M</span>
<span class="go">⎡3  -2  4   -2⎤</span>
<span class="go">⎢             ⎥</span>
<span class="go">⎢5  3   -3  -2⎥</span>
<span class="go">⎢             ⎥</span>
<span class="go">⎢5  -2  2   -2⎥</span>
<span class="go">⎢             ⎥</span>
<span class="go">⎣5  -2  -3  3 ⎦</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">M</span><span class="o">.</span><span class="n">eigenvals</span><span class="p">()</span>
<span class="go">{-2: 1, 3: 1, 5: 2}</span>
</pre></div>
</div>
<p>This means that <code class="docutils literal notranslate"><span class="pre">M</span></code> has eigenvalues -2, 3, and 5, and that the
eigenvalues -2 and 3 have algebraic multiplicity 1 and that the
eigenvalue 5 has algebraic multiplicity 2.</p>
<p>Matrices can have symbolic elements.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Matrix</span><span class="p">([[</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span> <span class="o">+</span> <span class="n">y</span><span class="p">],</span> <span class="p">[</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">]])</span>
<span class="go">⎡x  x + y⎤</span>
<span class="go">⎢        ⎥</span>
<span class="go">⎣y    x  ⎦</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">_</span><span class="o">.</span><span class="n">eigenvals</span><span class="p">()</span>
<span class="go">⎧      ___________           ___________   ⎫</span>
<span class="go">⎨x - ╲╱ y⋅(x + y) : 1, x + ╲╱ y⋅(x + y) : 1⎬</span>
<span class="go">⎩                                          ⎭</span>
</pre></div>
</div>
<p>To find the eigenvectors of a matrix, use method
<a class="reference internal" href="../modules/matrices/matrices.html#diofant.matrices.matrices.MatrixBase.eigenvects" title="diofant.matrices.matrices.MatrixBase.eigenvects"><code class="xref py py-meth docutils literal notranslate"><span class="pre">eigenvects()</span></code></a>.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">M</span><span class="o">.</span><span class="n">eigenvects</span><span class="p">()</span>
<span class="go">⎡⎛       ⎡⎡0⎤⎤⎞  ⎛      ⎡⎡1⎤⎤⎞  ⎛      ⎡⎡1⎤  ⎡0 ⎤⎤⎞⎤</span>
<span class="go">⎢⎜       ⎢⎢ ⎥⎥⎟  ⎜      ⎢⎢ ⎥⎥⎟  ⎜      ⎢⎢ ⎥  ⎢  ⎥⎥⎟⎥</span>
<span class="go">⎢⎜       ⎢⎢1⎥⎥⎟  ⎜      ⎢⎢1⎥⎥⎟  ⎜      ⎢⎢1⎥  ⎢-1⎥⎥⎟⎥</span>
<span class="go">⎢⎜-2, 1, ⎢⎢ ⎥⎥⎟, ⎜3, 1, ⎢⎢ ⎥⎥⎟, ⎜5, 2, ⎢⎢ ⎥, ⎢  ⎥⎥⎟⎥</span>
<span class="go">⎢⎜       ⎢⎢1⎥⎥⎟  ⎜      ⎢⎢1⎥⎥⎟  ⎜      ⎢⎢1⎥  ⎢0 ⎥⎥⎟⎥</span>
<span class="go">⎢⎜       ⎢⎢ ⎥⎥⎟  ⎜      ⎢⎢ ⎥⎥⎟  ⎜      ⎢⎢ ⎥  ⎢  ⎥⎥⎟⎥</span>
<span class="go">⎣⎝       ⎣⎣1⎦⎦⎠  ⎝      ⎣⎣1⎦⎦⎠  ⎝      ⎣⎣0⎦  ⎣1 ⎦⎦⎠⎦</span>
</pre></div>
</div>
<p>This shows us that, for example, the eigenvalue 5 also has geometric
multiplicity 2, because it has two eigenvectors.  Because the
algebraic and geometric multiplicities are the same for all the
eigenvalues, <code class="docutils literal notranslate"><span class="pre">M</span></code> is diagonalizable.</p>
<p>To diagonalize a matrix, use method
<a class="reference internal" href="../modules/matrices/matrices.html#diofant.matrices.matrices.MatrixBase.diagonalize" title="diofant.matrices.matrices.MatrixBase.diagonalize"><code class="xref py py-meth docutils literal notranslate"><span class="pre">diagonalize()</span></code></a>.  It returns
a tuple <span class="math notranslate nohighlight">\((P, D)\)</span>, where <span class="math notranslate nohighlight">\(D\)</span> is diagonal and <span class="math notranslate nohighlight">\(M = PDP^{-1}\)</span>.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">M</span><span class="o">.</span><span class="n">diagonalize</span><span class="p">()</span>
<span class="go">⎛⎡0  1  1  0 ⎤  ⎡-2  0  0  0⎤⎞</span>
<span class="go">⎜⎢           ⎥  ⎢           ⎥⎟</span>
<span class="go">⎜⎢1  1  1  -1⎥  ⎢0   3  0  0⎥⎟</span>
<span class="go">⎜⎢           ⎥, ⎢           ⎥⎟</span>
<span class="go">⎜⎢1  1  1  0 ⎥  ⎢0   0  5  0⎥⎟</span>
<span class="go">⎜⎢           ⎥  ⎢           ⎥⎟</span>
<span class="go">⎝⎣1  1  0  1 ⎦  ⎣0   0  0  5⎦⎠</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">**-</span><span class="mi">1</span> <span class="o">==</span> <span class="n">M</span>
<span class="go">True</span>
</pre></div>
</div>
<p>If all you want is the characteristic polynomial, use method
<a class="reference internal" href="../modules/matrices/matrices.html#diofant.matrices.matrices.MatrixBase.charpoly" title="diofant.matrices.matrices.MatrixBase.charpoly"><code class="xref py py-meth docutils literal notranslate"><span class="pre">charpoly()</span></code></a>.  This is more
efficient than <a class="reference internal" href="../modules/matrices/matrices.html#diofant.matrices.matrices.MatrixBase.eigenvals" title="diofant.matrices.matrices.MatrixBase.eigenvals"><code class="xref py py-meth docutils literal notranslate"><span class="pre">eigenvals()</span></code></a>
method, because sometimes symbolic roots can be expensive to
calculate.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">M</span><span class="o">.</span><span class="n">charpoly</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="go">PurePoly(x**4 - 11*x**3 + 29*x**2 + 35*x - 150, x, domain=&#39;ZZ&#39;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">factor</span><span class="p">(</span><span class="n">_</span><span class="p">)</span>
<span class="go">       2</span>
<span class="go">(x - 5) ⋅(x - 3)⋅(x + 2)</span>
</pre></div>
</div>
<p>To compute Jordan canonical form <span class="math notranslate nohighlight">\(J\)</span> for matrix <span class="math notranslate nohighlight">\(M\)</span> and its similarity
transformation <span class="math notranslate nohighlight">\(P\)</span> (i.e. such that <span class="math notranslate nohighlight">\(J = P M P^{-1}\)</span>), use method
<a class="reference internal" href="../modules/matrices/matrices.html#diofant.matrices.matrices.MatrixBase.jordan_form" title="diofant.matrices.matrices.MatrixBase.jordan_form"><code class="xref py py-meth docutils literal notranslate"><span class="pre">jordan_form()</span></code></a>.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Matrix</span><span class="p">([[</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">]])</span><span class="o">.</span><span class="n">jordan_form</span><span class="p">()</span>
<span class="go">⎛⎡      ____              ⎤  ⎡    -4            -4      ⎤⎞</span>
<span class="go">⎜⎢1   ╲╱ 41               ⎥  ⎢────────────  ────────────⎥⎟</span>
<span class="go">⎜⎢─ + ──────       0      ⎥  ⎢    ____              ____⎥⎟</span>
<span class="go">⎜⎢2     2                 ⎥  ⎢  ╲╱ 41    5    5   ╲╱ 41 ⎥⎟</span>
<span class="go">⎜⎢                        ⎥, ⎢- ────── - ─  - ─ + ──────⎥⎟</span>
<span class="go">⎜⎢                ____    ⎥  ⎢    2      2    2     2   ⎥⎟</span>
<span class="go">⎜⎢              ╲╱ 41    1⎥  ⎢                          ⎥⎟</span>
<span class="go">⎜⎢    0       - ────── + ─⎥  ⎣     1             1      ⎦⎟</span>
<span class="go">⎝⎣                2      2⎦                              ⎠</span>
</pre></div>
</div>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="polys.html" class="btn btn-neutral float-left" title="Polynomials" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="manipulation.html" class="btn btn-neutral float-right" title="Expression Trees" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2006-2018 SymPy Development Team, 2013-2021 Sergey B Kirpichev.</p>
  </div>

   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>
    <!-- Theme Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-147167689-1"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'UA-147167689-1', {
          'anonymize_ip': false,
      });
    </script> 

</body>
</html>
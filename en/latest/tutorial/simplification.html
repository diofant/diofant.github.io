

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Simplification &mdash; Diofant 0.11.0a7.dev36+gc9d6bb5 documentation</title>
  

  
  
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
  
  
  

  
  <script type="text/javascript" src="../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../_static/jquery.js"></script>
        <script type="text/javascript" src="../_static/underscore.js"></script>
        <script type="text/javascript" src="../_static/doctools.js"></script>
        <script type="text/javascript" src="../_static/language_data.js"></script>
        <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
        <script type="text/x-mathjax-config">MathJax.Hub.Config({"CommonHTML": {"linebreaks": {"automatic": true}}, "HTML-CSS": {"linebreaks": {"automatic": true}}, "SVG": {"linebreaks": {"automatic": true}}})</script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/graphviz.css" type="text/css" />
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Calculus" href="calculus.html" />
    <link rel="prev" title="Printing" href="printing.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html">
          

          
            
            <img src="../_static/logo.svg" class="logo" alt="Logo"/>
          
          </a>

          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../install.html">Installation</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Tutorial</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="intro.html">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="basics.html">Basics</a></li>
<li class="toctree-l2"><a class="reference internal" href="gotchas.html">Gotchas</a></li>
<li class="toctree-l2"><a class="reference internal" href="printing.html">Printing</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Simplification</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#rational-functions">Rational Functions</a></li>
<li class="toctree-l3"><a class="reference internal" href="#trigonometric-functions">Trigonometric Functions</a></li>
<li class="toctree-l3"><a class="reference internal" href="#powers-and-logarithms">Powers and Logarithms</a></li>
<li class="toctree-l3"><a class="reference internal" href="#special-functions">Special Functions</a></li>
<li class="toctree-l3"><a class="reference internal" href="#cse">CSE</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="calculus.html">Calculus</a></li>
<li class="toctree-l2"><a class="reference internal" href="solvers.html">Solvers</a></li>
<li class="toctree-l2"><a class="reference internal" href="polys.html">Polynomials</a></li>
<li class="toctree-l2"><a class="reference internal" href="matrices.html">Matrices</a></li>
<li class="toctree-l2"><a class="reference internal" href="manipulation.html">Expression Trees</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../modules/index.html">Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../internals/index.html">Internals</a></li>
<li class="toctree-l1"><a class="reference internal" href="../guide.html">Development</a></li>
<li class="toctree-l1"><a class="reference internal" href="../aboutus.html">About</a></li>
<li class="toctree-l1"><a class="reference internal" href="../release/index.html">Release Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../sources.html">Bibliography</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Diofant</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
          <li><a href="index.html">Tutorial</a> &raquo;</li>
        
      <li>Simplification</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/tutorial/simplification.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="simplification">
<h1>Simplification<a class="headerlink" href="#simplification" title="Permalink to this headline">¶</a></h1>
<p>The generic way to do <em>nontrivial</em> simplifications of expressions is
calling <a class="reference internal" href="../modules/simplify/simplify.html#diofant.simplify.simplify.simplify" title="diofant.simplify.simplify.simplify"><code class="xref py py-func docutils literal notranslate"><span class="pre">simplify()</span></code></a> function.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">simplify</span><span class="p">(</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<span class="go">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">simplify</span><span class="p">((</span><span class="n">x</span><span class="o">**</span><span class="mi">3</span> <span class="o">+</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">x</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
<span class="go">x - 1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">simplify</span><span class="p">(</span><span class="n">gamma</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">/</span><span class="n">gamma</span><span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="mi">2</span><span class="p">))</span>
<span class="go">(x - 2)⋅(x - 1)</span>
</pre></div>
</div>
<p>There are also more directed simplification functions.  These apply
very specific rules to the input expression and are typically able to
make guarantees about the output.  For instance, the
<a class="reference internal" href="../modules/polys.html#diofant.polys.polytools.factor" title="diofant.polys.polytools.factor"><code class="xref py py-func docutils literal notranslate"><span class="pre">factor()</span></code></a> function, given a polynomial
with rational coefficients in several variables, is guaranteed to
produce a factorization into irreducible factors.</p>
<p>The <a class="reference internal" href="../modules/simplify/simplify.html#diofant.simplify.simplify.simplify" title="diofant.simplify.simplify.simplify"><code class="xref py py-func docutils literal notranslate"><span class="pre">simplify()</span></code></a> function applies
almost all available in Diofant such specific simplification rules in
some heuristics sequence to produce the simplest result.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>The optional <code class="docutils literal notranslate"><span class="pre">measure</span></code> keyword argument for
<a class="reference internal" href="../modules/simplify/simplify.html#diofant.simplify.simplify.simplify" title="diofant.simplify.simplify.simplify"><code class="xref py py-func docutils literal notranslate"><span class="pre">simplify()</span></code></a> lets the user specify
the Python function used to determine how “simple” an expression
is.  The default is <a class="reference internal" href="../modules/core.html#diofant.core.function.count_ops" title="diofant.core.function.count_ops"><code class="xref py py-func docutils literal notranslate"><span class="pre">count_ops()</span></code></a>, which
returns the total number of operations in the expression.</p>
</div>
<p>That is why it is usually slow.  But more important pitfail is that
sometimes <a class="reference internal" href="../modules/simplify/simplify.html#diofant.simplify.simplify.simplify" title="diofant.simplify.simplify.simplify"><code class="xref py py-func docutils literal notranslate"><span class="pre">simplify()</span></code></a> doesn’t
“simplify” how you might expect, if, for example, it miss some
transformation or apply it too early or too late.  Lets look on an
example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">simplify</span><span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<span class="go"> 2</span>
<span class="go">x  + 2⋅x + 1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">factor</span><span class="p">(</span><span class="n">_</span><span class="p">)</span>
<span class="go">       2</span>
<span class="go">(x + 1)</span>
</pre></div>
</div>
<p>Obviously, the factored form is more “simple”, as it has less
arithmetic operations.</p>
<p>The function <a class="reference internal" href="../modules/simplify/simplify.html#diofant.simplify.simplify.simplify" title="diofant.simplify.simplify.simplify"><code class="xref py py-func docutils literal notranslate"><span class="pre">simplify()</span></code></a> is best when
used interactively, when you just want to whittle down an expression
to a simpler form.  You may then choose to apply specific functions
once you see what <a class="reference internal" href="../modules/simplify/simplify.html#diofant.simplify.simplify.simplify" title="diofant.simplify.simplify.simplify"><code class="xref py py-func docutils literal notranslate"><span class="pre">simplify()</span></code></a> returns,
to get a more precise result.  It is also useful when you have no idea
what form an expression will take, and you need a catchall function to
simplify it.</p>
<div class="section" id="rational-functions">
<h2>Rational Functions<a class="headerlink" href="#rational-functions" title="Permalink to this headline">¶</a></h2>
<p><a class="reference internal" href="../modules/core.html#diofant.core.function.expand" title="diofant.core.function.expand"><code class="xref py py-func docutils literal notranslate"><span class="pre">expand()</span></code></a> is one of the most common
simplification functions in Diofant.  Although it has a lot of scopes,
for now, we will consider its function in expanding polynomial
expressions.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">expand</span><span class="p">((</span><span class="n">x</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<span class="go"> 2</span>
<span class="go">x  + 2⋅x + 1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">expand</span><span class="p">((</span><span class="n">x</span> <span class="o">+</span> <span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="mi">3</span><span class="p">))</span>
<span class="go"> 2</span>
<span class="go">x  - x - 6</span>
</pre></div>
</div>
<p>Given a polynomial, <a class="reference internal" href="../modules/core.html#diofant.core.function.expand" title="diofant.core.function.expand"><code class="xref py py-func docutils literal notranslate"><span class="pre">expand()</span></code></a> will put it
into a canonical form of a sum of monomials with help of more directed
expansion methods, namely
<a class="reference internal" href="../modules/core.html#diofant.core.function.expand_multinomial" title="diofant.core.function.expand_multinomial"><code class="xref py py-func docutils literal notranslate"><span class="pre">expand_multinomial()</span></code></a> and
<a class="reference internal" href="../modules/core.html#diofant.core.function.expand_mul" title="diofant.core.function.expand_mul"><code class="xref py py-func docutils literal notranslate"><span class="pre">expand_mul()</span></code></a>.</p>
<p><a class="reference internal" href="../modules/core.html#diofant.core.function.expand" title="diofant.core.function.expand"><code class="xref py py-func docutils literal notranslate"><span class="pre">expand()</span></code></a> may not sound like a
simplification function.  After all, by its very name, it makes
expressions bigger, not smaller.  Usually this is the case, but often
an expression will become smaller upon calling
<a class="reference internal" href="../modules/core.html#diofant.core.function.expand" title="diofant.core.function.expand"><code class="xref py py-func docutils literal notranslate"><span class="pre">expand()</span></code></a> on it due to cancellation.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">expand</span><span class="p">((</span><span class="n">x</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">x</span><span class="p">)</span>
<span class="go">-2</span>
</pre></div>
</div>
<p>Function <a class="reference internal" href="../modules/polys.html#diofant.polys.polytools.factor" title="diofant.polys.polytools.factor"><code class="xref py py-func docutils literal notranslate"><span class="pre">factor()</span></code></a> takes a multivariate
polynomial with rational coefficients and factors it into irreducible
factors.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">factor</span><span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="mi">3</span> <span class="o">-</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">x</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
<span class="go">        ⎛ 2    ⎞</span>
<span class="go">(x - 1)⋅⎝x  + 1⎠</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">factor</span><span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">z</span> <span class="o">+</span> <span class="mi">4</span><span class="o">*</span><span class="n">x</span><span class="o">*</span><span class="n">y</span><span class="o">*</span><span class="n">z</span> <span class="o">+</span> <span class="mi">4</span><span class="o">*</span><span class="n">y</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">z</span><span class="p">)</span>
<span class="go">           2</span>
<span class="go">z⋅(x + 2⋅y)</span>
</pre></div>
</div>
<p>For polynomials, <a class="reference internal" href="../modules/polys.html#diofant.polys.polytools.factor" title="diofant.polys.polytools.factor"><code class="xref py py-func docutils literal notranslate"><span class="pre">factor()</span></code></a> is the
opposite of <a class="reference internal" href="../modules/core.html#diofant.core.function.expand" title="diofant.core.function.expand"><code class="xref py py-func docutils literal notranslate"><span class="pre">expand()</span></code></a>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The input to <a class="reference internal" href="../modules/polys.html#diofant.polys.polytools.factor" title="diofant.polys.polytools.factor"><code class="xref py py-func docutils literal notranslate"><span class="pre">factor()</span></code></a> and
<a class="reference internal" href="../modules/core.html#diofant.core.function.expand" title="diofant.core.function.expand"><code class="xref py py-func docutils literal notranslate"><span class="pre">expand()</span></code></a> need not be polynomials in
the strict sense.  They will intelligently factor or expand any
kind of expression (though, for example, the factors may not be
irreducible if the input is no longer a polynomial over the
rationals).</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">expand</span><span class="p">((</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">))</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<span class="go">   2                           2</span>
<span class="go">sin (x) + 2⋅sin(x)⋅cos(x) + cos (x)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">factor</span><span class="p">(</span><span class="n">_</span><span class="p">)</span>
<span class="go">                 2</span>
<span class="go">(sin(x) + cos(x))</span>
</pre></div>
</div>
</div>
<p><a class="reference internal" href="../modules/simplify/simplify.html#diofant.simplify.radsimp.collect" title="diofant.simplify.radsimp.collect"><code class="xref py py-func docutils literal notranslate"><span class="pre">collect()</span></code></a> collects common powers of a
term in an expression.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="o">*</span><span class="n">y</span> <span class="o">+</span> <span class="n">x</span> <span class="o">-</span> <span class="mi">3</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">z</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">x</span><span class="o">**</span><span class="mi">3</span>
<span class="go"> 3    2        2</span>
<span class="go">x  - x ⋅z + 2⋅x  + x⋅y + x - 3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">collect</span><span class="p">(</span><span class="n">_</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
<span class="go"> 3    2</span>
<span class="go">x  + x ⋅(-z + 2) + x⋅(y + 1) - 3</span>
</pre></div>
</div>
<p><a class="reference internal" href="../modules/simplify/simplify.html#diofant.simplify.radsimp.collect" title="diofant.simplify.radsimp.collect"><code class="xref py py-func docutils literal notranslate"><span class="pre">collect()</span></code></a> is particularly useful in
conjunction with the <a class="reference internal" href="../modules/core.html#diofant.core.expr.Expr.coeff" title="diofant.core.expr.Expr.coeff"><code class="xref py py-meth docutils literal notranslate"><span class="pre">coeff()</span></code></a> method.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">_</span><span class="o">.</span><span class="n">coeff</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="go">-z + 2</span>
</pre></div>
</div>
<p><a class="reference internal" href="../modules/polys.html#diofant.polys.polytools.cancel" title="diofant.polys.polytools.cancel"><code class="xref py py-func docutils literal notranslate"><span class="pre">cancel()</span></code></a> will take any rational
function and put it into the standard canonical form, <span class="math notranslate nohighlight">\(p/q\)</span>, where <span class="math notranslate nohighlight">\(p\)</span>
and <span class="math notranslate nohighlight">\(q\)</span> are expanded polynomials with no common factors.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="mi">1</span><span class="o">/</span><span class="n">x</span> <span class="o">+</span> <span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="n">x</span><span class="o">/</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="mi">4</span><span class="p">)</span>
<span class="go">3⋅x</span>
<span class="go">─── - 2</span>
<span class="go"> 2        1</span>
<span class="go">─────── + ─</span>
<span class="go"> x - 4    x</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cancel</span><span class="p">(</span><span class="n">_</span><span class="p">)</span>
<span class="go">   2</span>
<span class="go">3⋅x  - 2⋅x - 8</span>
<span class="go">──────────────</span>
<span class="go">     2</span>
<span class="go">  2⋅x  - 8⋅x</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">expr</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span><span class="o">*</span><span class="n">y</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="o">*</span><span class="n">y</span><span class="o">*</span><span class="n">z</span> <span class="o">+</span> <span class="n">x</span><span class="o">*</span><span class="n">z</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">y</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">y</span><span class="o">*</span><span class="n">z</span> <span class="o">+</span> <span class="n">z</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">expr</span>
<span class="go">   2                2    2            2</span>
<span class="go">x⋅y  - 2⋅x⋅y⋅z + x⋅z  + y  - 2⋅y⋅z + z</span>
<span class="go">───────────────────────────────────────</span>
<span class="go">                  2</span>
<span class="go">                 x  - 1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cancel</span><span class="p">(</span><span class="n">_</span><span class="p">)</span>
<span class="go"> 2            2</span>
<span class="go">y  - 2⋅y⋅z + z</span>
<span class="go">───────────────</span>
<span class="go">     x - 1</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Since <a class="reference internal" href="../modules/polys.html#diofant.polys.polytools.factor" title="diofant.polys.polytools.factor"><code class="xref py py-func docutils literal notranslate"><span class="pre">factor()</span></code></a> will completely
factorize both the numerator and the denominator of an expression,
it can also be used to do the same thing:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">factor</span><span class="p">(</span><span class="n">expr</span><span class="p">)</span>
<span class="go">       2</span>
<span class="go">(y - z)</span>
<span class="go">────────</span>
<span class="go"> x - 1</span>
</pre></div>
</div>
<p>However, it’s less efficient if you are only interested in making
sure that the expression is in canceled form.</p>
</div>
<p><a class="reference internal" href="../modules/polys.html#diofant.polys.partfrac.apart" title="diofant.polys.partfrac.apart"><code class="xref py py-func docutils literal notranslate"><span class="pre">apart()</span></code></a> performs a <a class="reference external" href="https://en.wikipedia.org/wiki/Partial_fraction_decomposition">partial fraction
decomposition</a> on a
rational function.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="mi">4</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">21</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">10</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="mi">12</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="mi">4</span> <span class="o">+</span> <span class="mi">5</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">5</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">4</span><span class="o">*</span><span class="n">x</span><span class="p">)</span>
<span class="go">   3       2</span>
<span class="go">4⋅x  + 21⋅x  + 10⋅x + 12</span>
<span class="go">────────────────────────</span>
<span class="go">  4      3      2</span>
<span class="go"> x  + 5⋅x  + 5⋅x  + 4⋅x</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">apart</span><span class="p">(</span><span class="n">_</span><span class="p">)</span>
<span class="go"> 2⋅x - 1       1     3</span>
<span class="go">────────── - ───── + ─</span>
<span class="go"> 2           x + 4   x</span>
<span class="go">x  + x + 1</span>
</pre></div>
</div>
</div>
<div class="section" id="trigonometric-functions">
<h2>Trigonometric Functions<a class="headerlink" href="#trigonometric-functions" title="Permalink to this headline">¶</a></h2>
<p>To simplify expressions using trigonometric identities, use
<a class="reference internal" href="../modules/simplify/simplify.html#diofant.simplify.trigsimp.trigsimp" title="diofant.simplify.trigsimp.trigsimp"><code class="xref py py-func docutils literal notranslate"><span class="pre">trigsimp()</span></code></a> function.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">trigsimp</span><span class="p">(</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<span class="go">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">trigsimp</span><span class="p">(</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">**</span><span class="mi">4</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">**</span><span class="mi">4</span><span class="p">)</span>
<span class="go">cos(4⋅x)   1</span>
<span class="go">──────── + ─</span>
<span class="go">   2       2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">trigsimp</span><span class="p">(</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">*</span><span class="n">tan</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">/</span><span class="n">sec</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
<span class="go">   2</span>
<span class="go">sin (x)</span>
</pre></div>
</div>
<p>It also works with hyperbolic functions.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">trigsimp</span><span class="p">(</span><span class="n">cosh</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">sinh</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<span class="go">cosh(2⋅x)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">trigsimp</span><span class="p">(</span><span class="n">sinh</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">/</span><span class="n">tanh</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
<span class="go">cosh(x)</span>
</pre></div>
</div>
<p>Much like <a class="reference internal" href="../modules/simplify/simplify.html#diofant.simplify.simplify.simplify" title="diofant.simplify.simplify.simplify"><code class="xref py py-func docutils literal notranslate"><span class="pre">simplify()</span></code></a> function,
<a class="reference internal" href="../modules/simplify/simplify.html#diofant.simplify.trigsimp.trigsimp" title="diofant.simplify.trigsimp.trigsimp"><code class="xref py py-func docutils literal notranslate"><span class="pre">trigsimp()</span></code></a> applies various
trigonometric identities to the input expression, and then uses a
heuristic to return the “best” one.</p>
<p>To expand trigonometric functions, that is, apply the sum or double
angle identities, use <a class="reference internal" href="../modules/core.html#diofant.core.function.expand_trig" title="diofant.core.function.expand_trig"><code class="xref py py-func docutils literal notranslate"><span class="pre">expand_trig()</span></code></a>
function.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">expand_trig</span><span class="p">(</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="n">y</span><span class="p">))</span>
<span class="go">sin(x)⋅cos(y) + sin(y)⋅cos(x)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">expand_trig</span><span class="p">(</span><span class="n">tan</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="p">))</span>
<span class="go">   2⋅tan(x)</span>
<span class="go">─────────────</span>
<span class="go">     2</span>
<span class="go">- tan (x) + 1</span>
</pre></div>
</div>
</div>
<div class="section" id="powers-and-logarithms">
<h2>Powers and Logarithms<a class="headerlink" href="#powers-and-logarithms" title="Permalink to this headline">¶</a></h2>
<p><a class="reference internal" href="../modules/simplify/simplify.html#diofant.simplify.powsimp.powdenest" title="diofant.simplify.powsimp.powdenest"><code class="xref py py-func docutils literal notranslate"><span class="pre">powdenest()</span></code></a> function applies identity
<span class="math notranslate nohighlight">\((x^a)^b = x^{a b}\)</span>, from left to right, if assumptions allow.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;a b&#39;</span><span class="p">,</span> <span class="n">real</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span> <span class="o">=</span> <span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;p&#39;</span><span class="p">,</span> <span class="n">positive</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">powdenest</span><span class="p">((</span><span class="n">p</span><span class="o">**</span><span class="n">a</span><span class="p">)</span><span class="o">**</span><span class="n">b</span><span class="p">)</span>
<span class="go"> a⋅b</span>
<span class="go">p</span>
</pre></div>
</div>
<p><a class="reference internal" href="../modules/simplify/simplify.html#diofant.simplify.powsimp.powsimp" title="diofant.simplify.powsimp.powsimp"><code class="xref py py-func docutils literal notranslate"><span class="pre">powsimp()</span></code></a> function reduces expression
by combining powers with similar bases and exponent.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">powsimp</span><span class="p">(</span><span class="n">z</span><span class="o">**</span><span class="n">x</span><span class="o">*</span><span class="n">z</span><span class="o">**</span><span class="n">y</span><span class="p">)</span>
<span class="go">  x + y</span>
<span class="go"> z</span>
</pre></div>
</div>
<p>Again, as for <a class="reference internal" href="../modules/simplify/simplify.html#diofant.simplify.powsimp.powdenest" title="diofant.simplify.powsimp.powdenest"><code class="xref py py-func docutils literal notranslate"><span class="pre">powdenest()</span></code></a> above, for
the identity <span class="math notranslate nohighlight">\(x^a y^a = (x y)^a\)</span>, that combine bases, we should be
careful about assumptions.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">q</span> <span class="o">=</span> <span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;q&#39;</span><span class="p">,</span> <span class="n">positive</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">powsimp</span><span class="p">(</span><span class="n">p</span><span class="o">**</span><span class="n">a</span><span class="o">*</span><span class="n">q</span><span class="o">**</span><span class="n">a</span><span class="p">)</span>
<span class="go">     a</span>
<span class="go">(p⋅q)</span>
</pre></div>
</div>
<p>In general, this identity doesn’t hold.  For example, if <span class="math notranslate nohighlight">\(x = y = -1\)</span>
and <span class="math notranslate nohighlight">\(a = 1/2\)</span>.</p>
<p><a class="reference internal" href="../modules/core.html#diofant.core.function.expand_power_exp" title="diofant.core.function.expand_power_exp"><code class="xref py py-func docutils literal notranslate"><span class="pre">expand_power_exp()</span></code></a> and
<a class="reference internal" href="../modules/core.html#diofant.core.function.expand_power_base" title="diofant.core.function.expand_power_base"><code class="xref py py-func docutils literal notranslate"><span class="pre">expand_power_base()</span></code></a> functions do reverse
of <a class="reference internal" href="../modules/simplify/simplify.html#diofant.simplify.powsimp.powsimp" title="diofant.simplify.powsimp.powsimp"><code class="xref py py-func docutils literal notranslate"><span class="pre">powsimp()</span></code></a>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">expand_power_exp</span><span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="p">(</span><span class="n">y</span> <span class="o">+</span> <span class="n">z</span><span class="p">))</span>
<span class="go"> y  z</span>
<span class="go">x ⋅x</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">expand_power_base</span><span class="p">((</span><span class="n">p</span><span class="o">*</span><span class="n">q</span><span class="p">)</span><span class="o">**</span><span class="n">a</span><span class="p">)</span>
<span class="go"> a  a</span>
<span class="go">p ⋅q</span>
</pre></div>
</div>
<p>Logarithms have similar issues as powers.  There are two main
identities</p>
<ol class="arabic simple">
<li><p><span class="math notranslate nohighlight">\(\log{(xy)} = \log{(x)} + \log{(y)}\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(\log{(x^n)} = n\log{(x)}\)</span></p></li>
</ol>
<p>Neither identity is true for arbitrary complex <span class="math notranslate nohighlight">\(x\)</span> and <span class="math notranslate nohighlight">\(y\)</span>, due to the
branch cut in the complex plane for the complex logarithm.</p>
<p>To apply above identities from left to right, use
<a class="reference internal" href="../modules/core.html#diofant.core.function.expand_log" title="diofant.core.function.expand_log"><code class="xref py py-func docutils literal notranslate"><span class="pre">expand_log()</span></code></a>.  As for powers, the
identities will not be applied unless they are valid with given set of
assumptions for symbols.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">expand_log</span><span class="p">(</span><span class="n">log</span><span class="p">(</span><span class="n">p</span><span class="o">*</span><span class="n">q</span><span class="p">))</span>
<span class="go">log(p) + log(q)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">expand_log</span><span class="p">(</span><span class="n">log</span><span class="p">(</span><span class="n">p</span><span class="o">/</span><span class="n">q</span><span class="p">))</span>
<span class="go">log(p) - log(q)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">expand_log</span><span class="p">(</span><span class="n">log</span><span class="p">(</span><span class="n">p</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span>
<span class="go">2⋅log(p)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">expand_log</span><span class="p">(</span><span class="n">log</span><span class="p">(</span><span class="n">p</span><span class="o">**</span><span class="n">a</span><span class="p">))</span>
<span class="go">a⋅log(p)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">expand_log</span><span class="p">(</span><span class="n">log</span><span class="p">(</span><span class="n">x</span><span class="o">*</span><span class="n">y</span><span class="p">))</span>
<span class="go">log(x⋅y)</span>
</pre></div>
</div>
<p>To apply identities from right to left, i.e. do reverse of
<a class="reference internal" href="../modules/core.html#diofant.core.function.expand_log" title="diofant.core.function.expand_log"><code class="xref py py-func docutils literal notranslate"><span class="pre">expand_log()</span></code></a>, use
<a class="reference internal" href="../modules/simplify/simplify.html#diofant.simplify.simplify.logcombine" title="diofant.simplify.simplify.logcombine"><code class="xref py py-func docutils literal notranslate"><span class="pre">logcombine()</span></code></a> function.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">logcombine</span><span class="p">(</span><span class="n">log</span><span class="p">(</span><span class="n">p</span><span class="p">)</span> <span class="o">+</span> <span class="n">log</span><span class="p">(</span><span class="n">q</span><span class="p">))</span>
<span class="go">log(p⋅q)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">logcombine</span><span class="p">(</span><span class="n">a</span><span class="o">*</span><span class="n">log</span><span class="p">(</span><span class="n">p</span><span class="p">))</span>
<span class="go">   ⎛ a⎞</span>
<span class="go">log⎝p ⎠</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">logcombine</span><span class="p">(</span><span class="n">a</span><span class="o">*</span><span class="n">log</span><span class="p">(</span><span class="n">z</span><span class="p">))</span>
<span class="go">a⋅log(z)</span>
</pre></div>
</div>
</div>
<div class="section" id="special-functions">
<h2>Special Functions<a class="headerlink" href="#special-functions" title="Permalink to this headline">¶</a></h2>
<p>Diofant implements dozens of <a class="reference internal" href="../modules/functions/special.html#special-functions"><span class="std std-ref">special functions</span></a>, ranging from functions in combinatorics to
mathematical physics.</p>
<p>To expand special functions in terms of some identities, use
<a class="reference internal" href="../modules/core.html#diofant.core.function.expand_func" title="diofant.core.function.expand_func"><code class="xref py py-func docutils literal notranslate"><span class="pre">expand_func()</span></code></a>.  For example the <a class="reference external" href="https://en.wikipedia.org/wiki/Gamma_function">gamma
function</a>
<a class="reference internal" href="../modules/functions/special.html#diofant.functions.special.gamma_functions.gamma" title="diofant.functions.special.gamma_functions.gamma"><code class="xref py py-class docutils literal notranslate"><span class="pre">gamma</span></code></a> can be
expanded as</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">expand_func</span><span class="p">(</span><span class="n">gamma</span><span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="mi">3</span><span class="p">))</span>
<span class="go">x⋅(x + 1)⋅(x + 2)⋅Γ(x)</span>
</pre></div>
</div>
<p>This method also can help if you would like to rewrite the generalized
hypergeometric function
<a class="reference internal" href="../modules/functions/special.html#diofant.functions.special.hyper.hyper" title="diofant.functions.special.hyper.hyper"><code class="xref py py-class docutils literal notranslate"><span class="pre">hyper</span></code></a> or the Meijer
G-function <a class="reference internal" href="../modules/functions/special.html#diofant.functions.special.hyper.meijerg" title="diofant.functions.special.hyper.meijerg"><code class="xref py py-class docutils literal notranslate"><span class="pre">meijerg</span></code></a> in terms
of more standard functions.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">expand_func</span><span class="p">(</span><span class="n">hyper</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">z</span><span class="p">))</span>
<span class="go">-log(-z + 1)</span>
<span class="go">─────────────</span>
<span class="go">     z</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">meijerg</span><span class="p">([[</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">]],</span> <span class="p">[[</span><span class="mi">1</span><span class="p">],</span> <span class="p">[]],</span> <span class="o">-</span><span class="n">z</span><span class="p">)</span>
<span class="go">╭─╮1, 1 ⎛1  1 │   ⎞</span>
<span class="go">│╶┐     ⎜     │ -z⎟</span>
<span class="go">╰─╯2, 1 ⎝1    │   ⎠</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">expand_func</span><span class="p">(</span><span class="n">_</span><span class="p">)</span>
<span class="go">z ___</span>
<span class="go">╲╱ ℯ</span>
</pre></div>
</div>
<p>Another type of expand rule is expanding complex valued expressions and putting
them into a normal form. For this <a class="reference internal" href="../modules/core.html#diofant.core.function.expand_complex" title="diofant.core.function.expand_complex"><code class="xref py py-func docutils literal notranslate"><span class="pre">expand_complex()</span></code></a>
is used.   Note that it will always perform arithmetic expand to obtain the
desired normal form.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">expand_complex</span><span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="n">I</span><span class="o">*</span><span class="n">y</span><span class="p">)</span>
<span class="go">ⅈ⋅(re(y) + im(x)) + re(x) - im(y)</span>
</pre></div>
</div>
<p>The same behavior can be obtained by using
<a class="reference internal" href="../modules/core.html#diofant.core.expr.Expr.as_real_imag" title="diofant.core.expr.Expr.as_real_imag"><code class="xref py py-meth docutils literal notranslate"><span class="pre">as_real_imag()</span></code></a> method.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="n">I</span><span class="o">*</span><span class="n">y</span><span class="p">)</span><span class="o">.</span><span class="n">as_real_imag</span><span class="p">()</span>
<span class="go">(re(x) - im(y), re(y) + im(x))</span>
</pre></div>
</div>
<p>To simplify combinatorial expressions, involving
<a class="reference internal" href="../modules/functions/combinatorial.html#diofant.functions.combinatorial.factorials.factorial" title="diofant.functions.combinatorial.factorials.factorial"><code class="xref py py-class docutils literal notranslate"><span class="pre">factorial</span></code></a>,
<a class="reference internal" href="../modules/functions/combinatorial.html#diofant.functions.combinatorial.factorials.binomial" title="diofant.functions.combinatorial.factorials.binomial"><code class="xref py py-class docutils literal notranslate"><span class="pre">binomial</span></code></a> or
<a class="reference internal" href="../modules/functions/special.html#diofant.functions.special.gamma_functions.gamma" title="diofant.functions.special.gamma_functions.gamma"><code class="xref py py-class docutils literal notranslate"><span class="pre">gamma</span></code></a> — use
<a class="reference internal" href="../modules/simplify/simplify.html#diofant.simplify.combsimp.combsimp" title="diofant.simplify.combsimp.combsimp"><code class="xref py py-func docutils literal notranslate"><span class="pre">combsimp()</span></code></a> function.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">combsimp</span><span class="p">(</span><span class="n">factorial</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">/</span><span class="n">factorial</span><span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="mi">3</span><span class="p">))</span>
<span class="go">x⋅(x - 2)⋅(x - 1)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">combsimp</span><span class="p">(</span><span class="n">binomial</span><span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">y</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="n">binomial</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">))</span>
<span class="go">x + 1</span>
<span class="go">─────</span>
<span class="go">y + 1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">combsimp</span><span class="p">(</span><span class="n">gamma</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">*</span><span class="n">gamma</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">x</span><span class="p">))</span>
<span class="go">   π</span>
<span class="go">────────</span>
<span class="go">sin(π⋅x)</span>
</pre></div>
</div>
</div>
<div class="section" id="cse">
<h2>CSE<a class="headerlink" href="#cse" title="Permalink to this headline">¶</a></h2>
<p>Before evaluating a large expression, it is often useful to identify common
subexpressions, collect them and evaluate them at once. This is called common
subexpression elimination (CSE) and implemented in the
<a class="reference internal" href="../modules/simplify/simplify.html#diofant.simplify.cse_main.cse" title="diofant.simplify.cse_main.cse"><code class="xref py py-func docutils literal notranslate"><span class="pre">cse()</span></code></a> function.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">cse</span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)))</span>
<span class="go">⎛    ⎡  ________⎤⎞</span>
<span class="go">⎝[], ⎣╲╱ sin(x) ⎦⎠</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">cse</span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="mi">5</span><span class="p">)</span><span class="o">*</span><span class="n">sqrt</span><span class="p">(</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="mi">4</span><span class="p">))</span>
<span class="go">⎛                ⎡  ________   ________⎤⎞</span>
<span class="go">⎝[(x₀, sin(x))], ⎣╲╱ x₀ + 4 ⋅╲╱ x₀ + 5 ⎦⎠</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">cse</span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="mi">5</span> <span class="o">+</span> <span class="n">cos</span><span class="p">(</span><span class="n">y</span><span class="p">))</span><span class="o">*</span><span class="n">sqrt</span><span class="p">(</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="mi">4</span> <span class="o">+</span> <span class="n">cos</span><span class="p">(</span><span class="n">y</span><span class="p">)))</span>
<span class="go">⎛                             ⎡  ________   ________⎤⎞</span>
<span class="go">⎝[(x₀, sin(x + 1) + cos(y))], ⎣╲╱ x₀ + 4 ⋅╲╱ x₀ + 5 ⎦⎠</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">cse</span><span class="p">((</span><span class="n">x</span> <span class="o">-</span> <span class="n">y</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">z</span> <span class="o">-</span> <span class="n">y</span><span class="p">)</span> <span class="o">+</span> <span class="n">sqrt</span><span class="p">((</span><span class="n">x</span> <span class="o">-</span> <span class="n">y</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">z</span> <span class="o">-</span> <span class="n">y</span><span class="p">)))</span>
<span class="go">⎛                                     ⎡  ____     ⎤⎞</span>
<span class="go">⎝[(x₀, -y), (x₁, (x + x₀)⋅(x₀ + z))], ⎣╲╱ x₁  + x₁⎦⎠</span>
</pre></div>
</div>
<p>Optimizations to be performed before and after common subexpressions
elimination can be passed in the``optimizations`` optional argument.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">cse</span><span class="p">((</span><span class="n">x</span> <span class="o">-</span> <span class="n">y</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">z</span> <span class="o">-</span> <span class="n">y</span><span class="p">)</span> <span class="o">+</span> <span class="n">sqrt</span><span class="p">((</span><span class="n">x</span> <span class="o">-</span> <span class="n">y</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">z</span> <span class="o">-</span> <span class="n">y</span><span class="p">)),</span> <span class="n">optimizations</span><span class="o">=</span><span class="s1">&#39;basic&#39;</span><span class="p">)</span>
<span class="go">⎛                          ⎡  ____     ⎤⎞</span>
<span class="go">⎝[(x₀, -(x - y)⋅(y - z))], ⎣╲╱ x₀  + x₀⎦⎠</span>
</pre></div>
</div>
<p>However, these optimizations can be very slow for large expressions. Moreover,
if speed is a concern, one can pass the option <code class="docutils literal notranslate"><span class="pre">order='none'</span></code>. Order of
terms will then be dependent on hashing algorithm implementation, but speed
will be greatly improved.</p>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="calculus.html" class="btn btn-neutral float-right" title="Calculus" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="printing.html" class="btn btn-neutral float-left" title="Printing" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2006-2018 SymPy Development Team, 2013-2019 Sergey B Kirpichev

    </p>
  </div> 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
    <!-- Theme Analytics -->
    <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-147167689-1', 'auto');
    ga('send', 'pageview');
    </script>

    
   

</body>
</html>